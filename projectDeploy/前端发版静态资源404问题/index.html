<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前端发版静态资源404问题 | Sewen 博客</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="./mylogo.png">
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
    <link rel="manifest" href="/myblog/manifest.webmanifest" crossorigin="use-credentials">
    <link rel="alternate" type="application/atom+xml" href="https://sewar-x.github.io/myblog/atom.xml" title="Sewen 博客 Atom Feed">
    <link rel="alternate" type="application/json" href="https://sewar-x.github.io/myblog/rss.xml" title="Sewen 博客 JSON Feed">
    <link rel="alternate" type="application/rss+xml" href="https://sewar-x.github.io/myblog/rss.xml" title="Sewen 博客 RSS Feed">
    <meta name="description" content="sewen 的前端学习笔记、博客、前端基础总结、技术深度剖析、面试题总结、算法总结、项目过程总结">
    <meta property="og:url" content="https://sewar-x.github.io/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E5%8F%91%E7%89%88%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90404%E9%97%AE%E9%A2%98.html">
    <meta property="og:site_name" content="Sewen 博客">
    <meta property="og:title" content="前端发版静态资源404问题">
    <meta property="og:type" content="article">
    <meta property="og:locale" content="en-US">
    <meta name="theme-color" content="#46bd87">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <link rel="preload" href="/myblog/assets/css/0.styles.645fbc6f.css" as="style"><link rel="preload" href="/myblog/assets/js/app.9d2b617a.js" as="script"><link rel="preload" href="/myblog/assets/js/layout-Layout.d2d4ce64.js" as="script"><link rel="preload" href="/myblog/assets/js/page-前端发版静态资源404问题.9eb1ca89.js" as="script"><link rel="preload" href="/myblog/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound~layout-components/Blog/BlogHome~layout-components/~2222f443.5835591a.js" as="script"><link rel="prefetch" href="/myblog/assets/js/199.a9216960.js"><link rel="prefetch" href="/myblog/assets/js/200.4c66fc79.js"><link rel="prefetch" href="/myblog/assets/js/layout-Blog.1fca7e90.js"><link rel="prefetch" href="/myblog/assets/js/layout-NotFound.3c74e8aa.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/AlgoliaSearch/Dropdown.70fcebe7.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Anchor.3235541c.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/ArticleInfo.7b815b20.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/ArticleItem.b0e177e1.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/ArticleList.d1cf1b24.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/ArticleType.b630b80e.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/BlogHero.621312ba.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/BlogHome.4fe44489.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/BlogInfo.b2a94760.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/BlogPage.e0fbe820.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/BloggerInfo.0df38355.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/CategoryList.ec1bcd96.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/ProjectList.8550a110.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/TagList.bcf7b782.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/Timeline.b6cf5471.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/TimelineList.3c6e08a6.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Clipboard.e940a903.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Common.820a8694.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Home.70383986.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/MyTransition.0de46069.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Navbar/DropdownLink.e3f6c118.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Navbar/NavLink.93b11770.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Navbar/NavLinks.8ba214e6.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Navbar/Navbar.b90a94f9.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Navbar/RepoLink.663a7f55.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Navbar/SidebarButton.76b0035a.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Page.98b5d09c.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/PageFooter.20bc9bd8.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/PageMeta.b7e6b12f.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/PageNav.8305dd1f.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Password.45e0e82a.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Sidebar/DropdownTransition.068c5eea.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Sidebar/Sidebar.f6f90d52.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Sidebar/SidebarDropdownLink.505127a8.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Sidebar/SidebarGroup.7eecf370.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Sidebar/SidebarLink.6e39fe32.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Sidebar/SidebarNavLinks.0f8566cb.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Theme/DarkmodeSwitch.20ac7b92.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Theme/ThemeColor.6086e4ed.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Theme/ThemeOptions.483238c9.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/ArticleIcon.0a22e2b1.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/AutoIcon.2ff1c790.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/BookIcon.419b49ba.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/DarkIcon.7d81873b.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/EditIcon.8ada485d.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/EmptyIcon.d704a5cf.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/I18nIcon.ffad8b3e.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/LightIcon.47d807da.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/LinkIcon.1a8a7826.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/LockIcon.a29a2b79.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/NextIcon.0214ee59.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/Page404Icon.8bc1ebbb.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/PresentationIcon.17500d9b.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/PrevIcon.2ae04a70.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/ProjectIcon.b336d567.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/StickyIcon.0f509b9d.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Baidu.244b9a41.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Bitbucket.11ba94e1.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Dingding.e8a3d90d.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Discord.3295a55b.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Dribbble.464dac3b.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Email.f9254caa.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Evernote.991472fb.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Facebook.08e78e47.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Flipboard.a1124d0f.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Gitee.c44bc20a.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Github.5667e5ae.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Gitlab.ad95c7a7.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Gmail.b5acc6bc.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Instagram.56be85f2.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Lines.d9db3dce.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Linkedin.b82d8d8b.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Pinterest.0f3ffe71.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Pocket.41ef3c92.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/QQ.7558f4ba.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Qzone.bf658fae.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Reddit.9c4c95ee.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Rss.9780139e.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Steam.06abbae2.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Twitter.26fa5bda.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Wechat.9cac8c4c.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Weibo.5206a632.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Whatsapp.0738f1e3.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Youtube.f41fd7f2.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Zhihu.4d851d2f.js"><link rel="prefetch" href="/myblog/assets/js/page--0abc50bf.0d6f1484.js"><link rel="prefetch" href="/myblog/assets/js/page--1cd40f4c.dd76c7b3.js"><link rel="prefetch" href="/myblog/assets/js/page--53f93199.e80bdec8.js"><link rel="prefetch" href="/myblog/assets/js/page--5afd2fd0.adea4e92.js"><link rel="prefetch" href="/myblog/assets/js/page--67c584d3.0a3f3cd9.js"><link rel="prefetch" href="/myblog/assets/js/page--776a8506.cdf48aac.js"><link rel="prefetch" href="/myblog/assets/js/page-CSS.eb94b29f.js"><link rel="prefetch" href="/myblog/assets/js/page-Chrome开发工具使用指南.a2675120.js"><link rel="prefetch" href="/myblog/assets/js/page-DevServer.0281863d.js"><link rel="prefetch" href="/myblog/assets/js/page-Echarts二次封装.4387b8ad.js"><link rel="prefetch" href="/myblog/assets/js/page-Elementui与Element-plusui二次封装.82f12a09.js"><link rel="prefetch" href="/myblog/assets/js/page-Git基础.03c616ad.js"><link rel="prefetch" href="/myblog/assets/js/page-Git规范.e2fdc38a.js"><link rel="prefetch" href="/myblog/assets/js/page-HTML.1e3c14b9.js"><link rel="prefetch" href="/myblog/assets/js/page-Home.f0b7e772.js"><link rel="prefetch" href="/myblog/assets/js/page-JSON配置化组件二次封装.12060fd9.js"><link rel="prefetch" href="/myblog/assets/js/page-JS原理实现.3c427e19.js"><link rel="prefetch" href="/myblog/assets/js/page-JS应用题.3d313b34.js"><link rel="prefetch" href="/myblog/assets/js/page-JavaScript基础.551be887.js"><link rel="prefetch" href="/myblog/assets/js/page-Linux.c6159ebd.js"><link rel="prefetch" href="/myblog/assets/js/page-Loader和Plugin原理.b2971b76.js"><link rel="prefetch" href="/myblog/assets/js/page-MySQL.0b1d704a.js"><link rel="prefetch" href="/myblog/assets/js/page-NPM.a55851b2.js"><link rel="prefetch" href="/myblog/assets/js/page-Node.ec405a21.js"><link rel="prefetch" href="/myblog/assets/js/page-Nodejs常见问题集合.12844e69.js"><link rel="prefetch" href="/myblog/assets/js/page-Node性能优化.b4ea1c34.js"><link rel="prefetch" href="/myblog/assets/js/page-Promise专题.7869a31b.js"><link rel="prefetch" href="/myblog/assets/js/page-React.d76cf0ac.js"><link rel="prefetch" href="/myblog/assets/js/page-SSG移动端项目实践.2122615b.js"><link rel="prefetch" href="/myblog/assets/js/page-TypeScript.4f597fda.js"><link rel="prefetch" href="/myblog/assets/js/page-Vite.637881bf.js"><link rel="prefetch" href="/myblog/assets/js/page-Vite原理解析.6677fdb4.js"><link rel="prefetch" href="/myblog/assets/js/page-Vue25项目webpack构建分析.7bbea0fa.js"><link rel="prefetch" href="/myblog/assets/js/page-Vue2VsVue3.10be4140.js"><link rel="prefetch" href="/myblog/assets/js/page-Vue2x原理源码分析.e9e753b6.js"><link rel="prefetch" href="/myblog/assets/js/page-Vue3基础.210247ff.js"><link rel="prefetch" href="/myblog/assets/js/page-Vue3源码分析.17379e04.js"><link rel="prefetch" href="/myblog/assets/js/page-VueCli源码分析.afc3c83f.js"><link rel="prefetch" href="/myblog/assets/js/page-VueRouter原理分析.0a092eb6.js"><link rel="prefetch" href="/myblog/assets/js/page-VueSSR原理分析.63006040.js"><link rel="prefetch" href="/myblog/assets/js/page-VueVsReact.2156be28.js"><link rel="prefetch" href="/myblog/assets/js/page-Vuex原理分析.5ba3e6e4.js"><link rel="prefetch" href="/myblog/assets/js/page-WEB安全.5aa0eeef.js"><link rel="prefetch" href="/myblog/assets/js/page-WebPack构建原理.9c29703e.js"><link rel="prefetch" href="/myblog/assets/js/page-webpackAPI分析.4c8b152b.js"><link rel="prefetch" href="/myblog/assets/js/page-webpack优化.dcc6c3bc.js"><link rel="prefetch" href="/myblog/assets/js/page-webpack基础.3820ee6c.js"><link rel="prefetch" href="/myblog/assets/js/page-webpack项目实践.77e22417.js"><link rel="prefetch" href="/myblog/assets/js/page-一次后台管理系统的性能优化.7c2d8712.js"><link rel="prefetch" href="/myblog/assets/js/page-从零到一搭建SSR项目.855376fc.js"><link rel="prefetch" href="/myblog/assets/js/page-从零到一搭建Vue2项目和规范设计.93017fd2.js"><link rel="prefetch" href="/myblog/assets/js/page-从零到一搭建Vue3单页面应用.de152d54.js"><link rel="prefetch" href="/myblog/assets/js/page-从零到一搭建公共组件库.93278073.js"><link rel="prefetch" href="/myblog/assets/js/page-从零到一搭建移动端SSG项目.9c113d06.js"><link rel="prefetch" href="/myblog/assets/js/page-使用docker部署Node服务.5cf328fd.js"><link rel="prefetch" href="/myblog/assets/js/page-分治.e3dfc22d.js"><link rel="prefetch" href="/myblog/assets/js/page-前端存储.cd82cf54.js"><link rel="prefetch" href="/myblog/assets/js/page-前端工程化.1e6e58d0.js"><link rel="prefetch" href="/myblog/assets/js/page-前端性能优化方案.83718d22.js"><link rel="prefetch" href="/myblog/assets/js/page-前端架构实践.171dbc0f.js"><link rel="prefetch" href="/myblog/assets/js/page-前端渲染架构.3b783de8.js"><link rel="prefetch" href="/myblog/assets/js/page-前端自动部署.5076846c.js"><link rel="prefetch" href="/myblog/assets/js/page-前端部署原理.82ecd8a7.js"><link rel="prefetch" href="/myblog/assets/js/page-动态规划.a3af92f1.js"><link rel="prefetch" href="/myblog/assets/js/page-哈希表.c76000e8.js"><link rel="prefetch" href="/myblog/assets/js/page-回溯算法.cd914c32.js"><link rel="prefetch" href="/myblog/assets/js/page-图.dfd9828a.js"><link rel="prefetch" href="/myblog/assets/js/page-基础.7bf5a37b.js"><link rel="prefetch" href="/myblog/assets/js/page-堆.4657e538.js"><link rel="prefetch" href="/myblog/assets/js/page-字符串.252f2a08.js"><link rel="prefetch" href="/myblog/assets/js/page-异步编程.904f4c65.js"><link rel="prefetch" href="/myblog/assets/js/page-性能优化指标和监控.f2175836.js"><link rel="prefetch" href="/myblog/assets/js/page-排序算法.c7a51b99.js"><link rel="prefetch" href="/myblog/assets/js/page-搭建低代码平台.19eaf5ec.js"><link rel="prefetch" href="/myblog/assets/js/page-操作系统.473c4281.js"><link rel="prefetch" href="/myblog/assets/js/page-数学运算.c82748fb.js"><link rel="prefetch" href="/myblog/assets/js/page-数据结构算法.84480586.js"><link rel="prefetch" href="/myblog/assets/js/page-数组.692b0d0a.js"><link rel="prefetch" href="/myblog/assets/js/page-权限管理.c7e10db0.js"><link rel="prefetch" href="/myblog/assets/js/page-查找.790e52df.js"><link rel="prefetch" href="/myblog/assets/js/page-栈和队列.8dbc3586.js"><link rel="prefetch" href="/myblog/assets/js/page-树.24efdeaa.js"><link rel="prefetch" href="/myblog/assets/js/page-浏览器.bee9ec04.js"><link rel="prefetch" href="/myblog/assets/js/page-混合桌面应用开发.9e10d1c3.js"><link rel="prefetch" href="/myblog/assets/js/page-登录.bb830451.js"><link rel="prefetch" href="/myblog/assets/js/page-目录.c85b4d0b.js"><link rel="prefetch" href="/myblog/assets/js/page-移动端开发.56ac22ec.js"><link rel="prefetch" href="/myblog/assets/js/page-组件和组件封装.b5e86da2.js"><link rel="prefetch" href="/myblog/assets/js/page-计算机网络基础.0a106662.js"><link rel="prefetch" href="/myblog/assets/js/page-设计模式.ffdc7cfd.js"><link rel="prefetch" href="/myblog/assets/js/page-调试技巧.485ae36e.js"><link rel="prefetch" href="/myblog/assets/js/page-贪心算法.0f417640.js"><link rel="prefetch" href="/myblog/assets/js/page-输入url到页面展示全过程.510aef2e.js"><link rel="prefetch" href="/myblog/assets/js/page-递归.5e55e552.js"><link rel="prefetch" href="/myblog/assets/js/page-链表.1cf6927f.js"><link rel="prefetch" href="/myblog/assets/js/page-项目总结.ffcd2a4b.js"><link rel="prefetch" href="/myblog/assets/js/vendors~docsearch.f3877d0d.js"><link rel="prefetch" href="/myblog/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound~layout-components/Blog/BlogHome~layout-components/~5d377965.d9712593.js"><link rel="prefetch" href="/myblog/assets/js/vendors~layout-Blog~layout-Layout~layout-components/Blog/ArticleItem~layout-components/Blog/ArticleL~b56f3aac.47bb5cb5.js"><link rel="prefetch" href="/myblog/assets/js/vendors~layout-NotFound~layout-components/Common~layout-components/Page.57d58db9.js"><link rel="prefetch" href="/myblog/assets/js/vendors~layout-Slide.81546b3b.js"><link rel="prefetch" href="/myblog/assets/js/vendors~layout-components/AlgoliaSearch/Full.b30f067a.js"><link rel="prefetch" href="/myblog/assets/js/vendors~layout-components/Blog/BlogPage.bcccbd38.js"><link rel="prefetch" href="/myblog/assets/js/vendors~layout-components/Navbar/Navbar.e2a7361e.js"><link rel="prefetch" href="/myblog/assets/js/vendors~layout-components/Page.6c65077c.js"><link rel="prefetch" href="/myblog/assets/js/vendors~layout-components/Sidebar/Sidebar.34cd9cf7.js"><link rel="prefetch" href="/myblog/assets/js/vendors~photo-swipe.428df1da.js">
    <link rel="stylesheet" href="/myblog/assets/css/0.styles.645fbc6f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container has-navbar has-sidebar has-anchor"><header class="navbar"><!----> <div class="content__navbar-start"></div> <button title="Sidebar Button" class="sidebar-button"><span class="icon"></span></button> <a href="/myblog/" class="home-link router-link-active"><img src="./mylogo.png" alt="Sewen 博客" class="logo"> <!----> <span class="site-name can-hide">Sewen 博客</span></a> <!----> <div class="content__navbar-center"></div> <div class="links"><button tabindex="-1" aria-hidden="true" class="color-button"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="skin-icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4
        38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32
        51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0
        102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2
        6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4
        0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2
        9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224
        419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4
        470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0
        22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6
        12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128
        505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2
        16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8
        86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4
        80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6
        6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg> <div class="color-picker-menu" style="display:none;"><div class="theme-options"><ul class="themecolor-select"><label for="themecolor-select">Theme Color:</label> <li><span class="default-theme"></span></li> </ul> <div class="darkmode-toggle"><label for="darkmode-toggle" class="desc">Theme Mode:</label> <div class="darkmode-switch"><div class="item day"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon light-icon"><path d="M512 256a42.667 42.667 0 0 0 42.667-42.667V128a42.667 42.667 0 0 0-85.334 0v85.333A42.667 42.667 0 0 0 512 256zm384 213.333h-85.333a42.667 42.667 0 0 0 0 85.334H896a42.667 42.667 0 0 0 0-85.334zM256 512a42.667 42.667 0 0 0-42.667-42.667H128a42.667 42.667 0 0 0 0 85.334h85.333A42.667 42.667 0 0 0 256 512zm9.387-298.667a42.667 42.667 0 0 0-59.307 62.72l61.44 59.307a42.667 42.667 0 0 0 31.147 11.947 42.667 42.667 0 0 0 30.72-13.227 42.667 42.667 0 0 0 0-60.16zm459.946 133.974a42.667 42.667 0 0 0 29.44-11.947l61.44-59.307a42.667 42.667 0 0 0-57.6-62.72l-61.44 60.587a42.667 42.667 0 0 0 0 60.16 42.667 42.667 0 0 0 28.16 13.227zM512 768a42.667 42.667 0 0 0-42.667 42.667V896a42.667 42.667 0 0 0 85.334 0v-85.333A42.667 42.667 0 0 0 512 768zm244.48-79.36a42.667 42.667 0 0 0-59.307 61.44l61.44 60.587a42.667 42.667 0 0 0 29.44 11.946 42.667 42.667 0 0 0 30.72-12.8 42.667 42.667 0 0 0 0-60.586zm-488.96 0-61.44 59.307a42.667 42.667 0 0 0 0 60.586 42.667 42.667 0 0 0 30.72 12.8 42.667 42.667 0 0 0 28.587-10.666l61.44-59.307a42.667 42.667 0 0 0-59.307-61.44zM512 341.333A170.667 170.667 0 1 0 682.667 512 170.667 170.667 0 0 0 512 341.333z" fill="currentColor"></path></svg></div> <div class="item auto active"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon auto-icon"><path d="M460.864 539.072H564.8L510.592 376l-49.728 163.072zM872 362.368V149.504H659.648L510.528 0l-149.12 149.504H149.12v212.928L0 511.872l149.12 149.504v212.928h212.352l149.12 149.504 149.12-149.504h212.352V661.376l149.12-149.504L872 362.368zM614.464 693.12l-31.616-90.624H438.272l-31.616 90.624h-85.888l144.576-407.68h90.368l144.576 407.68h-85.824zm0 0" fill="currentColor"></path></svg></div> <div class="item night"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon dark-icon"><path d="M935.539 630.402c-11.43-11.432-28.674-14.739-43.531-8.354-46.734 20.103-96.363 30.297-147.508 30.297-99.59 0-193.221-38.784-263.64-109.203-108.637-108.637-139.61-270.022-78.908-411.148a39.497 39.497 0 0 0-51.886-51.887c-52.637 22.64-100.017 54.81-140.826 95.616-85.346 85.346-132.346 198.821-132.346 319.52 0 120.7 47.001 234.172 132.347 319.519S408.063 947.11 528.76 947.11c120.7 0 234.172-47.003 319.52-132.351 40.809-40.81 72.978-88.19 95.616-140.826a39.497 39.497 0 0 0-8.356-43.532z" fill="currentColor"></path></svg></div></div> <!----></div></div></div></button> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/myblog/" class="nav-link router-link-active"><!---->
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Front-end Basics" class="dropdown-title"><span class="title"><!---->
        前端基础
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/myblog/projectDeploy/html/" class="nav-link"><!---->
  HTML
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/css/" class="nav-link"><!---->
  Css
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/javascript/" class="nav-link"><!---->
  JavaScript
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/typescript/" class="nav-link"><!---->
  TypeScript
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title"><!---->
        计算机基础
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/myblog/projectDeploy/algorithms/" class="nav-link"><!---->
  数据结构和算法
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/network/" class="nav-link"><!---->
  计算机网络/HTTP
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/network/输入url到页面展示全过程/" class="nav-link"><!---->
  输入url到页面展示全过程
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/operating-system/" class="nav-link"><!---->
  操作系统
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/design-model/" class="nav-link"><!---->
  设计模式
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/Web-Security/" class="nav-link"><!---->
  Web安全
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架和源码分析" class="dropdown-title"><span class="title"><!---->
        框架和源码分析
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/myblog/projectDeploy/vue/Vue2原理和源码分析.html" class="nav-link"><!---->
  Vue 专题
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/React/" class="nav-link"><!---->
  React 专题
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/webpack/webpack构建原理.html" class="nav-link"><!---->
  webpack 专题
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/vite/" class="nav-link"><!---->
  vite 专题
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/axios/" class="nav-link"><!---->
  Axios 专题
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="浏览器" class="dropdown-title"><span class="title"><!---->
        浏览器
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/myblog/projectDeploy/browser/浏览器原理/" class="nav-link"><!---->
  浏览器原理
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/browser/前端缓存和存储/" class="nav-link"><!---->
  前端缓存和存储
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/performance/前端调试技巧/" class="nav-link"><!---->
  前端调试技巧
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="node.js" class="dropdown-title"><span class="title"><!---->
        服务器
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/myblog/projectDeploy/node/" class="nav-link"><!---->
  Node.js
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/linux/" class="nav-link"><!---->
  Linux
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/mysql/" class="nav-link"><!---->
  MySQL
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/nginx/" class="nav-link"><!---->
  Nginx
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/docker/" class="nav-link"><!---->
  Docker
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="浏览器和性能优化" class="dropdown-title"><span class="title"><!---->
        性能优化
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/myblog/projectDeploy/performance/性能优化指标和监控/" class="nav-link"><!---->
  性能优化指标和监控
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/performance/前端性能优化方案/" class="nav-link"><!---->
  前端性能优化方案
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/performance/一次管理后台的渲染优化/" class="nav-link"><!---->
  一次管理后台的渲染优化
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端工程" class="dropdown-title"><span class="title"><!---->
        前端工程
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/myblog/projectDeploy/Front-end-Engineering/前端工程化/" class="nav-link"><!---->
  前端工程化
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/Front-end-Engineering/前端渲染架构/" class="nav-link"><!---->
  前端渲染架构
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/Front-end-Engineering/前端架构实践/" class="nav-link"><!---->
  前端架构实践
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/Front-end-Engineering/npm/" class="nav-link"><!---->
  npm
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/git/" class="nav-link"><!---->
  Git
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/projectDeploy/自动构建和部署/" class="nav-link"><!---->
  自动构建和部署
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目实践" class="dropdown-title"><span class="title"><!---->
        项目实践
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/myblog/projectDeploy/projectDeploy/" class="nav-link"><!---->
  前端部署
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/componentsEncapsulation/组件和组件封装实践.html" class="nav-link"><!---->
  组件和组件封装实践
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/projectsSummary/登录与单点登录/" class="nav-link"><!---->
  登录与单点登录
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/projectsSummary/权限管理方案实践/" class="nav-link"><!---->
  权限管理方案实践
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/projectsSummary/Echarts二次封装实践/" class="nav-link"><!---->
  Echarts二次封装实践
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/projectsSummary/文档在线预览和编辑方案/" class="nav-link"><!---->
  文档在线预览和编辑方案
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/projectsSummary/移动端开发实践/" class="nav-link"><!---->
  移动端开发实践
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目搭建到原理分析" class="dropdown-title"><span class="title"><!---->
        项目搭建
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/myblog/projectDeploy/projectsSummary/从零到一搭建SSR项目/" class="nav-link"><!---->
  从零到一搭建SSR项目
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/projectsSummary/从零到一搭建移动端SSG项目/" class="nav-link"><!---->
  从零到一搭建移动端SSG项目
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/projectsSummary/移动端SSG项目实践/" class="nav-link"><!---->
  移动端SSG项目实践
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/projectsSummary/从零到一搭建Vue2工程化项目/" class="nav-link"><!---->
  从零到一搭建Vue2工程化项目
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/projectsSummary/从零到一搭建Vue3工程化项目/" class="nav-link"><!---->
  从零到一搭建Vue3工程化项目
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/projectsSummary/搭建低代码平台/" class="nav-link"><!---->
  搭建低代码平台
</a></li><li class="dropdown-item"><a href="/myblog/projectDeploy/projectsSummary/混合桌面应用开发实践/" class="nav-link"><!---->
  混合桌面应用开发实践
</a></li></ul></div></div></nav> <!----> <!----> <!----> <div class="content__navbar-end"></div></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><div vocab="https://schema.org/" typeof="Person" class="blogger-info mobile"><div data-balloon-pos="down" role="navigation" class="blogger hasIntro"><img property="image" alt="Blogger Avatar" src="./mylogo.png" class="avatar round"> <div property="name" class="name">Sewen 博客</div> <meta property="url" content="../outline.md"></div> <div class="num-wrapper"><div><div class="num">91</div> <div>Articles</div></div> <div><div class="num">0</div> <div>Category</div></div> <div><div class="num">0</div> <div>Tags</div></div> <div><div class="num">91</div> <div>Timeline</div></div></div> <div class="media-links-wrapper"><a href="https://github.com/Sewar-x/myblog" rel="noopener noreferrer" target="_blank" aria-label="Github" data-balloon-pos="up" class="media-link"><span class="sr-only">Github</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-github"><circle cx="512" cy="512" r="512" fill="#171515"></circle> <path d="M509.423 146.442c-200.317 0-362.756 162.42-362.756 362.8 0 160.266 103.936 296.24 248.109 344.217 18.139 3.327 24.76-7.872 24.76-17.486 0-8.613-.313-31.427-.49-61.702-100.912 21.923-122.205-48.63-122.205-48.63-16.495-41.91-40.28-53.067-40.28-53.067-32.937-22.51 2.492-22.053 2.492-22.053 36.407 2.566 55.568 37.386 55.568 37.386 32.362 55.438 84.907 39.43 105.58 30.143 3.296-23.444 12.667-39.43 23.032-48.498-80.557-9.156-165.246-40.28-165.246-179.297 0-39.604 14.135-71.988 37.342-97.348-3.731-9.178-16.18-46.063 3.556-96.009 0 0 30.46-9.754 99.76 37.19 28.937-8.048 59.97-12.071 90.823-12.211 30.807.14 61.843 4.165 90.822 12.21 69.26-46.944 99.663-37.189 99.663-37.189 19.792 49.946 7.34 86.831 3.61 96.01 23.25 25.359 37.29 57.742 37.29 97.347 0 139.366-84.82 170.033-165.637 179.013 13.026 11.2 24.628 33.342 24.628 67.182 0 48.498-.445 87.627-.445 99.521 0 9.702 6.535 20.988 24.945 17.444 144.03-48.067 247.881-183.95 247.881-344.175 0-200.378-162.442-362.798-362.802-362.798z" fill="#FFF"></path></svg></a><a href="1567910907" rel="noopener noreferrer" target="_blank" aria-label="Wechat" data-balloon-pos="up" class="media-link"><span class="sr-only">Wechat</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-wechat"><circle cx="512" cy="512" r="512" fill="#1AC88E"></circle> <path d="M827.551 578.742a176.583 176.583 0 0 0-185.685-158.379 172.942 172.942 0 0 0-186.3 158.379 172.942 172.942 0 0 0 185.686 158.379 282.169 282.169 0 0 0 65.536-10.923l60.689 32.768-16.384-54.613a166.275 166.275 0 0 0 76.458-125.611zm-245.76-27.307a21.845 21.845 0 1 1 0-43.69 24.872 24.872 0 0 1 27.307 21.845 24.872 24.872 0 0 1-27.921 21.845h.614zm121.356 0a21.845 21.845 0 1 1 0-43.69 24.872 24.872 0 0 1 27.306 21.845 24.872 24.872 0 0 1-28.512 21.845h1.206z" fill="#FFF"></path> <path d="M623.662 400.953h21.23A222.709 222.709 0 0 0 419.772 245.6a208.145 208.145 0 0 0-223.323 189.94 182.044 182.044 0 0 0 89.201 150.483l-22.436 67.356 78.279-39.435a389.575 389.575 0 0 0 78.279 10.923h20.616a163.226 163.226 0 0 1-6.667-46.718 182.044 182.044 0 0 1 189.94-177.197zm-121.379-60.69a27.921 27.921 0 1 1 0 55.843 31.562 31.562 0 0 1-33.36-27.921 31.562 31.562 0 0 1 34.59-27.921h-1.23zM346.34 396.107a31.562 31.562 0 0 1-33.383-27.921 31.562 31.562 0 0 1 33.383-27.921 27.921 27.921 0 1 1 0 55.842z" fill="#FFF"></path></svg></a></div></div> <hr> <!----> <div class="content__sidebar-top"></div> <nav class="sidebar-nav-links"><div class="nav-item"><a href="/myblog/" class="nav-link router-link-active"><!---->
  首页
</a></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="Front-end Basics" class="dropdown-title"><span class="title"><!---->
      前端基础
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/html/" class="nav-link"><!---->
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/css/" class="nav-link"><!---->
  Css
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/javascript/" class="nav-link"><!---->
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/typescript/" class="nav-link"><!---->
  TypeScript
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title"><!---->
      计算机基础
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/algorithms/" class="nav-link"><!---->
  数据结构和算法
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/network/" class="nav-link"><!---->
  计算机网络/HTTP
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/network/输入url到页面展示全过程/" class="nav-link"><!---->
  输入url到页面展示全过程
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/operating-system/" class="nav-link"><!---->
  操作系统
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/design-model/" class="nav-link"><!---->
  设计模式
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/Web-Security/" class="nav-link"><!---->
  Web安全
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="框架和源码分析" class="dropdown-title"><span class="title"><!---->
      框架和源码分析
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/vue/Vue2原理和源码分析.html" class="nav-link"><!---->
  Vue 专题
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/React/" class="nav-link"><!---->
  React 专题
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/webpack/webpack构建原理.html" class="nav-link"><!---->
  webpack 专题
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/vite/" class="nav-link"><!---->
  vite 专题
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/axios/" class="nav-link"><!---->
  Axios 专题
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="浏览器" class="dropdown-title"><span class="title"><!---->
      浏览器
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/browser/浏览器原理/" class="nav-link"><!---->
  浏览器原理
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/browser/前端缓存和存储/" class="nav-link"><!---->
  前端缓存和存储
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/performance/前端调试技巧/" class="nav-link"><!---->
  前端调试技巧
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="node.js" class="dropdown-title"><span class="title"><!---->
      服务器
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/node/" class="nav-link"><!---->
  Node.js
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/linux/" class="nav-link"><!---->
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/mysql/" class="nav-link"><!---->
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/nginx/" class="nav-link"><!---->
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/docker/" class="nav-link"><!---->
  Docker
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="浏览器和性能优化" class="dropdown-title"><span class="title"><!---->
      性能优化
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/performance/性能优化指标和监控/" class="nav-link"><!---->
  性能优化指标和监控
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/performance/前端性能优化方案/" class="nav-link"><!---->
  前端性能优化方案
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/performance/一次管理后台的渲染优化/" class="nav-link"><!---->
  一次管理后台的渲染优化
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="前端工程" class="dropdown-title"><span class="title"><!---->
      前端工程
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/Front-end-Engineering/前端工程化/" class="nav-link"><!---->
  前端工程化
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/Front-end-Engineering/前端渲染架构/" class="nav-link"><!---->
  前端渲染架构
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/Front-end-Engineering/前端架构实践/" class="nav-link"><!---->
  前端架构实践
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/Front-end-Engineering/npm/" class="nav-link"><!---->
  npm
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/git/" class="nav-link"><!---->
  Git
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/projectDeploy/自动构建和部署/" class="nav-link"><!---->
  自动构建和部署
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="项目实践" class="dropdown-title"><span class="title"><!---->
      项目实践
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/projectDeploy/" class="nav-link"><!---->
  前端部署
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/componentsEncapsulation/组件和组件封装实践.html" class="nav-link"><!---->
  组件和组件封装实践
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/projectsSummary/登录与单点登录/" class="nav-link"><!---->
  登录与单点登录
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/projectsSummary/权限管理方案实践/" class="nav-link"><!---->
  权限管理方案实践
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/projectsSummary/Echarts二次封装实践/" class="nav-link"><!---->
  Echarts二次封装实践
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/projectsSummary/文档在线预览和编辑方案/" class="nav-link"><!---->
  文档在线预览和编辑方案
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/projectsSummary/移动端开发实践/" class="nav-link"><!---->
  移动端开发实践
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="项目搭建到原理分析" class="dropdown-title"><span class="title"><!---->
      项目搭建
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/projectsSummary/从零到一搭建SSR项目/" class="nav-link"><!---->
  从零到一搭建SSR项目
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/projectsSummary/从零到一搭建移动端SSG项目/" class="nav-link"><!---->
  从零到一搭建移动端SSG项目
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/projectsSummary/移动端SSG项目实践/" class="nav-link"><!---->
  移动端SSG项目实践
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/projectsSummary/从零到一搭建Vue2工程化项目/" class="nav-link"><!---->
  从零到一搭建Vue2工程化项目
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/projectsSummary/从零到一搭建Vue3工程化项目/" class="nav-link"><!---->
  从零到一搭建Vue3工程化项目
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/projectsSummary/搭建低代码平台/" class="nav-link"><!---->
  搭建低代码平台
</a></li><li class="dropdown-item"><!----> <a href="/myblog/projectDeploy/projectsSummary/混合桌面应用开发实践/" class="nav-link"><!---->
  混合桌面应用开发实践
</a></li></ul></div></div> <!----></nav> <!----> <div class="content__sidebar-center"></div> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><!----> <span class="title">基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/myblog/projectDeploy/" aria-current="page" class="sidebar-link">目录</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/#自动构建和部署" class="sidebar-link">自动构建和部署</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/#前端部署原理" class="sidebar-link">前端部署原理</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/#前端发版静态资源404问题" class="sidebar-link">前端发版静态资源404问题</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><!----> <span class="title">原理</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E9%83%A8%E7%BD%B2%E5%8E%9F%E7%90%86/" class="sidebar-link">前端部署原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E9%83%A8%E7%BD%B2%E5%8E%9F%E7%90%86/#前端手动部署" class="sidebar-link">前端手动部署</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E9%83%A8%E7%BD%B2%E5%8E%9F%E7%90%86/#前端手动发版流程" class="sidebar-link heading3">前端手动发版流程</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E9%83%A8%E7%BD%B2%E5%8E%9F%E7%90%86/#静态资源服务搭建" class="sidebar-link heading3">静态资源服务搭建</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E9%83%A8%E7%BD%B2%E5%8E%9F%E7%90%86/#存在问题" class="sidebar-link heading3">存在问题</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E9%83%A8%E7%BD%B2%E5%8E%9F%E7%90%86/#前端自动化部署" class="sidebar-link">前端自动化部署</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E9%83%A8%E7%BD%B2%E5%8E%9F%E7%90%86/#概念" class="sidebar-link heading3">概念</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E9%83%A8%E7%BD%B2%E5%8E%9F%E7%90%86/#流程" class="sidebar-link heading3">流程</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E9%83%A8%E7%BD%B2%E5%8E%9F%E7%90%86/#方案" class="sidebar-link heading3">方案</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E9%83%A8%E7%BD%B2%E5%8E%9F%E7%90%86/#前端部署发展过程" class="sidebar-link">前端部署发展过程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E9%83%A8%E7%BD%B2%E5%8E%9F%E7%90%86/#原始部署" class="sidebar-link heading3">原始部署</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E9%83%A8%E7%BD%B2%E5%8E%9F%E7%90%86/#使用强制缓存" class="sidebar-link heading3">使用强制缓存</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E9%83%A8%E7%BD%B2%E5%8E%9F%E7%90%86/#静态资源添加版本号" class="sidebar-link heading3">静态资源添加版本号</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E9%83%A8%E7%BD%B2%E5%8E%9F%E7%90%86/#文件级别的精确缓存控制" class="sidebar-link heading3">文件级别的精确缓存控制</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E9%83%A8%E7%BD%B2%E5%8E%9F%E7%90%86/#动静资源分离部署" class="sidebar-link heading3">动静资源分离部署</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E9%83%A8%E7%BD%B2%E5%8E%9F%E7%90%86/#非覆盖式发布" class="sidebar-link heading3">非覆盖式发布</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E9%83%A8%E7%BD%B2%E5%8E%9F%E7%90%86/#静态资源优化方案总结" class="sidebar-link heading3">静态资源优化方案总结</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E9%83%A8%E7%BD%B2%E5%8E%9F%E7%90%86/#参考资料" class="sidebar-link">参考资料</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><!----> <span class="title">实践</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/myblog/projectDeploy/%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA%E5%92%8C%E9%83%A8%E7%BD%B2/" class="sidebar-link">前端自动部署</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA%E5%92%8C%E9%83%A8%E7%BD%B2/#cicd-概念" class="sidebar-link">CICD 概念</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA%E5%92%8C%E9%83%A8%E7%BD%B2/#cicd-方案" class="sidebar-link">CICD 方案</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA%E5%92%8C%E9%83%A8%E7%BD%B2/#自定义脚本部署" class="sidebar-link">自定义脚本部署</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA%E5%92%8C%E9%83%A8%E7%BD%B2/#所需资源" class="sidebar-link heading3">所需资源</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA%E5%92%8C%E9%83%A8%E7%BD%B2/#使用技术" class="sidebar-link heading3">使用技术</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA%E5%92%8C%E9%83%A8%E7%BD%B2/#部署规范" class="sidebar-link heading3">部署规范</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA%E5%92%8C%E9%83%A8%E7%BD%B2/#实现方案" class="sidebar-link heading3">实现方案</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA%E5%92%8C%E9%83%A8%E7%BD%B2/#总结" class="sidebar-link heading3">总结</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA%E5%92%8C%E9%83%A8%E7%BD%B2/#jenkins-部署" class="sidebar-link">Jenkins 部署</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA%E5%92%8C%E9%83%A8%E7%BD%B2/#jenkins" class="sidebar-link heading3">Jenkins</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA%E5%92%8C%E9%83%A8%E7%BD%B2/#使用npm构建node-js和react应用" class="sidebar-link heading3">使用npm构建Node.js和React应用</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA%E5%92%8C%E9%83%A8%E7%BD%B2/#在docker中运行jenkins" class="sidebar-link heading3">在Docker中运行Jenkins</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA%E5%92%8C%E9%83%A8%E7%BD%B2/#参考资料" class="sidebar-link">参考资料</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA%E5%92%8C%E9%83%A8%E7%BD%B2/#现状" class="sidebar-link">现状</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA%E5%92%8C%E9%83%A8%E7%BD%B2/#代码自动回滚方案" class="sidebar-link">代码自动回滚方案</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA%E5%92%8C%E9%83%A8%E7%BD%B2/#使用-node-脚本回滚" class="sidebar-link">使用 Node 脚本回滚</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA%E5%92%8C%E9%83%A8%E7%BD%B2/#参考资料-2" class="sidebar-link">参考资料</a></li></ul></li><li><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E5%8F%91%E7%89%88%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90404%E9%97%AE%E9%A2%98/" aria-current="page" class="active sidebar-link">前端发版静态资源404问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E5%8F%91%E7%89%88%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90404%E9%97%AE%E9%A2%98/#背景" class="sidebar-link">背景</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E5%8F%91%E7%89%88%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90404%E9%97%AE%E9%A2%98/#现象描述" class="sidebar-link">现象描述</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E5%8F%91%E7%89%88%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90404%E9%97%AE%E9%A2%98/#问题复现" class="sidebar-link">问题复现</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E5%8F%91%E7%89%88%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90404%E9%97%AE%E9%A2%98/#原因分析" class="sidebar-link">原因分析</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E5%8F%91%E7%89%88%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90404%E9%97%AE%E9%A2%98/#模块按需加载问题" class="sidebar-link heading3">模块按需加载问题</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E5%8F%91%E7%89%88%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90404%E9%97%AE%E9%A2%98/#浏览器缓存问题" class="sidebar-link heading3">浏览器缓存问题</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E5%8F%91%E7%89%88%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90404%E9%97%AE%E9%A2%98/#资源404原因分析" class="sidebar-link heading3">资源404原因分析</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E5%8F%91%E7%89%88%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90404%E9%97%AE%E9%A2%98/#解决方案" class="sidebar-link">解决方案</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E5%8F%91%E7%89%88%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90404%E9%97%AE%E9%A2%98/#nginx反向代理" class="sidebar-link heading3">nginx反向代理</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E5%8F%91%E7%89%88%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90404%E9%97%AE%E9%A2%98/#在-html-页面加-meta-标签" class="sidebar-link heading3">在 html 页面加 `meta` 标签</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E5%8F%91%E7%89%88%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90404%E9%97%AE%E9%A2%98/#输出文件添加版本号" class="sidebar-link heading3">输出文件添加版本号</a></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E5%8F%91%E7%89%88%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90404%E9%97%AE%E9%A2%98/#版本更新检查插件" class="sidebar-link heading3">版本更新检查插件</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E5%8F%91%E7%89%88%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90404%E9%97%AE%E9%A2%98/#参考资料" class="sidebar-link">参考资料</a></li></ul></li></ul></section></li></ul> <!----> <div class="content__sidebar-bottom"></div> <!----></aside> <main class="page"><nav class="breadcrumb"><ol vocab="https://schema.org/" typeof="BreadcrumbList"><li property="itemListElement" typeof="ListItem"><a href="/myblog/projectDeploy/" property="item" typeof="WebPage" class="router-link-active"><!----> <span property="name">目录</span></a> <meta property="position" content="1"></li><li property="itemListElement" typeof="ListItem" class="is-active"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E5%8F%91%E7%89%88%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90404%E9%97%AE%E9%A2%98/" aria-current="page" property="item" typeof="WebPage" class="router-link-exact-active router-link-active"><!----> <span property="name">前端发版静态资源404问题</span></a> <meta property="position" content="2"></li></ol></nav> <!----> <div class="content__page-top"></div> <div vocab="https://schema.org/" typeof="Article" class="page-title"><h1><!----> <span property="headline">前端发版静态资源404问题</span></h1> <div class="page-info"><!----> <true-info defaultAuthor="" categoryPath="/category/$category/" tagPath="/tag/$tag/"></true-info><true-info defaultAuthor="" categoryPath="/category/$category/" tagPath="/tag/$tag/"></true-info><true-info defaultAuthor="" categoryPath="/category/$category/" tagPath="/tag/$tag/"></true-info><true-info defaultAuthor="" categoryPath="/category/$category/" tagPath="/tag/$tag/"></true-info><true-info defaultAuthor="" categoryPath="/category/$category/" tagPath="/tag/$tag/"></true-info><true-info defaultAuthor="" categoryPath="/category/$category/" tagPath="/tag/$tag/"></true-info><true-info defaultAuthor="" categoryPath="/category/$category/" tagPath="/tag/$tag/"></true-info></div> <!----> <hr></div> <div class="anchor-place-holder"><aside id="anchor"><div class="anchor-wrapper"><ul class="anchor-list"><li class="anchor"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E5%8F%91%E7%89%88%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90404%E9%97%AE%E9%A2%98/#背景" class="anchor-link heading2"><div>背景</div></a></li><li class="anchor"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E5%8F%91%E7%89%88%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90404%E9%97%AE%E9%A2%98/#现象描述" class="anchor-link heading2"><div>现象描述</div></a></li><li class="anchor"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E5%8F%91%E7%89%88%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90404%E9%97%AE%E9%A2%98/#问题复现" class="anchor-link heading2"><div>问题复现</div></a></li><li class="anchor"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E5%8F%91%E7%89%88%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90404%E9%97%AE%E9%A2%98/#原因分析" class="anchor-link heading2"><div>原因分析</div></a></li><li class="anchor"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E5%8F%91%E7%89%88%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90404%E9%97%AE%E9%A2%98/#模块按需加载问题" class="anchor-link heading3"><div>模块按需加载问题</div></a></li><li class="anchor"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E5%8F%91%E7%89%88%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90404%E9%97%AE%E9%A2%98/#浏览器缓存问题" class="anchor-link heading3"><div>浏览器缓存问题</div></a></li><li class="anchor"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E5%8F%91%E7%89%88%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90404%E9%97%AE%E9%A2%98/#资源404原因分析" class="anchor-link heading3"><div>资源404原因分析</div></a></li><li class="anchor"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E5%8F%91%E7%89%88%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90404%E9%97%AE%E9%A2%98/#解决方案" class="anchor-link heading2"><div>解决方案</div></a></li><li class="anchor"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E5%8F%91%E7%89%88%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90404%E9%97%AE%E9%A2%98/#nginx反向代理" class="anchor-link heading3"><div>nginx反向代理</div></a></li><li class="anchor"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E5%8F%91%E7%89%88%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90404%E9%97%AE%E9%A2%98/#在-html-页面加-meta-标签" class="anchor-link heading3"><div>在 html 页面加 `meta` 标签</div></a></li><li class="anchor"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E5%8F%91%E7%89%88%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90404%E9%97%AE%E9%A2%98/#输出文件添加版本号" class="anchor-link heading3"><div>输出文件添加版本号</div></a></li><li class="anchor"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E5%8F%91%E7%89%88%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90404%E9%97%AE%E9%A2%98/#版本更新检查插件" class="anchor-link heading3"><div>版本更新检查插件</div></a></li><li class="anchor"><a href="/myblog/projectDeploy/%E5%89%8D%E7%AB%AF%E5%8F%91%E7%89%88%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90404%E9%97%AE%E9%A2%98/#参考资料" class="anchor-link heading2"><div>参考资料</div></a></li></ul></div></aside></div> <!----> <div class="content__content-top"></div> <div class="theme-default-content content__default"><h1 id="前端发版静态资源404问题"><a href="#前端发版静态资源404问题" class="header-anchor">#</a> 前端发版静态资源404问题</h1> <h2 id="背景"><a href="#背景" class="header-anchor">#</a> 背景</h2> <blockquote><p>一个使用 Vue 开发的单页面应用，在一次测试在使用中，发现使用着使用着，突然页面点击无效果（使用中前端进行过一次发版），测试打开控制台，发现控制台一堆 js 文件的 404 报错：</p> <p><img src="/myblog/assets/img/前端发版静态资源找不到问题.8747a9bd.png" alt="image-20240118155034294"></p></blockquote> <h2 id="现象描述"><a href="#现象描述" class="header-anchor">#</a> 现象描述</h2> <p>根据测试反馈现象如下：</p> <ol><li>用户在使用过程中，之前点击某个页面是正常，(当前发版之后)，点击其他页面无任何反应;</li> <li>打开控制台，点击任何一个页面时候，会动态加载的一个 JS 文件，然后 JS 文件加载显示 404 报错；</li> <li>测试员浏览器 -&gt; 开发者工具 -&gt; 控制台 -&gt; 网络 -&gt; 停用缓存 ， 停用缓存 选项未勾选。</li> <li>当测试员刷新页面后，又能重新正常加载静态资源。</li></ol> <h2 id="问题复现"><a href="#问题复现" class="header-anchor">#</a> <strong>问题复现</strong></h2> <ol><li>打开浏览器 -&gt; 开发者工具 -&gt; 控制台 -&gt; 网络 -&gt; 停用缓存 ， 停用缓存 选项未勾选；</li> <li>打开项目，进入模块 A，页面停留在模块 A 不动；</li> <li>前端打包资源并发布版本；</li> <li>回到项目，点击模块 B 页面；</li> <li>查看浏览器 -&gt; 开发者工具 -&gt; 控制台 -&gt; 网络，发现 B 模块静态资源 JS 文件加载失败，显示  404 状态；</li> <li>浏览器刷新页面后，模块 B 静态资源加载成功，但是此时模块 B 的静态资源 JS 文件名称发生了变化；</li> <li>对比本地构建后的静态资源文件，发现可以找到 B 模块的 JS 资源文件，证明刷新后重新获取了更新发版后的 JS 资源文件；</li></ol> <h2 id="原因分析"><a href="#原因分析" class="header-anchor">#</a> 原因分析</h2> <blockquote><p>通过分析现象发现，实际是前端更新已上线的项目，用户的浏览器显示的却是旧版的页面（浏览器缓存），没有及时获取到更新的资源，浏览器请求旧版本资源，但是旧版本资源已经被新版本资源覆盖，已经不存在，所以产生 404 报错；</p> <p>此时，如果用户刷新一下页面，就得到更新后的资源</p></blockquote> <p>在分析产生浏览器缓存之前，我们先需要了解，在我们单页面应用中，静态资源是如何被分割和缓存的；</p> <p>在我们们开发时候，经常会在项目中使用模块按需加载：</p> <h3 id="模块按需加载问题"><a href="#模块按需加载问题" class="header-anchor">#</a> <strong>模块按需加载问题</strong></h3> <ul><li><p>在使用 Vue/React 构建的单页面应用中，因为许多功能都集中的做到了一个 HTML中， 为了避免一次性的加载所有功能对应的代码，解决加载缓慢、交互卡顿问题；我们通常会在项目中使用 动态加载模块机制 ，通过使用 webpack  按需加载机制，把每一类合并为一个 Chunk，按需加载对应的 Chunk，<strong>不同模块的同类静态资源通过在文件名称后添加hash区分</strong>；（参考资料：<a href="https://webpack.wuhaolin.cn/4%E4%BC%98%E5%8C%96/4-12%E6%8C%89%E9%9C%80%E5%8A%A0%E8%BD%BD.html" target="_blank" rel="noopener noreferrer">《深入浅出webpack-分割代码按需加载》<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>）</p></li> <li><p>在使用 Vue/React 构建的单页面应用中，通过使用路由的按需加载，实现根据路由动态加载路由模块：</p> <ul><li><p>Vue 项目路由配置中通过动态引入组件实现路由模块按需加载：<img src="/myblog/assets/img/vue按需加载.2eec57ef.png" alt="image-20240118165028880"></p></li> <li><p>产生现象：</p> <ul><li><p>点击模块 A 时，网络请求加载以下静态资源文件：</p> <p><img src="/myblog/assets/img/动态加载模块.a0dcb35b.png" alt="image-20240118165447549"></p></li> <li><p>点击模块 B 时，加载模块 B 的静态资源文件： <img src="/myblog/assets/img/动态加载模块2.1a4a0127.png" alt="image-20240118165802979"></p></li></ul></li></ul></li></ul> <p>从上图分析可看出，通过 动态引入组件实现路由模块按需加载，webpack 在构建时候会将不同路由组件打包成不同的代码 chunk，通过文件名称+hash 的方式区分相同类型的不同文件。</p> <h3 id="浏览器缓存问题"><a href="#浏览器缓存问题" class="header-anchor">#</a> <strong>浏览器缓存问题</strong></h3> <blockquote><p>浏览器缓存是前端优化的一个重要问题，缓存可以带来很多好处：</p> <ol><li>减少冗余的数据传输，节省带宽；</li> <li>减轻服务器的请求负担，有缓存就可以少向服务器发送请求，尤其是对于一些访问量大的网站这点还是很重要的；</li> <li>资源从缓存中读取，无需向服务器发送请求再等待返回，加快了客户端的访问速度。</li></ol> <p>但是缓存同样给前端带来了一个很严重的问题：<strong>前端发版静态资源404问题</strong></p> <ul><li>如果前端重新构建资源发布新的版本，但是用户访问时浏览器读取的是缓存资源，那么用户就获取不到最新的页面，影响用户使用。</li></ul> <p>浏览器缓存主要指http缓存，其机制是根据http报文的缓存标识进行相应操作。</p></blockquote> <h4 id="浏览器缓存介绍"><a href="#浏览器缓存介绍" class="header-anchor">#</a> <strong>浏览器缓存介绍</strong></h4> <p>浏览器缓存位置有：</p> <ul><li><strong>Service Worker</strong>：运行在浏览器背后的独立线程，可以让我们自由控制缓存哪些文件、如何匹配缓存、如何读取缓存，并且缓存是持续性的；</li> <li><strong>Memory Cache</strong>： 内存中的缓存；缓存持续性很短，会随着进程的释放而释放。<strong>一旦我们关闭 Tab 页面，内存中的缓存也就被释放了</strong>。</li> <li><strong>Disk Cache</strong>：存储在硬盘中的缓存；根据 HTTP Herder 中的字段判断哪些资源需要缓存，哪些资源可以不请求直接使用，哪些资源已经过期需要重新请求。</li> <li><strong>Push Cache</strong>：HTTP/2 中的内容，<strong>只在会话（Session）中存在，一旦会话结束就被释放，并且缓存时间也很短暂</strong>，在Chrome浏览器中只有5分钟左右，同时它也并非严格执行HTTP头中的缓存指令。</li></ul> <blockquote><p><em>详细的浏览器缓存知识参考我的博客：<a href="https://sewar-x.github.io/browser/%E5%89%8D%E7%AB%AF%E5%AD%98%E5%82%A8/#%E6%B5%8F%E8%A7%88%E5%99%A8%E7%BC%93%E5%AD%98%E6%9C%BA%E5%88%B6" target="_blank" rel="noopener noreferrer">前端存储 | Sewen 博客 (sewar-x.github.io)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></em></p></blockquote> <h4 id="浏览器缓存检查"><a href="#浏览器缓存检查" class="header-anchor">#</a> <strong>浏览器缓存检查</strong></h4> <p>通过以下操作，可以查看浏览器是否使用了缓存：</p> <p><strong>第一步：</strong></p> <p>禁止勾选浏览器开发者工具中 “禁用缓存选项”：打开浏览器  -&gt; 开发者工具 -&gt; 控制台 -&gt; 网络</p> <p><img src="/myblog/assets/img/浏览器缓存操作3.81665756.png" alt="image-20240119101631923"></p> <p><strong>第二步：</strong></p> <p>打开浏览器  -&gt; 开发者工具 -&gt; 控制台 -&gt; 网络 -&gt; 查看全部资源-&gt; 点击模块资源 -&gt;  检查 http 状态码：</p> <p><strong>首次点击加载模块</strong>，查看资源请求状态：</p> <p><img src="/myblog/assets/img/浏览器缓存4.27c76148.png" alt="image-20240119102723498"></p> <blockquote><p>从上图可以看到，首次请求时候：</p> <ol><li><p>浏览器会直接请求服务器，从服务器获取当前JS资源</p></li> <li><p>然后浏览器会返回当前资源的缓存标识，告诉浏览器需要缓存当前JS资源，浏览器会将此资源缓存到内存缓存中；</p></li></ol> <img src="/myblog/assets/img/浏览器第一次请求缓存.3da636ad.png" alt="image-20240119104745465" style="zoom:80%;"></blockquote> <p><strong>第三步：</strong></p> <p>刷新当前页面，查看资源请求状态：</p> <p><img src="/myblog/assets/img/浏览器缓存5.391cc571.png" alt="image-20240119103607703"></p> <blockquote><p>从上图可以看到，当刷新页面时候：</p> <ol><li>浏览器判断当前资源缓存标识，发现缓存尚未失效，强制缓存生效；</li> <li>浏览器直接通过浏览器内存缓存中获取该资源，并返回；
<img src="/myblog/assets/img/强制缓存生效.4588f5bf.png" alt="image-20240119104925927" style="zoom:80%;"></li></ol></blockquote> <p><strong>第四步</strong></p> <ol><li>关闭当前页面，重新打开浏览器tab并打开页面；</li> <li>刷新当前页面，查看资源请求状态：</li></ol> <p><img src="/myblog/assets/img/协商缓存示例.a44c0951.png" alt="image-20240119105508718"></p> <blockquote><p>从 上图可以看到，刷新页面后，再次请求资源时，进行<strong>协商缓存</strong>：</p> <ol><li>浏览器发现资源缓存的内存缓存已经失效；</li> <li>浏览器携带缓存标识请求服务器资源；</li> <li>服务器返回 304 表示该静态资源无更新；</li> <li>浏览器发现 304 资源无更新，则从本地磁盘缓存中查找该资源；</li></ol> <img src="/myblog/assets/img/协商缓存.80f26580.png" alt="image-20240119105104986" style="zoom:80%;"></blockquote> <p><strong>第五步</strong></p> <ol><li>前端重新构建项目，重新发布版本；</li> <li>打开模块页面，刷新，查看资源请求状态：</li></ol> <p><img src="/myblog/assets/img/浏览器缓存3.f9f7f22c.png" alt="image-20240118174302178"></p> <blockquote><p>从上图可以看到，当我们重新构建前端项目，重新发布版本之后，再次打开原来项目，刷新页面后：</p> <ol><li>浏览器根据缓存标识，向浏览器缓存中获取JS资源；</li> <li>浏览器缓存发现JS缓存失效，则返回告诉浏览器，资源缓存失效；</li> <li>浏览器会拿到缓存标识，向服务器发送请求；</li> <li>服务器返回 200 状态和最新的 JS 资源；</li> <li>浏览器根据缓存标识，将资源存入本地缓存；</li> <li>当用户再次刷新页面时候，浏览器缓存标识，从本地获取资源；</li></ol> <img src="/myblog/assets/img/协商缓存失效.3953fef2.png" alt="image-20240119110211453" style="zoom:80%;"></blockquote> <h3 id="资源404原因分析"><a href="#资源404原因分析" class="header-anchor">#</a> <strong>资源404原因分析</strong></h3> <p>通过以上按需加载和浏览器缓存过程分析可知：</p> <ol><li><p>项目中通过模块按需加载将项目静态资源进行分割，因此不同页面模块的 JS 资源不同，在点击项目不同模块时候，为了减少项目体积，会进行按需加载资源，动态请求当前模块资源；</p></li> <li><p>首次请求时候，浏览器会请求模块对应资源；</p></li> <li><p>浏览器在首次加载模块时可能会对静态资源文件进行缓存，并设置了一个过期时间。当重新发布静态资源后，新的模块的静态资源文件的URL与旧的模块的静态资源文件的URL不同，浏览器可能仍然使用了旧的缓存文件，导致加载失败；</p></li> <li><p>由于浏览器的缓存策略导致态资源HTML文件被缓存，浏览器获取的是旧版本的 HTML 资源，而其他静态资源通过 HTML 文件中定义的名称获取，因此当发布新的版本时，浏览器依旧通过旧版本HTML文件中定义的其他资源旧名称获取资源，导致加载 404 错误。</p> <p><img src="/myblog/assets/img/静态资源404报错问题.270fb302.png" alt="image-20240131094237119"></p></li></ol> <blockquote><p>可能导致静态资源加载失败的原因：</p> <ol><li><strong>页面缓存</strong>：
<ul><li>虽然静态资源文件名称每次发版后都会发生变化 (hash值发生变化)，但浏览器可能仍然缓存了旧版本的HTML文件。</li> <li>当重新发布静态资源后，浏览器会请求新的静态资源文件，但仍然使用缓存的旧版本HTML文件中引用的静态资源文件名称，导致加载失败。</li> <li>解决方案是在HTML文件的<code>&lt;link&gt;</code>或<code>&lt;script&gt;</code>标签中，添加版本号或哈希值来确保引用的静态资源文件名称与实际发布的文件名称保持一致。</li></ul></li> <li><strong>引用路径问题</strong>：
<ul><li>在更新项目版本后，除了静态资源文件名称发生变化外，还需要确保HTML文件中引用的静态资源文件的路径正确。</li> <li>如果路径不正确，浏览器无法找到对应的静态资源文件，导致加载失败。</li> <li>因此需要确保HTML文件中引用的静态资源文件的路径与实际发布的路径一致。</li></ul></li> <li><strong>服务器配置</strong>：
<ul><li>在静态资源服务器上，可能存在配置问题，导致无法正确访问新版本的静态资源文件。</li> <li>确保静态资源服务器配置正确，并能够正确地提供新版本的静态资源文件。</li></ul></li></ol> <p>总结起来，静态资源加载失败的原因可能包括： 浏览器缓存旧版本HTML文件、引用路径不正确以及服务器配置问题。</p> <p>可以尝试清除浏览器缓存、检查HTML文件中的静态资源引用路径，以及确保静态资源服务器能够正确提供新版本的静态资源文件，以解决静态资源加载失败的问题。</p></blockquote> <h2 id="解决方案"><a href="#解决方案" class="header-anchor">#</a> 解决方案</h2> <h3 id="nginx反向代理"><a href="#nginx反向代理" class="header-anchor">#</a> <strong>nginx反向代理</strong></h3> <blockquote><p>以 Vue 为例，Vue 在打包的时候，<code>css</code> 和 <code>js</code> 名字都加了哈希值，所以改动后打包生成的js和css是唯一的，页面请求的是新资源，不会有缓存问题。</p> <p>但是入口文件 <code>index.html</code> 会因为缓存造成更新问题，如果我们更新了，但是浏览器使用的是缓存，就会出现问题。</p> <p>所以需要对入口文件设置不使用强制缓存，需要每次去服务器验证文件是否修改，即使用协商缓存。</p> <p>使用 <code>nginx</code> 反向代理，在 <code>nginx.conf</code>文件的对应 <code>server</code>中设置 <code>Cache-Control no-store</code></p></blockquote> <p><code>nginx</code> 反向代理配置示例：</p> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">listen</span>  监听端口号</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server_name</span>  域名</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">root</span>   文件目录</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">index</span>  index.html</span><span class="token punctuation">;</span>

    <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>  // 不加这一句，会出现nginx欢迎页面，无法正确加载资源
      <span class="token directive"><span class="token keyword">try_files</span> <span class="token variable">$uri</span> /index.html</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token directive"><span class="token keyword">location</span> ~ .*\.(html)$</span> <span class="token punctuation">{</span>  // 对html文件限制缓存
      <span class="token directive"><span class="token keyword">add_header</span> Cache-Control no-store</span><span class="token punctuation">;</span>  // 在此时添加，对 <span class="token directive"><span class="token keyword">html</span> 页面不缓存
     // 或者用add_header Cache-Control no-cache</span><span class="token punctuation">;</span>替代上面那一句，协商缓存
      <span class="token directive"><span class="token keyword">add_header</span> Pragma no-cache</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>注意：</p> <p><code>Cache-Control: no-cache</code> 和 <code>Cache-Control: no-store</code>区别 :</p> <blockquote><p>它们都是HTTP响应头中控制缓存行为的指令。但存在一些区别：</p> <ul><li><p><code>Cache-Control: no-cache</code>：这个指令告诉浏览器在使用缓存前需要先进行验证。</p> <ul><li>当浏览器接收到带有此指令的响应时，它会发送一个条件请求到服务器，以确定缓存的副本是否仍然有效。</li> <li>服务器可以通过检查响应的条件头（如 <code>ETag</code> 或 <code>Last-Modified</code>）来判断是否返回新的内容。</li> <li>如果服务器返回了状态码 304（Not Modified），则表示缓存的副本仍然有效，浏览器可以使用缓存。</li> <li>如果服务器返回了新的内容，浏览器将使用新的内容并更新缓存。</li></ul></li> <li><p><code>Cache-Control: no-store</code> ：这个指令告诉浏览器不要缓存任何响应内容，即使是临时的或私有的数据。</p> <ul><li>每次请求都必须从服务器获取完整的响应。</li> <li>这意味着响应的内容不会被保存在缓存中，也不会被写入磁盘或其他持久存储。</li> <li>这可以用于确保敏感数据不会被缓存，以增加安全性。</li></ul></li></ul> <p>总结起来，区别在于：</p> <ul><li><code>no-cache</code> 指令要求浏览器在使用缓存前进行验证，确保缓存的副本仍然有效，如果无效则获取新的内容更新缓存。</li> <li><code>no-store</code> 指令则要求浏览器不要缓存任何响应内容，每次请求都必须从服务器获取完整的响应，且不会将响应内容保存在</li></ul></blockquote> <p><code>Pragma: no-cache</code> 和 <code>Cache-Control: no-cache</code> 区别</p> <blockquote><p>都是用于控制缓存行为的HTTP头字段，但它们之间存在一些区别：</p> <ol><li><p><code>Pragma: no-cache</code>：这个头字段是 <code>HTTP/1.0</code> 时代的遗留字段，用于向旧版的HTTP客户端和缓存代理服务器传达不缓存响应的指令。在现代的 <code>HTTP/1.1</code> 中，推荐使用<code>Cache-Control</code>头字段来控制缓存行为。尽管 <code>Pragma: no-cache</code> 在一些情况下仍然被使用，但它不是HTTP/1.1规范中定义的首选方式。</p></li> <li><p><code>Cache-Control: no-cache</code>：这个头字段是HTTP/1.1引入的，并成为控制缓存行为的主要方式。它指示浏览器在使用缓存之前需要发送一个验证请求到服务器，以确定缓存的副本是否仍然有效。如果服务器返回了状态码304（Not Modified），则表示缓存的副本仍然有效，浏览器可以使用缓存。如果服务器返回了新的内容，浏览器将使用新的内容并更新缓存。</p></li></ol> <p>建议在现代的Web应用程序中使用 <code>Cache-Control: no-cache</code> 来控制缓存行为，而不是使用 <code>Pragma: no-cache</code>。</p></blockquote> <h3 id="在-html-页面加-meta-标签"><a href="#在-html-页面加-meta-标签" class="header-anchor">#</a> <strong>在 html 页面加 <code>meta</code> 标签</strong></h3> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pragram<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>no-cache<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cache-control<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>no-cache, no-store, must-revalidate<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>expires<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="输出文件添加版本号"><a href="#输出文件添加版本号" class="header-anchor">#</a> <strong>输出文件添加版本号</strong></h3> <h4 id="使用-vue-脚手架的情况下-vue-config-js"><a href="#使用-vue-脚手架的情况下-vue-config-js" class="header-anchor">#</a> <strong>使用 <code>Vue</code> 脚手架的情况下：<code>vue.config.js</code></strong></h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 动态版本号</span>
<span class="token keyword">const</span> version <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 配置</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">devServer</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">filenameHashing</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 打包的时候不使用 hash 值，因为后面自行添加时间戳或者版本号了</span>
  <span class="token literal-property property">css</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 是否使用 css 分离插件 ExtractTextPlugin</span>
    <span class="token literal-property property">extract</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 输出编译后的文件名称：【文件名称.时间戳】、【文件名称.版本号.时间戳】...</span>
      <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">css/[name].</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>version<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.css</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>   
      <span class="token literal-property property">chunkFilename</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">css/[name].</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>version<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.css</span><span class="token template-punctuation string">`</span></span>
       <span class="token comment">// 或使用如下配置，通过固定版本号+动态版本号</span>
      <span class="token comment">// filename: `css/[name].${process.env.VUE_APP_VERSION}.${version}.css`,   </span>
     <span class="token comment">// chunkFilename: `css/[name].${process.env.VUE_APP_VERSION}.${version}.css`</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">configureWebpack</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 输出编译后的文件名称：【文件名称.时间戳】、【文件名称.版本号.时间戳】...</span>
      <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">js/[name].</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>version<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.js</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
      <span class="token literal-property property">chunkFilename</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">js/[name].</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>version<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.js</span><span class="token template-punctuation string">`</span></span>
        <span class="token comment">// 或使用如下配置，通过固定版本号+动态版本号</span>
       <span class="token comment">// filename: `js/[name].${process.env.VUE_APP_VERSION}.${version}.js`,</span>
      <span class="token comment">// chunkFilename: `js/[name].${process.env.VUE_APP_VERSION}.${version}.js`</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h4 id="使用-vue-脚手架的情况下-vue-config-js-2"><a href="#使用-vue-脚手架的情况下-vue-config-js-2" class="header-anchor">#</a> <strong>使用 <code>Vue</code> 脚手架的情况下：<code>vue.config.js</code></strong></h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 动态版本号</span>
<span class="token keyword">const</span> version <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 配置</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">devServer</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">filenameHashing</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 打包的时候不使用 hash 值，因为后面自行添加时间戳或者版本号了</span>
  <span class="token literal-property property">css</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 是否使用 css 分离插件 ExtractTextPlugin</span>
    <span class="token literal-property property">extract</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 输出编译后的文件名称：【文件名称.时间戳】、【文件名称.版本号.时间戳】...</span>
      <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">css/[name].</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>version<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.css</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>   
      <span class="token literal-property property">chunkFilename</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">css/[name].</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>version<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.css</span><span class="token template-punctuation string">`</span></span>
      <span class="token comment">// 或使用如下配置，通过固定版本号+动态版本号</span>
     <span class="token comment">// filename: `css/[name].${process.env.VUE_APP_VERSION}.${version}.css`,   </span>
    <span class="token comment">// chunkFilename: `css/[name].${process.env.VUE_APP_VERSION}.${version}.css`</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">configureWebpack</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 输出编译后的文件名称：【文件名称.时间戳】、【文件名称.版本号.时间戳】...</span>
      <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">js/[name].</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>version<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.js</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
      <span class="token literal-property property">chunkFilename</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">js/[name].</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>version<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.js</span><span class="token template-punctuation string">`</span></span>
       <span class="token comment">// 或使用如下配置，通过固定版本号+动态版本号</span>
      <span class="token comment">// filename: `js/[name].${process.env.VUE_APP_VERSION}.${version}.js`,</span>
     <span class="token comment">// chunkFilename: `js/[name].${process.env.VUE_APP_VERSION}.${version}.js`</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h3 id="版本更新检查插件"><a href="#版本更新检查插件" class="header-anchor">#</a> <strong>版本更新检查插件</strong></h3> <p><strong>思路：</strong></p> <ol><li>将在创建项目时候，自动在本地使用随机数生成一个版本号；</li> <li>在项目路由中，切换页面或显示页面时，检查服务器是否有新版本：
<ul><li>有新版本则直接强制刷新或提示用户刷新，拉取最新版本代码</li></ul></li></ol> <p><strong>实现：</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 使用细节：</span>
<span class="token comment">// 1、导入方式：在 src 文件夹中使用可以 const version = require('@/utils/version') 这样引入使用，在根目录也就是 src 之外的文件夹则只能 const version = require('./src/utils/version') 这样引入使用</span>

<span class="token comment">/** 
  * 引入请求库（如果想使用 axios 请求，打开注释即可，下面 get 方法中也需要打开注释，默认使用JS原生请求）
  * const axios = require('axios')
  * 引入文件管理模块（基于 node 环境，如果为原生前端开发，则注释掉 fs 相关的代码即可，直接手动创建一个文件使用 get 方法获   
  * 取即可，注意统一存储内容格式看 create 方法注释）
 **/</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>

<span class="token comment">// 本地版本号缓存 key</span>
<span class="token keyword">const</span> storageKey <span class="token operator">=</span> <span class="token string">'currentVersion'</span>

<span class="token comment">/**
* 创建版本文件（由于 fs 基于 node，且只需要每次编译时创建更新一遍，所以推荐放置于 vue.config.js 文件顶部使用，然后使用 * build 命令时会被成功执行创建好文件）
* path: 文件路径以及文件名称（例如：verify.text, public/verify.json 都是存在 public 文件夹中）
* version: 版本号（例如：版本号、时间戳 ...，统一存储内容为：{ version: xxx }）
* result: 回调创建于写入结果
**/</span> 
<span class="token keyword">function</span> <span class="token function">create</span> <span class="token punctuation">(</span>path <span class="token operator">=</span> <span class="token string">'public/verify.json'</span><span class="token punctuation">,</span> version <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 在指定目录中添加校验文件</span>
  fs<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> version <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> isOK <span class="token operator">=</span> <span class="token operator">!</span><span class="token operator">!</span>err
    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">result</span><span class="token punctuation">(</span><span class="token punctuation">{</span> isOK <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 获取版本号（下面 get 方法）升级版（返回：当前版本号、是否有新版本。样例：{ version: xxx，new: true }，并缓存好新的版本号，可选择直接刷新页面。
vue 推荐放到路由守卫 router.afterEach(路由跳转后) 回调中，切换页面时随时检查版本是否更新，这个请求很快的，占用的时间几乎可以忽略，而且就是切换页面完成之后，就算失败或者网不好也不影响正常操作）
 *  path: 看下面 get 方法中的注释
 *  isReload: 如果有新版本使用，是否重新加载当前页面，强制浏览器重服务器获取当前页面资源，false 为后续自行手动刷新
 **/</span>
<span class="token keyword">function</span> <span class="token function">getVersion</span> <span class="token punctuation">(</span>path <span class="token operator">=</span> <span class="token string">'verify.json'</span><span class="token punctuation">,</span> isReload <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 获取版本号</span>
    <span class="token function">get</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 服务器版本号</span>
      <span class="token keyword">const</span> version <span class="token operator">=</span> res<span class="token punctuation">.</span>version
      <span class="token comment">// 检查是否有新版本</span>
      <span class="token keyword">const</span> isNew <span class="token operator">=</span> <span class="token function">isNewAvailable</span><span class="token punctuation">(</span>version<span class="token punctuation">)</span>
      <span class="token comment">// 缓存版本号</span>
      <span class="token function">save</span><span class="token punctuation">(</span>version<span class="token punctuation">)</span>
      <span class="token comment">// 有新版本的话是否重新从服务器加载页面数据</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>isNew <span class="token operator">&amp;&amp;</span> isReload<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
      <span class="token comment">// 返回</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">version</span><span class="token operator">:</span> version<span class="token punctuation">,</span> <span class="token keyword">new</span><span class="token operator">:</span> isNew <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 返回</span>
      <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 获取版本号（返回：当前版本号。样例：{ version: xxx }，vue 推荐放到路由守卫 router.afterEach(路由跳转后) 回调中，切换页面时随时检查版本是否更新，这个请求很快的，占用的时间几乎可以忽略，而且就是切换页面完成之后，就算失败或者网不好也不影响正常操作）
 * path: 服务器文件路径（例如上 create() 中的路径，文件存 build 后存放在 public 文件夹中，服务器路径则直接域 + 文件名既可，如果为原生前端开发也是一样）
 **/</span>
<span class="token keyword">function</span> <span class="token function">get</span> <span class="token punctuation">(</span>path <span class="token operator">=</span> <span class="token string">'verify.json'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 服务器文件路径</span>
  <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>origin <span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span> path <span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">?timestamp=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
  
  <span class="token comment">// axios 请求</span>
  <span class="token comment">// return new Promise((resolve, reject) =&gt; {</span>
  <span class="token comment">//   // 获取内容</span>
  <span class="token comment">//   axios.get(url).then(res =&gt; {</span>
  <span class="token comment">//     resolve(res)</span>
  <span class="token comment">//   }).catch(err =&gt; {</span>
  <span class="token comment">//     reject(err)</span>
  <span class="token comment">//   })</span>
  <span class="token comment">// })</span>

  <span class="token comment">// JS原生请求</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 创建 XMLHttpRequest 对象</span>
    <span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">null</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>XMLHttpRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 现代主流浏览器的写法</span>
      xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// IE浏览器的写法</span>
      xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ActiveXObject</span><span class="token punctuation">(</span><span class="token string">'Microsoft.XMLHTTP'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 创建网络请求对象</span>
    xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'get'</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token comment">// 发送请求</span>
    xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// 请求回调</span>
    xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 连接成功</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 请求成功</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 返回</span>
          <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// 连接失败</span>
        <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'获取失败'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 缓存版本号
 * version: 版本号（服务器获取到的版本号）
 **/</span>
<span class="token keyword">function</span> <span class="token function">save</span> <span class="token punctuation">(</span><span class="token parameter">version</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span>storageKey<span class="token punctuation">,</span> version<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 检查是否有新版本（true：有新版本 false：没有新版本）
 * version: 版本号（服务器获取到的版本号）
 **/</span>
<span class="token keyword">function</span> <span class="token function">isNewAvailable</span> <span class="token punctuation">(</span><span class="token parameter">version</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 没值（不清楚是否为新版本，默认返回 false, 如果这种情况下需要刷新，可修改返回 true）</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>version<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">false</span> <span class="token punctuation">}</span>
  <span class="token comment">// 获取本地缓存的版本号</span>
  <span class="token keyword">const</span> storageVersion <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>storageKey<span class="token punctuation">)</span>
  <span class="token comment">// 本地没有版本号，说明本机第一次加载，不算新版本</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>storageVersion <span class="token operator">||</span> storageVersion <span class="token operator">===</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">false</span> <span class="token punctuation">}</span>
  <span class="token comment">// 本地有版本号，进行对比</span>
  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>version<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token operator">!==</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>storageVersion<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>

<span class="token comment">// 刷新当前网页</span>
<span class="token keyword">function</span> <span class="token function">reload</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 重新加载当前页面，强制浏览器重服务器获取当前页面资源</span>
  window<span class="token punctuation">.</span>location<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 导出</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 创建版本文件</span>
  create<span class="token punctuation">,</span>
  <span class="token comment">// 获取版本号</span>
  get<span class="token punctuation">,</span>
  <span class="token comment">// 获取版本号升级版</span>
  getVersion<span class="token punctuation">,</span>
  <span class="token comment">// 缓存版本号</span>
  save<span class="token punctuation">,</span>
  <span class="token comment">// 检查是否有新版本</span>
  isNewAvailable<span class="token punctuation">,</span>
  <span class="token comment">// 刷新当前页面，强制浏览器重服务器获取当前页面资源</span>
  reload
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br></div></div><p><strong>使用:</strong></p> <ol><li><p>在构建文件中引入脚本，在项目构建时，自动创建新版本：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 在 build 时，每次创建/更新版本文件</span>
<span class="token keyword">const</span> version <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./src/utils/version'</span><span class="token punctuation">)</span>
version<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>方式一：在路由守卫中添加版本检查，当路由发生变化时候，获取项目版本号</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">'@/router'</span>
<span class="token keyword">const</span> version <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@/utils/version'</span><span class="token punctuation">)</span>
<span class="token comment">// 路由跳转后执行</span>
router<span class="token punctuation">.</span><span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> <span class="token keyword">from</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 如果不想每个路由都检查是否有新版本，只需要在特定的页面才需要检查版本，可以在这里做白名单判断</span>
  <span class="token comment">// 兼容版本，如果是新版本则进行刷新并缓存</span>
  version<span class="token punctuation">.</span><span class="token function">getVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 路由跳转前执行</span>
router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></li> <li><p>方式二：当浏览器 页面显示时候，获取项目版本号</p> <ol><li><p>创建页面显示检测插件：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> hidden <span class="token operator">=</span> <span class="token string">&quot;hidden&quot;</span><span class="token punctuation">;</span>

  <span class="token comment">// 检测浏览器是否支持Page Visibility API</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>hidden <span class="token keyword">in</span> document<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;visibilitychange&quot;</span><span class="token punctuation">,</span> handleVisibilityChange<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>hidden <span class="token operator">=</span> <span class="token string">&quot;mozHidden&quot;</span><span class="token punctuation">)</span> <span class="token keyword">in</span> document<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;mozvisibilitychange&quot;</span><span class="token punctuation">,</span> handleVisibilityChange<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>hidden <span class="token operator">=</span> <span class="token string">&quot;webkitHidden&quot;</span><span class="token punctuation">)</span> <span class="token keyword">in</span> document<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;webkitvisibilitychange&quot;</span><span class="token punctuation">,</span> handleVisibilityChange<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>hidden <span class="token operator">=</span> <span class="token string">&quot;msHidden&quot;</span><span class="token punctuation">)</span> <span class="token keyword">in</span> document<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;msvisibilitychange&quot;</span><span class="token punctuation">,</span> handleVisibilityChange<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&quot;onfocusin&quot;</span> <span class="token keyword">in</span> document<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 兼容旧版IE</span>
    document<span class="token punctuation">.</span>onfocusin <span class="token operator">=</span> document<span class="token punctuation">.</span>onfocusout <span class="token operator">=</span> handleVisibilityChange<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// 兼容其他浏览器</span>
    window<span class="token punctuation">.</span>onpageshow <span class="token operator">=</span> window<span class="token punctuation">.</span>onpagehide <span class="token operator">=</span> window<span class="token punctuation">.</span>onfocus <span class="token operator">=</span> window<span class="token punctuation">.</span>onblur <span class="token operator">=</span> handleVisibilityChange<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">handleVisibilityChange</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> visible <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>hidden <span class="token keyword">in</span> document<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      visible <span class="token operator">=</span> <span class="token operator">!</span>document<span class="token punctuation">[</span>hidden<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&quot;mozHidden&quot;</span> <span class="token keyword">in</span> document<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      visible <span class="token operator">=</span> <span class="token operator">!</span>document<span class="token punctuation">.</span>mozHidden<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&quot;webkitHidden&quot;</span> <span class="token keyword">in</span> document<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      visible <span class="token operator">=</span> <span class="token operator">!</span>document<span class="token punctuation">.</span>webkitHidden<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&quot;msHidden&quot;</span> <span class="token keyword">in</span> document<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      visible <span class="token operator">=</span> <span class="token operator">!</span>document<span class="token punctuation">.</span>msHidden<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>visible<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 用户切换到当前项目的浏览器选项卡，执行回调函数</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> pluginCallback <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">pluginCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 在插件中定义的回调函数</span>
  <span class="token keyword">var</span> <span class="token function-variable function">pluginCallback</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 在这里执行你的逻辑</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;用户切换到当前项目的浏览器选项卡&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token comment">// 暴露插件的回调函数，允许外部设置</span>
  window<span class="token punctuation">.</span><span class="token function-variable function">setPluginCallback</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> callback <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      pluginCallback <span class="token operator">=</span> callback<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br></div></div><blockquote><ol><li><p>将以上代码保存为一个 JavaScript 文件，例如 <code>tabVisibilityPlugin.js</code>。</p></li> <li><p>在你的 HTML 文件中引入该插件：<code>&lt;script src=&quot;tabVisibilityPlugin.js&quot;&gt;&lt;/script&gt;</code>，或者在 main.js 文件中引入。</p></li> <li><p>在需要执行回调函数的地方，使用 <code>setPluginCallback</code> 函数来设置回调函数，例如：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">setPluginCallback</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 当用户切换到当前项目的浏览器选项卡时，执行的逻辑</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;用户切换到当前项目的浏览器选项卡&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>当用户切换到你的项目所在的浏览器选项卡时，会执行设置的回调函数。你可以根据需要在回调函数中编写自己的逻辑。</p></li></ol></blockquote></li> <li><p>在使用的文件中，引入版本检查插件和显示页面检查插件：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">'@/router'</span>
<span class="token keyword">const</span> version <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@/utils/version'</span><span class="token punctuation">)</span>
<span class="token function">setPluginCallback</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 当用户切换到当前项目的浏览器选项卡时，执行的逻辑</span>
  <span class="token comment">// 兼容版本，如果是新版本则进行刷新并缓存</span>
  version<span class="token punctuation">.</span><span class="token function">getVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;用户切换到当前项目的浏览器选项卡&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li></ol></li></ol> <h4 id="femessage-update-popup"><a href="#femessage-update-popup" class="header-anchor">#</a> <strong>FEMessage/update-popup</strong></h4> <h5 id="文档地址"><a href="#文档地址" class="header-anchor">#</a> <strong>文档地址</strong></h5> <p><a href="https://github.com/FEMessage/update-popup" target="_blank" rel="noopener noreferrer">FEMessage/update-popup: 💬Display an update message at right bottom (github.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h5 id="作用"><a href="#作用" class="header-anchor">#</a> <strong>作用</strong></h5> <p>检查当前应用是否是最新版本。如果不是，它会提醒您重新加载当前页面。</p> <p><img src="/myblog/assets/img/update-popup.933e3451.gif" alt="update-popup"></p> <h5 id="原理"><a href="#原理" class="header-anchor">#</a> <strong>原理</strong></h5> <ol><li><p>在 webpack 每次构建时候，在资源目录下生成一个版本更新文件，文件内容保存版本值：</p> <p><img src="/myblog/assets/img/update-popup2.233c7bf5.png" alt="image-20240208095949037"></p></li> <li><p>监听文档 visibilitychange 事件, 当文档显示时候触发该事件，执行定时器；</p></li> <li><p>使用 JS 方法<code>startInterval</code> 定时获取版本文件的版本，比较当前内存中存在的版本id和文件中记录的版本id 是否相同，不相同则使用弹窗提示。</p></li> <li><p>用户点击刷新，调用 <code>window.location.reload()</code> 方法刷新页面。</p></li></ol> <h5 id="插件使用"><a href="#插件使用" class="header-anchor">#</a> <strong>插件使用</strong></h5> <p><strong>Vue2 中使用</strong></p> <p>在 <code>vue.config.js</code> 文件中配置如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 1.引入插件</span>
<span class="token keyword">const</span> UpdatePopup <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@femessage/update-popup'</span><span class="token punctuation">)</span> <span class="token comment">// 版本更新提醒插件</span>

<span class="token comment">// 2.配置 webpack 插件， 在 chainWebpack 属性中使用插件</span>
  <span class="token function">chainWebpack</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 版本更新提醒插件</span>
    config<span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span><span class="token string">'femessage-update-popup'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>UpdatePopup<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
      <span class="token literal-property property">auto</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h5 id="源码分析"><a href="#源码分析" class="header-anchor">#</a> <strong>源码分析</strong></h5> <p>插件位于 <code>./node_modules/@femessage/update-popup</code> 目录下。</p> <p><strong>入口文件分析：</strong></p> <p>入口文件为 <code>index.js</code> 文件：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">UpdatePopup</span> <span class="token punctuation">{</span>
  <span class="token comment">/** @param {UpdatePopupOptions} options */</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>options <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">publicPath</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
        <span class="token literal-property property">inject</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 自动注入到 webpack.entry</span>
        <span class="token literal-property property">envKey</span><span class="token operator">:</span> <span class="token string">'UPDATE_POPUP_VERSION'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">versionFileName</span><span class="token operator">:</span> <span class="token string">'update_popup_version.txt'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">auto</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 是否自动生成 version</span>
        <span class="token literal-property property">versionType</span><span class="token operator">:</span> <span class="token constant">VERSION_TYPES</span><span class="token punctuation">.</span><span class="token constant">TIMESTAMP</span> <span class="token comment">// 自动生成的 version 的方式</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      options
    <span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>auto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token constant">VERSION_TYPES</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>versionType<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span>
            <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Unknown versionType: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>versionType<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">. Falling back to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">VERSION_TYPES</span><span class="token punctuation">.</span><span class="token constant">TIMESTAMP</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
          <span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>versionType <span class="token operator">=</span> <span class="token constant">VERSION_TYPES</span><span class="token punctuation">.</span><span class="token constant">TIMESTAMP</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>versionType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token constant">VERSION_TYPES</span><span class="token punctuation">.</span><span class="token constant">TIMESTAMP</span><span class="token operator">:</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>version <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.0.0</span><span class="token template-punctuation string">`</span></span>
          <span class="token keyword">break</span>
        <span class="token keyword">default</span><span class="token operator">:</span>
          <span class="token keyword">break</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>version <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>envKey<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token string">'1.0.0'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//暴露 `apply` 方法提供给 webpack 调用；</span>
  <span class="token comment">/** @type {(compiler: import('webpack').Compiler) =&gt; void} */</span>
  <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// common</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token keyword">return</span>
    <span class="token comment">// v4</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">_get</span><span class="token punctuation">(</span>compiler<span class="token punctuation">,</span> <span class="token string">'options.mode'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token keyword">return</span>

    <span class="token comment">// 修改 webpack 入口文件</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>inject<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      compiler<span class="token punctuation">.</span>options<span class="token punctuation">.</span>entry <span class="token operator">=</span> <span class="token function">resolveWebpackEntry</span><span class="token punctuation">(</span>compiler<span class="token punctuation">.</span>options<span class="token punctuation">.</span>entry<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token constant">NAME</span><span class="token punctuation">,</span>
        <span class="token literal-property property">filePath</span><span class="token operator">:</span> <span class="token function">resolveApp</span><span class="token punctuation">(</span><span class="token string">'main.js'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 先生成写入版本号的文件到 app</span>
    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>beforeRun<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token constant">NAME</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 清空缓存文件夹</span>
      fs<span class="token punctuation">.</span><span class="token function">emptyDirSync</span><span class="token punctuation">(</span><span class="token function">resolveApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

      <span class="token keyword">const</span> publicPath <span class="token operator">=</span>
        <span class="token function">_get</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'options.publicPath'</span><span class="token punctuation">)</span> <span class="token operator">||</span>
        <span class="token function">_get</span><span class="token punctuation">(</span>compiler<span class="token punctuation">,</span> <span class="token string">'options.output.publicPath'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>

      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">generateFile</span><span class="token punctuation">(</span>
        <span class="token function">resolveApp</span><span class="token punctuation">(</span><span class="token string">'main.js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">readFile</span><span class="token punctuation">(</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">,</span> <span class="token string">'main.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token constant">VERSION_FILE_PATH</span><span class="token operator">:</span> <span class="token function">correctPath</span><span class="token punctuation">(</span>
            publicPath<span class="token punctuation">,</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>versionFileName
          <span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// 复制文件到 webpack 输出目录</span>
    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>done<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token constant">NAME</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> outputPath <span class="token operator">=</span> <span class="token function">_get</span><span class="token punctuation">(</span>compiler<span class="token punctuation">,</span> <span class="token string">'outputPath'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>

      <span class="token comment">// 版本号文件</span>
      fs<span class="token punctuation">.</span><span class="token function">outputFileSync</span><span class="token punctuation">(</span>
        <span class="token function">join</span><span class="token punctuation">(</span>outputPath<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>versionFileName<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>version
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 生成文件</span>
  <span class="token comment">/** @type {(dest: PathLike, content: string, extraReplacement: obj) =&gt; void} */</span>
  <span class="token function">generateFile</span><span class="token punctuation">(</span>dest <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">,</span> content <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">,</span> extraReplacement <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fs<span class="token punctuation">.</span><span class="token function">outputFileSync</span><span class="token punctuation">(</span>
      dest<span class="token punctuation">,</span>
      <span class="token function">replaceStr</span><span class="token punctuation">(</span>content<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">envKey</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>envKey<span class="token punctuation">,</span>
        <span class="token literal-property property">currentVersion</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>version<span class="token punctuation">,</span>
        <span class="token operator">...</span>extraReplacement
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br></div></div><blockquote><p>该文件主要定义 webpack 插件：</p> <ol><li>定义 <code>UpdatePopup</code> 类;</li> <li>初始化插件选项；</li> <li>暴露 <code>apply</code> 方法提供给 webpack 调用；</li> <li><code>apply</code> 方法中：</li></ol> <ul><li>修改 webpack 入口文件；</li> <li>生成写入版本号的文件到 app；</li> <li>复制文件到 webpack 输出目录；</li></ul></blockquote> <p><strong>main 文件分析</strong></p> <p>主要执行文件位于 <code>./node_modules/@femessage/update-popup/src/main.js</code> 目录下：</p> <p><img src="/myblog/assets/img/update-popup3.43060220.png" alt="image-20240208101356105"></p> <blockquote><p>该文件定义了：</p> <ol><li>一个主要执行函数；</li> <li>版本比较方法：比较当前版本和文件版本；</li> <li>创建定时器方法：定时检测项目版本；</li></ol></blockquote> <p>主要执行方法为 <code>main</code> ：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 主要执行函数</span>
<span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token keyword">return</span>

  <span class="token comment">// 当前应用版本</span>
  <span class="token keyword">const</span> currentVersion <span class="token operator">=</span> <span class="token string">'{{currentVersion}}'</span>
  <span class="token comment">// 上次访问时间 ms</span>
  <span class="token keyword">let</span> lastSeenMS <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token comment">// 一秒 ms</span>
  <span class="token keyword">const</span> OneSecondMS <span class="token operator">=</span> <span class="token number">1000</span>
  <span class="token comment">// dispatch 分发定时器动作</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span>dispatch<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">createInterval</span><span class="token punctuation">(</span>fetchVersion<span class="token punctuation">)</span>

  <span class="token keyword">let</span> popupFlag <span class="token operator">=</span> <span class="token boolean">false</span>
  <span class="token comment">// 检测文件版本</span>
  <span class="token function">checker</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// 监听文档 visibilitychange 事件</span>
  document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'visibilitychange'</span><span class="token punctuation">,</span> checker<span class="token punctuation">)</span>
  <span class="token comment">// 显示弹窗提示</span>
  <span class="token keyword">function</span> <span class="token function">showRefreshPopup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    popupFlag <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token comment">// 停止监听事件</span>
    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'stopInterval'</span><span class="token punctuation">)</span>

    <span class="token comment">// 延后 1 秒显示以使得没有那么唐突</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">createToast</span><span class="token punctuation">(</span><span class="token string">'发现新版本可用'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">action</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">'刷新'</span><span class="token punctuation">,</span>
          <span class="token function-variable function">callback</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// 点击刷新按钮后回调，刷新页面</span>
            window<span class="token punctuation">.</span>location<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> OneSecondMS<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 检测版本</span>
  <span class="token keyword">function</span> <span class="token function">checker</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>popupFlag<span class="token punctuation">)</span> <span class="token keyword">return</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>hidden<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 离开时</span>
      lastSeenMS <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token comment">// 启动定时器，定时检测</span>
      <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'stopInterval'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> currentMS <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

      <span class="token comment">// 防止10秒之内频繁切换</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>currentMS <span class="token operator">-</span> lastSeenMS <span class="token operator">&gt;</span> OneSecondMS <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'immediate'</span><span class="token punctuation">)</span>
        <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'startInterval'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">interval</span><span class="token operator">:</span> OneSecondMS <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 获取文件版本号</span>
  <span class="token keyword">function</span> <span class="token function">fetchVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'{{VERSION_FILE_PATH}}'</span> <span class="token operator">+</span> <span class="token string">'?_='</span> <span class="token operator">+</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> res<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">version</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">compareVersion</span><span class="token punctuation">(</span><span class="token punctuation">(</span>version <span class="token operator">||</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> currentVersion<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>popupFlag<span class="token punctuation">)</span> <span class="token keyword">return</span>
          <span class="token function">showRefreshPopup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br></div></div><blockquote><p>该方法逻辑如下：</p> <ol><li>启动定时器检测文件版本；
<ul><li>定时获取文件版本号；</li> <li>比较文件版本和内存版本号；</li> <li>不一致时，使用 <code>vercel-toast</code> 插件提示更新；</li></ul></li> <li>点击更新按钮，<code>window.location.reload()</code> 方法刷新页面。</li></ol></blockquote> <h2 id="参考资料"><a href="#参考资料" class="header-anchor">#</a> 参考资料</h2> <p><a href="https://juejin.cn/post/7050363329142849543" target="_blank" rel="noopener noreferrer">浏览器缓存带来的前端项目更新问题及解决方法 - 掘金 (juejin.cn)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <!----> <div class="content__content-bottom"></div> <footer class="page-meta"><!----> <div class="meta-item update-time"><span class="label">Last update:</span> <span class="info">February 19, 2024 09:22</span></div> <div class="meta-item contributors"><span class="label">Contributors: </span> <span class="info"><span title="email: 596777598@qq.com" class="contributor">
          sewar
        </span> <!----></span></div></footer> <!----> <!----> <!----> <div class="content__page-bottom"></div></main> <!----></div><div class="global-ui"><!----><div id="pwa-install"><!----> <div id="install-modal-wrapper" style="display:none;"><div class="background"></div> <div class="install-modal"><div class="header"><button aria-label="Close" class="close-button"><svg width="23" height="22" xmlns="http://www.w3.org/2000/svg" class="icon close-icon"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.12.358a1.224 1.224 0 011.729 0l8.92 8.914L20.686.358a1.224 1.224 0 011.73 1.728L13.497 11l8.92 8.913a1.222 1.222 0 11-1.73 1.729l-8.919-8.913-8.92 8.913a1.224 1.224 0 01-1.729-1.729L10.04 11l-8.92-8.914a1.222 1.222 0 010-1.728z" fill="currentColor"></path></svg></button> <div class="logo"><!----> <div class="title"><h1></h1> <p class="desc">This app can be installed on your PC or mobile device.  This will allow this web app to look and behave like any other installed app.  You will find it in your app lists and be able to pin it to your home screen, start menus or task bars.  This installed web app will also be able to safely interact with other apps and your operating system. </p></div></div></div> <div class="content"><div class="highlight"><!----> <!----></div> <div class="description"><h3>Description</h3> <p></p></div></div> <div class="button-wrapper"><button class="install-button">
        Install <span></span></button> <button class="cancel-button">
        Cancel
      </button></div></div></div></div><!----><div tabindex="-1" role="dialog" aria-hidden="true" class="pswp"><div class="pswp__bg"></div> <div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div> <div class="pswp__item"></div> <div class="pswp__item"></div></div> <div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div> <button title="Close" aria-label="Close" class="pswp__button pswp__button--close"></button> <button title="Share" aria-label="Share" class="pswp__button pswp__button--share"></button> <button title="Switch to full screen" aria-label="Switch to full screen" class="pswp__button pswp__button--fs"></button> <button title="Zoom in/out" aria-label="Zoom in/out" class="pswp__button pswp__button--zoom"></button> <div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div> <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div> <button title="Prev (Arrow Left)" aria-label="Prev (Arrow Left)" class="pswp__button pswp__button--arrow--left"></button> <button title="Next (Arrow Right)" aria-label="Next (Arrow Right)" class="pswp__button pswp__button--arrow--right"></button> <div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div></div></div>
    <script src="/myblog/assets/js/app.9d2b617a.js" defer></script><script src="/myblog/assets/js/layout-Layout.d2d4ce64.js" defer></script><script src="/myblog/assets/js/page-前端发版静态资源404问题.9eb1ca89.js" defer></script><script src="/myblog/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound~layout-components/Blog/BlogHome~layout-components/~2222f443.5835591a.js" defer></script>
  </body>
</html>
