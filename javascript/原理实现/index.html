<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JS原理实现 | Sewen 博客</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="./mylogo.png">
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
    <link rel="manifest" href="/myblog/manifest.webmanifest" crossorigin="use-credentials">
    <link rel="alternate" type="application/atom+xml" href="https://sewar-x.github.io/myblog/atom.xml" title="Sewen 博客 Atom Feed">
    <link rel="alternate" type="application/json" href="https://sewar-x.github.io/myblog/rss.xml" title="Sewen 博客 JSON Feed">
    <link rel="alternate" type="application/rss+xml" href="https://sewar-x.github.io/myblog/rss.xml" title="Sewen 博客 RSS Feed">
    <meta name="description" content="sewen 的前端学习笔记、博客、前端基础总结、技术深度剖析、面试题总结、算法总结、项目过程总结">
    <meta property="og:url" content="https://sewar-x.github.io/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0.html">
    <meta property="og:site_name" content="Sewen 博客">
    <meta property="og:title" content="JS原理实现">
    <meta property="og:type" content="article">
    <meta property="og:locale" content="en-US">
    <meta name="theme-color" content="#46bd87">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <link rel="preload" href="/myblog/assets/css/0.styles.645fbc6f.css" as="style"><link rel="preload" href="/myblog/assets/js/app.9d2b617a.js" as="script"><link rel="preload" href="/myblog/assets/js/layout-Layout.d2d4ce64.js" as="script"><link rel="preload" href="/myblog/assets/js/page-JS原理实现.3c427e19.js" as="script"><link rel="preload" href="/myblog/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound~layout-components/Blog/BlogHome~layout-components/~2222f443.5835591a.js" as="script"><link rel="prefetch" href="/myblog/assets/js/199.a9216960.js"><link rel="prefetch" href="/myblog/assets/js/200.4c66fc79.js"><link rel="prefetch" href="/myblog/assets/js/layout-Blog.1fca7e90.js"><link rel="prefetch" href="/myblog/assets/js/layout-NotFound.3c74e8aa.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/AlgoliaSearch/Dropdown.70fcebe7.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Anchor.3235541c.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/ArticleInfo.7b815b20.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/ArticleItem.b0e177e1.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/ArticleList.d1cf1b24.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/ArticleType.b630b80e.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/BlogHero.621312ba.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/BlogHome.4fe44489.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/BlogInfo.b2a94760.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/BlogPage.e0fbe820.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/BloggerInfo.0df38355.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/CategoryList.ec1bcd96.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/ProjectList.8550a110.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/TagList.bcf7b782.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/Timeline.b6cf5471.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/TimelineList.3c6e08a6.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Clipboard.e940a903.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Common.820a8694.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Home.70383986.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/MyTransition.0de46069.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Navbar/DropdownLink.e3f6c118.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Navbar/NavLink.93b11770.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Navbar/NavLinks.8ba214e6.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Navbar/Navbar.b90a94f9.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Navbar/RepoLink.663a7f55.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Navbar/SidebarButton.76b0035a.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Page.98b5d09c.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/PageFooter.20bc9bd8.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/PageMeta.b7e6b12f.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/PageNav.8305dd1f.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Password.45e0e82a.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Sidebar/DropdownTransition.068c5eea.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Sidebar/Sidebar.f6f90d52.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Sidebar/SidebarDropdownLink.505127a8.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Sidebar/SidebarGroup.7eecf370.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Sidebar/SidebarLink.6e39fe32.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Sidebar/SidebarNavLinks.0f8566cb.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Theme/DarkmodeSwitch.20ac7b92.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Theme/ThemeColor.6086e4ed.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Theme/ThemeOptions.483238c9.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/ArticleIcon.0a22e2b1.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/AutoIcon.2ff1c790.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/BookIcon.419b49ba.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/DarkIcon.7d81873b.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/EditIcon.8ada485d.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/EmptyIcon.d704a5cf.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/I18nIcon.ffad8b3e.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/LightIcon.47d807da.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/LinkIcon.1a8a7826.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/LockIcon.a29a2b79.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/NextIcon.0214ee59.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/Page404Icon.8bc1ebbb.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/PresentationIcon.17500d9b.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/PrevIcon.2ae04a70.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/ProjectIcon.b336d567.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/StickyIcon.0f509b9d.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Baidu.244b9a41.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Bitbucket.11ba94e1.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Dingding.e8a3d90d.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Discord.3295a55b.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Dribbble.464dac3b.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Email.f9254caa.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Evernote.991472fb.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Facebook.08e78e47.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Flipboard.a1124d0f.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Gitee.c44bc20a.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Github.5667e5ae.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Gitlab.ad95c7a7.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Gmail.b5acc6bc.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Instagram.56be85f2.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Lines.d9db3dce.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Linkedin.b82d8d8b.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Pinterest.0f3ffe71.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Pocket.41ef3c92.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/QQ.7558f4ba.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Qzone.bf658fae.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Reddit.9c4c95ee.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Rss.9780139e.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Steam.06abbae2.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Twitter.26fa5bda.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Wechat.9cac8c4c.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Weibo.5206a632.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Whatsapp.0738f1e3.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Youtube.f41fd7f2.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Zhihu.4d851d2f.js"><link rel="prefetch" href="/myblog/assets/js/page--0abc50bf.0d6f1484.js"><link rel="prefetch" href="/myblog/assets/js/page--1cd40f4c.dd76c7b3.js"><link rel="prefetch" href="/myblog/assets/js/page--53f93199.e80bdec8.js"><link rel="prefetch" href="/myblog/assets/js/page--5afd2fd0.adea4e92.js"><link rel="prefetch" href="/myblog/assets/js/page--67c584d3.0a3f3cd9.js"><link rel="prefetch" href="/myblog/assets/js/page--776a8506.cdf48aac.js"><link rel="prefetch" href="/myblog/assets/js/page-CSS.eb94b29f.js"><link rel="prefetch" href="/myblog/assets/js/page-Chrome开发工具使用指南.a2675120.js"><link rel="prefetch" href="/myblog/assets/js/page-DevServer.0281863d.js"><link rel="prefetch" href="/myblog/assets/js/page-Echarts二次封装.4387b8ad.js"><link rel="prefetch" href="/myblog/assets/js/page-Elementui与Element-plusui二次封装.82f12a09.js"><link rel="prefetch" href="/myblog/assets/js/page-Git基础.03c616ad.js"><link rel="prefetch" href="/myblog/assets/js/page-Git规范.e2fdc38a.js"><link rel="prefetch" href="/myblog/assets/js/page-HTML.1e3c14b9.js"><link rel="prefetch" href="/myblog/assets/js/page-Home.f0b7e772.js"><link rel="prefetch" href="/myblog/assets/js/page-JSON配置化组件二次封装.12060fd9.js"><link rel="prefetch" href="/myblog/assets/js/page-JS应用题.3d313b34.js"><link rel="prefetch" href="/myblog/assets/js/page-JavaScript基础.551be887.js"><link rel="prefetch" href="/myblog/assets/js/page-Linux.c6159ebd.js"><link rel="prefetch" href="/myblog/assets/js/page-Loader和Plugin原理.b2971b76.js"><link rel="prefetch" href="/myblog/assets/js/page-MySQL.0b1d704a.js"><link rel="prefetch" href="/myblog/assets/js/page-NPM.a55851b2.js"><link rel="prefetch" href="/myblog/assets/js/page-Node.ec405a21.js"><link rel="prefetch" href="/myblog/assets/js/page-Nodejs常见问题集合.12844e69.js"><link rel="prefetch" href="/myblog/assets/js/page-Node性能优化.b4ea1c34.js"><link rel="prefetch" href="/myblog/assets/js/page-Promise专题.7869a31b.js"><link rel="prefetch" href="/myblog/assets/js/page-React.d76cf0ac.js"><link rel="prefetch" href="/myblog/assets/js/page-SSG移动端项目实践.2122615b.js"><link rel="prefetch" href="/myblog/assets/js/page-TypeScript.4f597fda.js"><link rel="prefetch" href="/myblog/assets/js/page-Vite.637881bf.js"><link rel="prefetch" href="/myblog/assets/js/page-Vite原理解析.6677fdb4.js"><link rel="prefetch" href="/myblog/assets/js/page-Vue25项目webpack构建分析.7bbea0fa.js"><link rel="prefetch" href="/myblog/assets/js/page-Vue2VsVue3.10be4140.js"><link rel="prefetch" href="/myblog/assets/js/page-Vue2x原理源码分析.e9e753b6.js"><link rel="prefetch" href="/myblog/assets/js/page-Vue3基础.210247ff.js"><link rel="prefetch" href="/myblog/assets/js/page-Vue3源码分析.17379e04.js"><link rel="prefetch" href="/myblog/assets/js/page-VueCli源码分析.afc3c83f.js"><link rel="prefetch" href="/myblog/assets/js/page-VueRouter原理分析.0a092eb6.js"><link rel="prefetch" href="/myblog/assets/js/page-VueSSR原理分析.63006040.js"><link rel="prefetch" href="/myblog/assets/js/page-VueVsReact.2156be28.js"><link rel="prefetch" href="/myblog/assets/js/page-Vuex原理分析.5ba3e6e4.js"><link rel="prefetch" href="/myblog/assets/js/page-WEB安全.5aa0eeef.js"><link rel="prefetch" href="/myblog/assets/js/page-WebPack构建原理.9c29703e.js"><link rel="prefetch" href="/myblog/assets/js/page-webpackAPI分析.4c8b152b.js"><link rel="prefetch" href="/myblog/assets/js/page-webpack优化.dcc6c3bc.js"><link rel="prefetch" href="/myblog/assets/js/page-webpack基础.3820ee6c.js"><link rel="prefetch" href="/myblog/assets/js/page-webpack项目实践.77e22417.js"><link rel="prefetch" href="/myblog/assets/js/page-一次后台管理系统的性能优化.7c2d8712.js"><link rel="prefetch" href="/myblog/assets/js/page-从零到一搭建SSR项目.855376fc.js"><link rel="prefetch" href="/myblog/assets/js/page-从零到一搭建Vue2项目和规范设计.93017fd2.js"><link rel="prefetch" href="/myblog/assets/js/page-从零到一搭建Vue3单页面应用.de152d54.js"><link rel="prefetch" href="/myblog/assets/js/page-从零到一搭建公共组件库.93278073.js"><link rel="prefetch" href="/myblog/assets/js/page-从零到一搭建移动端SSG项目.9c113d06.js"><link rel="prefetch" href="/myblog/assets/js/page-使用docker部署Node服务.5cf328fd.js"><link rel="prefetch" href="/myblog/assets/js/page-分治.e3dfc22d.js"><link rel="prefetch" href="/myblog/assets/js/page-前端发版静态资源404问题.9eb1ca89.js"><link rel="prefetch" href="/myblog/assets/js/page-前端存储.cd82cf54.js"><link rel="prefetch" href="/myblog/assets/js/page-前端工程化.1e6e58d0.js"><link rel="prefetch" href="/myblog/assets/js/page-前端性能优化方案.83718d22.js"><link rel="prefetch" href="/myblog/assets/js/page-前端架构实践.171dbc0f.js"><link rel="prefetch" href="/myblog/assets/js/page-前端渲染架构.3b783de8.js"><link rel="prefetch" href="/myblog/assets/js/page-前端自动部署.5076846c.js"><link rel="prefetch" href="/myblog/assets/js/page-前端部署原理.82ecd8a7.js"><link rel="prefetch" href="/myblog/assets/js/page-动态规划.a3af92f1.js"><link rel="prefetch" href="/myblog/assets/js/page-哈希表.c76000e8.js"><link rel="prefetch" href="/myblog/assets/js/page-回溯算法.cd914c32.js"><link rel="prefetch" href="/myblog/assets/js/page-图.dfd9828a.js"><link rel="prefetch" href="/myblog/assets/js/page-基础.7bf5a37b.js"><link rel="prefetch" href="/myblog/assets/js/page-堆.4657e538.js"><link rel="prefetch" href="/myblog/assets/js/page-字符串.252f2a08.js"><link rel="prefetch" href="/myblog/assets/js/page-异步编程.904f4c65.js"><link rel="prefetch" href="/myblog/assets/js/page-性能优化指标和监控.f2175836.js"><link rel="prefetch" href="/myblog/assets/js/page-排序算法.c7a51b99.js"><link rel="prefetch" href="/myblog/assets/js/page-搭建低代码平台.19eaf5ec.js"><link rel="prefetch" href="/myblog/assets/js/page-操作系统.473c4281.js"><link rel="prefetch" href="/myblog/assets/js/page-数学运算.c82748fb.js"><link rel="prefetch" href="/myblog/assets/js/page-数据结构算法.84480586.js"><link rel="prefetch" href="/myblog/assets/js/page-数组.692b0d0a.js"><link rel="prefetch" href="/myblog/assets/js/page-权限管理.c7e10db0.js"><link rel="prefetch" href="/myblog/assets/js/page-查找.790e52df.js"><link rel="prefetch" href="/myblog/assets/js/page-栈和队列.8dbc3586.js"><link rel="prefetch" href="/myblog/assets/js/page-树.24efdeaa.js"><link rel="prefetch" href="/myblog/assets/js/page-浏览器.bee9ec04.js"><link rel="prefetch" href="/myblog/assets/js/page-混合桌面应用开发.9e10d1c3.js"><link rel="prefetch" href="/myblog/assets/js/page-登录.bb830451.js"><link rel="prefetch" href="/myblog/assets/js/page-目录.c85b4d0b.js"><link rel="prefetch" href="/myblog/assets/js/page-移动端开发.56ac22ec.js"><link rel="prefetch" href="/myblog/assets/js/page-组件和组件封装.b5e86da2.js"><link rel="prefetch" href="/myblog/assets/js/page-计算机网络基础.0a106662.js"><link rel="prefetch" href="/myblog/assets/js/page-设计模式.ffdc7cfd.js"><link rel="prefetch" href="/myblog/assets/js/page-调试技巧.485ae36e.js"><link rel="prefetch" href="/myblog/assets/js/page-贪心算法.0f417640.js"><link rel="prefetch" href="/myblog/assets/js/page-输入url到页面展示全过程.510aef2e.js"><link rel="prefetch" href="/myblog/assets/js/page-递归.5e55e552.js"><link rel="prefetch" href="/myblog/assets/js/page-链表.1cf6927f.js"><link rel="prefetch" href="/myblog/assets/js/page-项目总结.ffcd2a4b.js"><link rel="prefetch" href="/myblog/assets/js/vendors~docsearch.f3877d0d.js"><link rel="prefetch" href="/myblog/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound~layout-components/Blog/BlogHome~layout-components/~5d377965.d9712593.js"><link rel="prefetch" href="/myblog/assets/js/vendors~layout-Blog~layout-Layout~layout-components/Blog/ArticleItem~layout-components/Blog/ArticleL~b56f3aac.47bb5cb5.js"><link rel="prefetch" href="/myblog/assets/js/vendors~layout-NotFound~layout-components/Common~layout-components/Page.57d58db9.js"><link rel="prefetch" href="/myblog/assets/js/vendors~layout-Slide.81546b3b.js"><link rel="prefetch" href="/myblog/assets/js/vendors~layout-components/AlgoliaSearch/Full.b30f067a.js"><link rel="prefetch" href="/myblog/assets/js/vendors~layout-components/Blog/BlogPage.bcccbd38.js"><link rel="prefetch" href="/myblog/assets/js/vendors~layout-components/Navbar/Navbar.e2a7361e.js"><link rel="prefetch" href="/myblog/assets/js/vendors~layout-components/Page.6c65077c.js"><link rel="prefetch" href="/myblog/assets/js/vendors~layout-components/Sidebar/Sidebar.34cd9cf7.js"><link rel="prefetch" href="/myblog/assets/js/vendors~photo-swipe.428df1da.js">
    <link rel="stylesheet" href="/myblog/assets/css/0.styles.645fbc6f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container has-navbar has-sidebar has-anchor"><header class="navbar"><!----> <div class="content__navbar-start"></div> <button title="Sidebar Button" class="sidebar-button"><span class="icon"></span></button> <a href="/myblog/" class="home-link router-link-active"><img src="./mylogo.png" alt="Sewen 博客" class="logo"> <!----> <span class="site-name can-hide">Sewen 博客</span></a> <!----> <div class="content__navbar-center"></div> <div class="links"><button tabindex="-1" aria-hidden="true" class="color-button"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="skin-icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4
        38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32
        51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0
        102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2
        6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4
        0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2
        9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224
        419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4
        470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0
        22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6
        12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128
        505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2
        16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8
        86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4
        80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6
        6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg> <div class="color-picker-menu" style="display:none;"><div class="theme-options"><ul class="themecolor-select"><label for="themecolor-select">Theme Color:</label> <li><span class="default-theme"></span></li> </ul> <div class="darkmode-toggle"><label for="darkmode-toggle" class="desc">Theme Mode:</label> <div class="darkmode-switch"><div class="item day"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon light-icon"><path d="M512 256a42.667 42.667 0 0 0 42.667-42.667V128a42.667 42.667 0 0 0-85.334 0v85.333A42.667 42.667 0 0 0 512 256zm384 213.333h-85.333a42.667 42.667 0 0 0 0 85.334H896a42.667 42.667 0 0 0 0-85.334zM256 512a42.667 42.667 0 0 0-42.667-42.667H128a42.667 42.667 0 0 0 0 85.334h85.333A42.667 42.667 0 0 0 256 512zm9.387-298.667a42.667 42.667 0 0 0-59.307 62.72l61.44 59.307a42.667 42.667 0 0 0 31.147 11.947 42.667 42.667 0 0 0 30.72-13.227 42.667 42.667 0 0 0 0-60.16zm459.946 133.974a42.667 42.667 0 0 0 29.44-11.947l61.44-59.307a42.667 42.667 0 0 0-57.6-62.72l-61.44 60.587a42.667 42.667 0 0 0 0 60.16 42.667 42.667 0 0 0 28.16 13.227zM512 768a42.667 42.667 0 0 0-42.667 42.667V896a42.667 42.667 0 0 0 85.334 0v-85.333A42.667 42.667 0 0 0 512 768zm244.48-79.36a42.667 42.667 0 0 0-59.307 61.44l61.44 60.587a42.667 42.667 0 0 0 29.44 11.946 42.667 42.667 0 0 0 30.72-12.8 42.667 42.667 0 0 0 0-60.586zm-488.96 0-61.44 59.307a42.667 42.667 0 0 0 0 60.586 42.667 42.667 0 0 0 30.72 12.8 42.667 42.667 0 0 0 28.587-10.666l61.44-59.307a42.667 42.667 0 0 0-59.307-61.44zM512 341.333A170.667 170.667 0 1 0 682.667 512 170.667 170.667 0 0 0 512 341.333z" fill="currentColor"></path></svg></div> <div class="item auto active"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon auto-icon"><path d="M460.864 539.072H564.8L510.592 376l-49.728 163.072zM872 362.368V149.504H659.648L510.528 0l-149.12 149.504H149.12v212.928L0 511.872l149.12 149.504v212.928h212.352l149.12 149.504 149.12-149.504h212.352V661.376l149.12-149.504L872 362.368zM614.464 693.12l-31.616-90.624H438.272l-31.616 90.624h-85.888l144.576-407.68h90.368l144.576 407.68h-85.824zm0 0" fill="currentColor"></path></svg></div> <div class="item night"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon dark-icon"><path d="M935.539 630.402c-11.43-11.432-28.674-14.739-43.531-8.354-46.734 20.103-96.363 30.297-147.508 30.297-99.59 0-193.221-38.784-263.64-109.203-108.637-108.637-139.61-270.022-78.908-411.148a39.497 39.497 0 0 0-51.886-51.887c-52.637 22.64-100.017 54.81-140.826 95.616-85.346 85.346-132.346 198.821-132.346 319.52 0 120.7 47.001 234.172 132.347 319.519S408.063 947.11 528.76 947.11c120.7 0 234.172-47.003 319.52-132.351 40.809-40.81 72.978-88.19 95.616-140.826a39.497 39.497 0 0 0-8.356-43.532z" fill="currentColor"></path></svg></div></div> <!----></div></div></div></button> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/myblog/" class="nav-link router-link-active"><!---->
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Front-end Basics" class="dropdown-title"><span class="title"><!---->
        前端基础
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/myblog/javascript/html/" class="nav-link"><!---->
  HTML
</a></li><li class="dropdown-item"><a href="/myblog/javascript/css/" class="nav-link"><!---->
  Css
</a></li><li class="dropdown-item"><a href="/myblog/javascript/javascript/" class="nav-link"><!---->
  JavaScript
</a></li><li class="dropdown-item"><a href="/myblog/javascript/typescript/" class="nav-link"><!---->
  TypeScript
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title"><!---->
        计算机基础
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/myblog/javascript/algorithms/" class="nav-link"><!---->
  数据结构和算法
</a></li><li class="dropdown-item"><a href="/myblog/javascript/network/" class="nav-link"><!---->
  计算机网络/HTTP
</a></li><li class="dropdown-item"><a href="/myblog/javascript/network/输入url到页面展示全过程/" class="nav-link"><!---->
  输入url到页面展示全过程
</a></li><li class="dropdown-item"><a href="/myblog/javascript/operating-system/" class="nav-link"><!---->
  操作系统
</a></li><li class="dropdown-item"><a href="/myblog/javascript/design-model/" class="nav-link"><!---->
  设计模式
</a></li><li class="dropdown-item"><a href="/myblog/javascript/Web-Security/" class="nav-link"><!---->
  Web安全
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架和源码分析" class="dropdown-title"><span class="title"><!---->
        框架和源码分析
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/myblog/javascript/vue/Vue2原理和源码分析.html" class="nav-link"><!---->
  Vue 专题
</a></li><li class="dropdown-item"><a href="/myblog/javascript/React/" class="nav-link"><!---->
  React 专题
</a></li><li class="dropdown-item"><a href="/myblog/javascript/webpack/webpack构建原理.html" class="nav-link"><!---->
  webpack 专题
</a></li><li class="dropdown-item"><a href="/myblog/javascript/vite/" class="nav-link"><!---->
  vite 专题
</a></li><li class="dropdown-item"><a href="/myblog/javascript/axios/" class="nav-link"><!---->
  Axios 专题
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="浏览器" class="dropdown-title"><span class="title"><!---->
        浏览器
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/myblog/javascript/browser/浏览器原理/" class="nav-link"><!---->
  浏览器原理
</a></li><li class="dropdown-item"><a href="/myblog/javascript/browser/前端缓存和存储/" class="nav-link"><!---->
  前端缓存和存储
</a></li><li class="dropdown-item"><a href="/myblog/javascript/performance/前端调试技巧/" class="nav-link"><!---->
  前端调试技巧
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="node.js" class="dropdown-title"><span class="title"><!---->
        服务器
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/myblog/javascript/node/" class="nav-link"><!---->
  Node.js
</a></li><li class="dropdown-item"><a href="/myblog/javascript/linux/" class="nav-link"><!---->
  Linux
</a></li><li class="dropdown-item"><a href="/myblog/javascript/mysql/" class="nav-link"><!---->
  MySQL
</a></li><li class="dropdown-item"><a href="/myblog/javascript/nginx/" class="nav-link"><!---->
  Nginx
</a></li><li class="dropdown-item"><a href="/myblog/javascript/docker/" class="nav-link"><!---->
  Docker
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="浏览器和性能优化" class="dropdown-title"><span class="title"><!---->
        性能优化
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/myblog/javascript/performance/性能优化指标和监控/" class="nav-link"><!---->
  性能优化指标和监控
</a></li><li class="dropdown-item"><a href="/myblog/javascript/performance/前端性能优化方案/" class="nav-link"><!---->
  前端性能优化方案
</a></li><li class="dropdown-item"><a href="/myblog/javascript/performance/一次管理后台的渲染优化/" class="nav-link"><!---->
  一次管理后台的渲染优化
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端工程" class="dropdown-title"><span class="title"><!---->
        前端工程
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/myblog/javascript/Front-end-Engineering/前端工程化/" class="nav-link"><!---->
  前端工程化
</a></li><li class="dropdown-item"><a href="/myblog/javascript/Front-end-Engineering/前端渲染架构/" class="nav-link"><!---->
  前端渲染架构
</a></li><li class="dropdown-item"><a href="/myblog/javascript/Front-end-Engineering/前端架构实践/" class="nav-link"><!---->
  前端架构实践
</a></li><li class="dropdown-item"><a href="/myblog/javascript/Front-end-Engineering/npm/" class="nav-link"><!---->
  npm
</a></li><li class="dropdown-item"><a href="/myblog/javascript/git/" class="nav-link"><!---->
  Git
</a></li><li class="dropdown-item"><a href="/myblog/javascript/projectDeploy/自动构建和部署/" class="nav-link"><!---->
  自动构建和部署
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目实践" class="dropdown-title"><span class="title"><!---->
        项目实践
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/myblog/javascript/projectDeploy/" class="nav-link"><!---->
  前端部署
</a></li><li class="dropdown-item"><a href="/myblog/javascript/componentsEncapsulation/组件和组件封装实践.html" class="nav-link"><!---->
  组件和组件封装实践
</a></li><li class="dropdown-item"><a href="/myblog/javascript/projectsSummary/登录与单点登录/" class="nav-link"><!---->
  登录与单点登录
</a></li><li class="dropdown-item"><a href="/myblog/javascript/projectsSummary/权限管理方案实践/" class="nav-link"><!---->
  权限管理方案实践
</a></li><li class="dropdown-item"><a href="/myblog/javascript/projectsSummary/Echarts二次封装实践/" class="nav-link"><!---->
  Echarts二次封装实践
</a></li><li class="dropdown-item"><a href="/myblog/javascript/projectsSummary/文档在线预览和编辑方案/" class="nav-link"><!---->
  文档在线预览和编辑方案
</a></li><li class="dropdown-item"><a href="/myblog/javascript/projectsSummary/移动端开发实践/" class="nav-link"><!---->
  移动端开发实践
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目搭建到原理分析" class="dropdown-title"><span class="title"><!---->
        项目搭建
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/myblog/javascript/projectsSummary/从零到一搭建SSR项目/" class="nav-link"><!---->
  从零到一搭建SSR项目
</a></li><li class="dropdown-item"><a href="/myblog/javascript/projectsSummary/从零到一搭建移动端SSG项目/" class="nav-link"><!---->
  从零到一搭建移动端SSG项目
</a></li><li class="dropdown-item"><a href="/myblog/javascript/projectsSummary/移动端SSG项目实践/" class="nav-link"><!---->
  移动端SSG项目实践
</a></li><li class="dropdown-item"><a href="/myblog/javascript/projectsSummary/从零到一搭建Vue2工程化项目/" class="nav-link"><!---->
  从零到一搭建Vue2工程化项目
</a></li><li class="dropdown-item"><a href="/myblog/javascript/projectsSummary/从零到一搭建Vue3工程化项目/" class="nav-link"><!---->
  从零到一搭建Vue3工程化项目
</a></li><li class="dropdown-item"><a href="/myblog/javascript/projectsSummary/搭建低代码平台/" class="nav-link"><!---->
  搭建低代码平台
</a></li><li class="dropdown-item"><a href="/myblog/javascript/projectsSummary/混合桌面应用开发实践/" class="nav-link"><!---->
  混合桌面应用开发实践
</a></li></ul></div></div></nav> <!----> <!----> <!----> <div class="content__navbar-end"></div></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><div vocab="https://schema.org/" typeof="Person" class="blogger-info mobile"><div data-balloon-pos="down" role="navigation" class="blogger hasIntro"><img property="image" alt="Blogger Avatar" src="./mylogo.png" class="avatar round"> <div property="name" class="name">Sewen 博客</div> <meta property="url" content="../outline.md"></div> <div class="num-wrapper"><div><div class="num">91</div> <div>Articles</div></div> <div><div class="num">0</div> <div>Category</div></div> <div><div class="num">0</div> <div>Tags</div></div> <div><div class="num">91</div> <div>Timeline</div></div></div> <div class="media-links-wrapper"><a href="https://github.com/Sewar-x/myblog" rel="noopener noreferrer" target="_blank" aria-label="Github" data-balloon-pos="up" class="media-link"><span class="sr-only">Github</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-github"><circle cx="512" cy="512" r="512" fill="#171515"></circle> <path d="M509.423 146.442c-200.317 0-362.756 162.42-362.756 362.8 0 160.266 103.936 296.24 248.109 344.217 18.139 3.327 24.76-7.872 24.76-17.486 0-8.613-.313-31.427-.49-61.702-100.912 21.923-122.205-48.63-122.205-48.63-16.495-41.91-40.28-53.067-40.28-53.067-32.937-22.51 2.492-22.053 2.492-22.053 36.407 2.566 55.568 37.386 55.568 37.386 32.362 55.438 84.907 39.43 105.58 30.143 3.296-23.444 12.667-39.43 23.032-48.498-80.557-9.156-165.246-40.28-165.246-179.297 0-39.604 14.135-71.988 37.342-97.348-3.731-9.178-16.18-46.063 3.556-96.009 0 0 30.46-9.754 99.76 37.19 28.937-8.048 59.97-12.071 90.823-12.211 30.807.14 61.843 4.165 90.822 12.21 69.26-46.944 99.663-37.189 99.663-37.189 19.792 49.946 7.34 86.831 3.61 96.01 23.25 25.359 37.29 57.742 37.29 97.347 0 139.366-84.82 170.033-165.637 179.013 13.026 11.2 24.628 33.342 24.628 67.182 0 48.498-.445 87.627-.445 99.521 0 9.702 6.535 20.988 24.945 17.444 144.03-48.067 247.881-183.95 247.881-344.175 0-200.378-162.442-362.798-362.802-362.798z" fill="#FFF"></path></svg></a><a href="1567910907" rel="noopener noreferrer" target="_blank" aria-label="Wechat" data-balloon-pos="up" class="media-link"><span class="sr-only">Wechat</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-wechat"><circle cx="512" cy="512" r="512" fill="#1AC88E"></circle> <path d="M827.551 578.742a176.583 176.583 0 0 0-185.685-158.379 172.942 172.942 0 0 0-186.3 158.379 172.942 172.942 0 0 0 185.686 158.379 282.169 282.169 0 0 0 65.536-10.923l60.689 32.768-16.384-54.613a166.275 166.275 0 0 0 76.458-125.611zm-245.76-27.307a21.845 21.845 0 1 1 0-43.69 24.872 24.872 0 0 1 27.307 21.845 24.872 24.872 0 0 1-27.921 21.845h.614zm121.356 0a21.845 21.845 0 1 1 0-43.69 24.872 24.872 0 0 1 27.306 21.845 24.872 24.872 0 0 1-28.512 21.845h1.206z" fill="#FFF"></path> <path d="M623.662 400.953h21.23A222.709 222.709 0 0 0 419.772 245.6a208.145 208.145 0 0 0-223.323 189.94 182.044 182.044 0 0 0 89.201 150.483l-22.436 67.356 78.279-39.435a389.575 389.575 0 0 0 78.279 10.923h20.616a163.226 163.226 0 0 1-6.667-46.718 182.044 182.044 0 0 1 189.94-177.197zm-121.379-60.69a27.921 27.921 0 1 1 0 55.843 31.562 31.562 0 0 1-33.36-27.921 31.562 31.562 0 0 1 34.59-27.921h-1.23zM346.34 396.107a31.562 31.562 0 0 1-33.383-27.921 31.562 31.562 0 0 1 33.383-27.921 27.921 27.921 0 1 1 0 55.842z" fill="#FFF"></path></svg></a></div></div> <hr> <!----> <div class="content__sidebar-top"></div> <nav class="sidebar-nav-links"><div class="nav-item"><a href="/myblog/" class="nav-link router-link-active"><!---->
  首页
</a></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="Front-end Basics" class="dropdown-title"><span class="title"><!---->
      前端基础
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/javascript/html/" class="nav-link"><!---->
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/css/" class="nav-link"><!---->
  Css
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/javascript/" class="nav-link"><!---->
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/typescript/" class="nav-link"><!---->
  TypeScript
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title"><!---->
      计算机基础
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/javascript/algorithms/" class="nav-link"><!---->
  数据结构和算法
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/network/" class="nav-link"><!---->
  计算机网络/HTTP
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/network/输入url到页面展示全过程/" class="nav-link"><!---->
  输入url到页面展示全过程
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/operating-system/" class="nav-link"><!---->
  操作系统
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/design-model/" class="nav-link"><!---->
  设计模式
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/Web-Security/" class="nav-link"><!---->
  Web安全
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="框架和源码分析" class="dropdown-title"><span class="title"><!---->
      框架和源码分析
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/javascript/vue/Vue2原理和源码分析.html" class="nav-link"><!---->
  Vue 专题
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/React/" class="nav-link"><!---->
  React 专题
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/webpack/webpack构建原理.html" class="nav-link"><!---->
  webpack 专题
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/vite/" class="nav-link"><!---->
  vite 专题
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/axios/" class="nav-link"><!---->
  Axios 专题
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="浏览器" class="dropdown-title"><span class="title"><!---->
      浏览器
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/javascript/browser/浏览器原理/" class="nav-link"><!---->
  浏览器原理
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/browser/前端缓存和存储/" class="nav-link"><!---->
  前端缓存和存储
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/performance/前端调试技巧/" class="nav-link"><!---->
  前端调试技巧
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="node.js" class="dropdown-title"><span class="title"><!---->
      服务器
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/javascript/node/" class="nav-link"><!---->
  Node.js
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/linux/" class="nav-link"><!---->
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/mysql/" class="nav-link"><!---->
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/nginx/" class="nav-link"><!---->
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/docker/" class="nav-link"><!---->
  Docker
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="浏览器和性能优化" class="dropdown-title"><span class="title"><!---->
      性能优化
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/javascript/performance/性能优化指标和监控/" class="nav-link"><!---->
  性能优化指标和监控
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/performance/前端性能优化方案/" class="nav-link"><!---->
  前端性能优化方案
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/performance/一次管理后台的渲染优化/" class="nav-link"><!---->
  一次管理后台的渲染优化
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="前端工程" class="dropdown-title"><span class="title"><!---->
      前端工程
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/javascript/Front-end-Engineering/前端工程化/" class="nav-link"><!---->
  前端工程化
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/Front-end-Engineering/前端渲染架构/" class="nav-link"><!---->
  前端渲染架构
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/Front-end-Engineering/前端架构实践/" class="nav-link"><!---->
  前端架构实践
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/Front-end-Engineering/npm/" class="nav-link"><!---->
  npm
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/git/" class="nav-link"><!---->
  Git
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/projectDeploy/自动构建和部署/" class="nav-link"><!---->
  自动构建和部署
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="项目实践" class="dropdown-title"><span class="title"><!---->
      项目实践
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/javascript/projectDeploy/" class="nav-link"><!---->
  前端部署
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/componentsEncapsulation/组件和组件封装实践.html" class="nav-link"><!---->
  组件和组件封装实践
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/projectsSummary/登录与单点登录/" class="nav-link"><!---->
  登录与单点登录
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/projectsSummary/权限管理方案实践/" class="nav-link"><!---->
  权限管理方案实践
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/projectsSummary/Echarts二次封装实践/" class="nav-link"><!---->
  Echarts二次封装实践
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/projectsSummary/文档在线预览和编辑方案/" class="nav-link"><!---->
  文档在线预览和编辑方案
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/projectsSummary/移动端开发实践/" class="nav-link"><!---->
  移动端开发实践
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="项目搭建到原理分析" class="dropdown-title"><span class="title"><!---->
      项目搭建
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/javascript/projectsSummary/从零到一搭建SSR项目/" class="nav-link"><!---->
  从零到一搭建SSR项目
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/projectsSummary/从零到一搭建移动端SSG项目/" class="nav-link"><!---->
  从零到一搭建移动端SSG项目
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/projectsSummary/移动端SSG项目实践/" class="nav-link"><!---->
  移动端SSG项目实践
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/projectsSummary/从零到一搭建Vue2工程化项目/" class="nav-link"><!---->
  从零到一搭建Vue2工程化项目
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/projectsSummary/从零到一搭建Vue3工程化项目/" class="nav-link"><!---->
  从零到一搭建Vue3工程化项目
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/projectsSummary/搭建低代码平台/" class="nav-link"><!---->
  搭建低代码平台
</a></li><li class="dropdown-item"><!----> <a href="/myblog/javascript/projectsSummary/混合桌面应用开发实践/" class="nav-link"><!---->
  混合桌面应用开发实践
</a></li></ul></div></div> <!----></nav> <!----> <div class="content__sidebar-center"></div> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><!----> <span class="title">JavaScript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/myblog/javascript/" aria-current="page" class="sidebar-link">JavaScript 基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/#es6新特性" class="sidebar-link">ES6新特性</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#严格模式的限制" class="sidebar-link">严格模式的限制</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#script-标签加载脚本" class="sidebar-link">Script 标签加载脚本</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#js-延迟加载方式" class="sidebar-link">JS 延迟加载方式</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#内存分类" class="sidebar-link">内存分类</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#数据类型" class="sidebar-link">数据类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/#undefined-null" class="sidebar-link heading3">undefined &amp; null</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#nan" class="sidebar-link heading3">NaN</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#精度丢失" class="sidebar-link">精度丢失</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#整数相关问题" class="sidebar-link">整数相关问题</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#显示转换-隐式转换" class="sidebar-link">显示转换&amp;隐式转换</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#运算符规则" class="sidebar-link">运算符规则</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#位运算符" class="sidebar-link">位运算符</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/#异或运算" class="sidebar-link heading3">异或运算</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#尾后逗号" class="sidebar-link">尾后逗号</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#symbol" class="sidebar-link">Symbol</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#类型判断" class="sidebar-link">类型判断</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/#typeof-操作符" class="sidebar-link heading3">typeof 操作符</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#instanceof-操作符" class="sidebar-link heading3">instanceof 操作符</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#数据类型判断方法" class="sidebar-link heading3">数据类型判断方法</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#数组" class="sidebar-link">数组</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/#数组创建和检测" class="sidebar-link heading3">数组创建和检测</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#数组方法" class="sidebar-link heading3">数组方法</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#会改变原数组方法" class="sidebar-link heading3">会改变原数组方法</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#数组迭代" class="sidebar-link heading3">数组迭代</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#for-in-与-for-of-比较" class="sidebar-link heading3">for...in 与 for...of 比较</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#类数组" class="sidebar-link">类数组</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#字符串" class="sidebar-link">字符串</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/#字符串的不可变性" class="sidebar-link heading3">字符串的不可变性</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#object-对象" class="sidebar-link">Object 对象</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/#对象访问" class="sidebar-link heading3">对象访问</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#对象方法" class="sidebar-link heading3">对象方法</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#对象属性" class="sidebar-link heading3">对象属性</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#对象属性方法" class="sidebar-link heading3">对象属性方法</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#防篡改对象" class="sidebar-link heading3">防篡改对象</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#假值对象" class="sidebar-link heading3">假值对象</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#内置对象" class="sidebar-link heading3">内置对象</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#new操作符" class="sidebar-link heading3">new操作符</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#深浅拷贝" class="sidebar-link">深浅拷贝</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#集合" class="sidebar-link">集合</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/#set-集合" class="sidebar-link heading3">Set 集合</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#weakset" class="sidebar-link heading3">WeakSet</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#map-集合" class="sidebar-link heading3">Map 集合</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#set、map、object-比较" class="sidebar-link heading3">Set、Map、Object 比较</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#变量" class="sidebar-link">变量</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/#变量声明方式" class="sidebar-link heading3">变量声明方式</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#变量提升和函数提升" class="sidebar-link heading3">变量提升和函数提升</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#this-和-this-绑定" class="sidebar-link">this 和 this 绑定</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#执行环境-环境栈" class="sidebar-link">执行环境&amp;环境栈</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#作用域-作用域链" class="sidebar-link">作用域&amp;作用域链</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#闭包" class="sidebar-link">闭包</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#prototype-对象" class="sidebar-link">Prototype 对象</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#prototype属性和proto-属性" class="sidebar-link">Prototype属性和proto 属性</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#获取原型方法" class="sidebar-link">获取原型方法</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#constructor-属性" class="sidebar-link">constructor 属性</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#原型-原型链" class="sidebar-link">原型&amp;原型链</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#函数" class="sidebar-link">函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/#es5-函数" class="sidebar-link heading3">ES5 函数</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#箭头函数" class="sidebar-link heading3">箭头函数</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#箭头函数与普通函数的区别" class="sidebar-link heading3">箭头函数与普通函数的区别</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#其他函数" class="sidebar-link heading3">其他函数</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#函数柯里化" class="sidebar-link heading3">函数柯里化</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#对象" class="sidebar-link">对象</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/#创建对象方式有哪些" class="sidebar-link heading3">创建对象方式有哪些</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#创建对象方式比较" class="sidebar-link heading3">创建对象方式比较</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#对象继承方式" class="sidebar-link heading3">对象继承方式</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#对象继承方式比较" class="sidebar-link heading3">对象继承方式比较</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#类" class="sidebar-link">类</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/#class-类" class="sidebar-link heading3">Class 类</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#class-继承" class="sidebar-link heading3">Class 继承</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#reflect-对象" class="sidebar-link">Reflect 对象</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#object-defineproperty" class="sidebar-link">Object.defineProperty</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#proxy-对象" class="sidebar-link">Proxy 对象</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/#object-defineproperty-和-proxy-比较" class="sidebar-link heading3">Object.defineProperty 和 Proxy 比较</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#模块加载方案" class="sidebar-link">模块加载方案</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/#commonjs-模块" class="sidebar-link heading3">CommonJS 模块</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#es6模块" class="sidebar-link heading3">ES6模块</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#模块加载混合引用" class="sidebar-link heading3">模块加载混合引用</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#模块加载循环引用" class="sidebar-link heading3">模块加载循环引用</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#定时器" class="sidebar-link">定时器</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#垃圾回收" class="sidebar-link">垃圾回收</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/#内存泄漏" class="sidebar-link heading3">内存泄漏</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#ajax" class="sidebar-link">AJax</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/#创建-ajax-过程" class="sidebar-link heading3">创建 Ajax 过程</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#消息推送技术" class="sidebar-link">消息推送技术</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/#sse实现" class="sidebar-link heading3">SSE实现</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#websocket-实现" class="sidebar-link heading3">websocket 实现</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#跨页面通信方法" class="sidebar-link">跨页面通信方法</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#iframe框架" class="sidebar-link">Iframe框架</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#bom" class="sidebar-link">BOM</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#dom" class="sidebar-link">DOM</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/#dom事件分类" class="sidebar-link heading3">DOM事件分类</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#事件流" class="sidebar-link">事件流</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/#事件是如果实现的" class="sidebar-link heading3">事件是如果实现的？</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#事件委托-代理" class="sidebar-link heading3">事件委托(代理)</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#js-兼容性" class="sidebar-link">JS 兼容性</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/#兼容性问题" class="sidebar-link heading3">兼容性问题</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/#兼容性统一处理方案" class="sidebar-link heading3">兼容性统一处理方案</a></li></ul></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><!----> <span class="title">专题</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/myblog/javascript/%E5%BC%82%E6%AD%A5/" class="sidebar-link">异步编程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%BC%82%E6%AD%A5/#宏任务-微任务" class="sidebar-link">宏任务&amp;微任务</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%BC%82%E6%AD%A5/#浏览器事件循环" class="sidebar-link">浏览器事件循环</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%BC%82%E6%AD%A5/#node-事件循环" class="sidebar-link">Node 事件循环</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%BC%82%E6%AD%A5/#浏览器-node-事件循环区别" class="sidebar-link">浏览器&amp;Node 事件循环区别</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%BC%82%E6%AD%A5/#异步编程方式" class="sidebar-link">异步编程方式</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%BC%82%E6%AD%A5/#模拟异步操作方式" class="sidebar-link">模拟异步操作方式</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%BC%82%E6%AD%A5/#pomise-对象" class="sidebar-link">Pomise 对象</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%BC%82%E6%AD%A5/#async-await" class="sidebar-link">async await</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%BC%82%E6%AD%A5/#异步循环" class="sidebar-link">异步循环</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%BC%82%E6%AD%A5/#异步串行" class="sidebar-link">异步串行</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%BC%82%E6%AD%A5/#回调实现" class="sidebar-link heading3">回调实现</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%BC%82%E6%AD%A5/#异步并行" class="sidebar-link">异步并行</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%BC%82%E6%AD%A5/#全并行" class="sidebar-link heading3">全并行</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%BC%82%E6%AD%A5/#有限并行" class="sidebar-link heading3">有限并行</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%BC%82%E6%AD%A5/#异步题目" class="sidebar-link">异步题目</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%BC%82%E6%AD%A5/#异步api执行顺序" class="sidebar-link heading3">异步API执行顺序</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%BC%82%E6%AD%A5/#settimeout-与-setimmediate-输出顺序" class="sidebar-link heading3">setTimeout 与 setImmediate 输出顺序</a></li></ul></li></ul></li><li><a href="/myblog/javascript/Promise/" class="sidebar-link">Promise 专题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/Promise/#promise-基础" class="sidebar-link">Promise 基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/Promise/#promise-概念" class="sidebar-link heading3">Promise 概念</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/Promise/#then" class="sidebar-link heading3">then()</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/Promise/#错误处理" class="sidebar-link heading3">错误处理</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/Promise/#promise-值穿透" class="sidebar-link heading3">Promise 值穿透</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/Promise/#finally" class="sidebar-link heading3">finally()</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/Promise/#包装pomise-对象" class="sidebar-link heading3">包装Pomise 对象</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/Promise/#并发方法" class="sidebar-link heading3">并发方法</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/javascript/Promise/#promise-原理实现" class="sidebar-link">Promise 原理实现</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/Promise/#promise-执行顺序" class="sidebar-link">Promise 执行顺序</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/Promise/#promise-封装异步操作" class="sidebar-link">Promise 封装异步操作</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/Promise/#promise-特性" class="sidebar-link">Promise 特性</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/Promise/#promise-特性问题" class="sidebar-link heading3">Promise 特性问题</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/Promise/#promise-应用题" class="sidebar-link heading3">Promise 应用题</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/javascript/Promise/#promisec串行" class="sidebar-link">Promisec串行</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/Promise/#串行概念" class="sidebar-link heading3">串行概念</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/Promise/#pomise-串行实现" class="sidebar-link heading3">Pomise 串行实现</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/Promise/#串行应用" class="sidebar-link heading3">串行应用</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/javascript/Promise/#promise-并行" class="sidebar-link">Promise 并行</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/Promise/#并行执行-api" class="sidebar-link heading3">并行执行 API</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/Promise/#并发控制" class="sidebar-link heading3">并发控制</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/javascript/Promise/#参考资料" class="sidebar-link">参考资料</a></li></ul></li><li><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/" aria-current="page" class="active sidebar-link">JS原理实现</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现-new-操作符" class="sidebar-link">实现 new 操作符</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现-instanceof-操作符" class="sidebar-link">实现 instanceof 操作符</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现-object-create" class="sidebar-link">实现 Object.create()</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现-call" class="sidebar-link">实现 call()</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现-apply" class="sidebar-link">实现 apply()</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现-bind" class="sidebar-link">实现 bind()</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现-sort" class="sidebar-link">实现 sort()</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现准时的-settimeout" class="sidebar-link">实现准时的 setTimeout</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现深拷贝" class="sidebar-link">实现深拷贝</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现防抖" class="sidebar-link">实现防抖</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现节流" class="sidebar-link">实现节流</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现函数柯里化" class="sidebar-link">实现函数柯里化</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#柯里化函数题目" class="sidebar-link">柯里化函数题目</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现图片懒加载" class="sidebar-link">实现图片懒加载</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现-jsonp" class="sidebar-link">实现 JSONP</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现单例模式" class="sidebar-link">实现单例模式</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#观察者模式" class="sidebar-link">观察者模式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#通用实现" class="sidebar-link heading3">通用实现</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#defineproperty-实现" class="sidebar-link heading3">defineProperty 实现</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#proxy实现" class="sidebar-link heading3">Proxy实现</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#发布订阅者模式" class="sidebar-link">发布订阅者模式</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现generator" class="sidebar-link">实现Generator</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现-async-await" class="sidebar-link">实现 async await</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><!----> <span class="title">应用</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/myblog/javascript/%E5%BA%94%E7%94%A8%E9%A2%98/" class="sidebar-link">JS应用题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%BA%94%E7%94%A8%E9%A2%98/#图片预加载和懒加载" class="sidebar-link">图片预加载和懒加载</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%BA%94%E7%94%A8%E9%A2%98/#图片预加载" class="sidebar-link heading3">图片预加载</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%BA%94%E7%94%A8%E9%A2%98/#图片懒加载" class="sidebar-link heading3">图片懒加载</a></li></ul></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%BA%94%E7%94%A8%E9%A2%98/#url-拆解问题" class="sidebar-link">URL 拆解问题</a></li><li class="sidebar-sub-header"><a href="/myblog/javascript/%E5%BA%94%E7%94%A8%E9%A2%98/#将-http-header-转换成对象" class="sidebar-link">将 HTTP header 转换成对象</a></li></ul></li></ul></section></li></ul> <!----> <div class="content__sidebar-bottom"></div> <!----></aside> <main class="page"><nav class="breadcrumb"><ol vocab="https://schema.org/" typeof="BreadcrumbList"><li property="itemListElement" typeof="ListItem"><a href="/myblog/javascript/" property="item" typeof="WebPage" class="router-link-active"><!----> <span property="name">JavaScript 基础</span></a> <meta property="position" content="1"></li><li property="itemListElement" typeof="ListItem" class="is-active"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/" aria-current="page" property="item" typeof="WebPage" class="router-link-exact-active router-link-active"><!----> <span property="name">JS原理实现</span></a> <meta property="position" content="2"></li></ol></nav> <!----> <div class="content__page-top"></div> <div vocab="https://schema.org/" typeof="Article" class="page-title"><h1><!----> <span property="headline">JS原理实现</span></h1> <div class="page-info"><!----> <true-info defaultAuthor="" categoryPath="/category/$category/" tagPath="/tag/$tag/"></true-info><true-info defaultAuthor="" categoryPath="/category/$category/" tagPath="/tag/$tag/"></true-info><true-info defaultAuthor="" categoryPath="/category/$category/" tagPath="/tag/$tag/"></true-info><true-info defaultAuthor="" categoryPath="/category/$category/" tagPath="/tag/$tag/"></true-info><true-info defaultAuthor="" categoryPath="/category/$category/" tagPath="/tag/$tag/"></true-info><true-info defaultAuthor="" categoryPath="/category/$category/" tagPath="/tag/$tag/"></true-info><true-info defaultAuthor="" categoryPath="/category/$category/" tagPath="/tag/$tag/"></true-info></div> <!----> <hr></div> <div class="anchor-place-holder"><aside id="anchor"><div class="anchor-wrapper"><ul class="anchor-list"><li class="anchor"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现-new-操作符" class="anchor-link heading2"><div>实现 new 操作符</div></a></li><li class="anchor"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现-instanceof-操作符" class="anchor-link heading2"><div>实现 instanceof 操作符</div></a></li><li class="anchor"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现-object-create" class="anchor-link heading2"><div>实现 Object.create()</div></a></li><li class="anchor"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现-call" class="anchor-link heading2"><div>实现 call()</div></a></li><li class="anchor"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现-apply" class="anchor-link heading2"><div>实现 apply()</div></a></li><li class="anchor"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现-bind" class="anchor-link heading2"><div>实现 bind()</div></a></li><li class="anchor"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现-sort" class="anchor-link heading2"><div>实现 sort()</div></a></li><li class="anchor"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现准时的-settimeout" class="anchor-link heading2"><div>实现准时的 setTimeout</div></a></li><li class="anchor"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现深拷贝" class="anchor-link heading2"><div>实现深拷贝</div></a></li><li class="anchor"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现防抖" class="anchor-link heading2"><div>实现防抖</div></a></li><li class="anchor"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现节流" class="anchor-link heading2"><div>实现节流</div></a></li><li class="anchor"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现函数柯里化" class="anchor-link heading2"><div>实现函数柯里化</div></a></li><li class="anchor"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#柯里化函数题目" class="anchor-link heading2"><div>柯里化函数题目</div></a></li><li class="anchor"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现图片懒加载" class="anchor-link heading2"><div>实现图片懒加载</div></a></li><li class="anchor"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现-jsonp" class="anchor-link heading2"><div>实现 JSONP</div></a></li><li class="anchor"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现单例模式" class="anchor-link heading2"><div>实现单例模式</div></a></li><li class="anchor"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#观察者模式" class="anchor-link heading2"><div>观察者模式</div></a></li><li class="anchor"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#通用实现" class="anchor-link heading3"><div>通用实现</div></a></li><li class="anchor"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#defineproperty-实现" class="anchor-link heading3"><div>defineProperty 实现</div></a></li><li class="anchor"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#proxy实现" class="anchor-link heading3"><div>Proxy实现</div></a></li><li class="anchor"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#发布订阅者模式" class="anchor-link heading2"><div>发布订阅者模式</div></a></li><li class="anchor"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现generator" class="anchor-link heading2"><div>实现Generator</div></a></li><li class="anchor"><a href="/myblog/javascript/%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0/#实现-async-await" class="anchor-link heading2"><div>实现 async await</div></a></li></ul></div></aside></div> <!----> <div class="content__content-top"></div> <div class="theme-default-content content__default"><h1 id="js原理实现"><a href="#js原理实现" class="header-anchor">#</a> JS原理实现</h1> <h2 id="实现-new-操作符"><a href="#实现-new-操作符" class="header-anchor">#</a> 实现 new 操作符</h2> <p>new操作符作用: 创建一个给定构造函数的实例</p> <ul><li>原理
<ul><li>（1）创建一个空对象；</li> <li>（2）将空对象的[prototype]原型指向构造函数的原型对象；</li> <li>（3）将构造函数的执行上下文this绑定到空对象；</li> <li>（4）返回空对象</li></ul></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/**

 \* @param {Function} construct 构造函数

 \* @param {any} args  其余参数

 \* @return obj 绑定了构造函数上下文的空对象

 */</span>

<span class="token keyword">function</span> <span class="token function">myNew</span><span class="token punctuation">(</span><span class="token parameter">construct<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">//创建空对象</span>

  obj<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> construct<span class="token punctuation">.</span>prototype <span class="token comment">//将空对象的[prototype]原型指向构造函数的原型对象</span>

  <span class="token function">construct</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> args<span class="token punctuation">)</span> <span class="token comment">//将构造函数的执行上下文this绑定到空对象</span>

  <span class="token keyword">return</span> obj

<span class="token punctuation">}</span>

<span class="token comment">//-----------------------------------------使用-------------------------------------------------------</span>

<span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name

  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age

<span class="token punctuation">}</span>

<span class="token keyword">let</span> person1 <span class="token operator">=</span> <span class="token function">myNew</span><span class="token punctuation">(</span>Person<span class="token punctuation">,</span> <span class="token string">'joker'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">name is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>person1<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, age is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>person1<span class="token punctuation">.</span>age<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h2 id="实现-instanceof-操作符"><a href="#实现-instanceof-操作符" class="header-anchor">#</a> 实现 instanceof 操作符</h2> <ul><li><p>instanceof操作符号作用:  a instanceof B 用于判断a实例是否为B对象的原型</p></li> <li><p>原理</p> <ul><li>(1)获取对象的原型prototype；</li> <li>(2)获取实例的__proto__属性；</li> <li>(3) 判断实例__proto__是否等于对象的prototype，相等返回true，否则获取实例原型的原型属性(<strong>proto</strong>.<strong>proto</strong>)；继续判断... 如果循环，直到实例的__proto__属性返回null，则表示退出循环</li></ul></li></ul> <p><strong>实现一</strong></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/**

 \* 递归实现instanceof

 \* @param {Object} inst 实例

 \* @param {obj} 对象  其余参数

 \* @return true || false

 */</span>

<span class="token keyword">function</span> <span class="token function">myInstanceof</span><span class="token punctuation">(</span><span class="token parameter">inst<span class="token punctuation">,</span> obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">let</span> proto <span class="token operator">=</span> inst<span class="token punctuation">.</span>__proto__ <span class="token comment">//获取实例的__proto__属性</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>proto<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//如果实例__proto__属性存在，则沿着__proto__原型链查找</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>proto <span class="token operator">===</span> obj<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//在实例原型链中找到d对象的prototype对象</span>

      <span class="token keyword">return</span> <span class="token boolean">true</span>

    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">//沿着__proto__原型链递归查找</span>

      <span class="token keyword">return</span> <span class="token function">myInstanceof</span><span class="token punctuation">(</span>proto<span class="token punctuation">,</span> obj<span class="token punctuation">)</span>

    <span class="token punctuation">}</span>

  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">//已经查找达到原型链顶部，不存在对象的prototype对象</span>

    <span class="token keyword">return</span> <span class="token boolean">false</span>

  <span class="token punctuation">}</span>

<span class="token punctuation">}</span>



<span class="token comment">/**

 \* 非递归实现instanceof

 \* 分析：非递归版实现可以通过递归版本转换，递归转换非递归实现核心为需要寻找函数的出口条件，没有找到一直循环查找

 \* @param {Object} inst 实例

 \* @param {obj} 对象  其余参数

 \* @return true || false

 */</span>

<span class="token keyword">function</span> <span class="token function">myInstanceof</span><span class="token punctuation">(</span><span class="token parameter">inst<span class="token punctuation">,</span> obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">let</span> proto <span class="token operator">=</span> inst<span class="token punctuation">.</span>__proto__ <span class="token comment">//获取实例的__proto__属性</span>

  <span class="token keyword">while</span> <span class="token punctuation">(</span>proto <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//出口条件: 实例的__proto__为null，当实例__proto__为null时表示查找到实例原型链的最顶端</span>

​    <span class="token keyword">if</span> <span class="token punctuation">(</span>proto <span class="token operator">===</span> obj<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//在实例的原型链中查找对象的prototype对象</span>

​      <span class="token keyword">return</span> <span class="token boolean">true</span>

​    <span class="token punctuation">}</span>

​    proto <span class="token operator">=</span> proto<span class="token punctuation">.</span>__proto__ <span class="token comment">//沿着实例的原型链查找</span>

  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token boolean">false</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br></div></div><p><strong>实现二</strong></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/*
 * --- 手动实现 instanceof ---
 */</span>

<span class="token keyword">function</span> <span class="token function">newInstanceOf</span> <span class="token punctuation">(</span><span class="token parameter">leftValue<span class="token punctuation">,</span> rightValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> leftValue <span class="token operator">!==</span> <span class="token string">'object'</span> <span class="token operator">||</span> rightValue <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">let</span> rightProto <span class="token operator">=</span> rightValue<span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>
    leftValue <span class="token operator">=</span> leftValue<span class="token punctuation">.</span>__proto__<span class="token punctuation">;</span>
    
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>leftValue <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>leftValue <span class="token operator">===</span> rightProto<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        leftValue <span class="token operator">=</span> leftValue<span class="token punctuation">.</span>__proto__<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/*
 * ------ 验证 ------
 */</span>

<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">Foo</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">Child</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Father</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Father</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">//------测试用例-----</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">newInstanceOf</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> Array<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">newInstanceOf</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> Object<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">newInstanceOf</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> Array<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">newInstanceOf</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> Object<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">newInstanceOf</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> Foo<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">newInstanceOf</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> Child<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">newInstanceOf</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> Father<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">newInstanceOf</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">,</span> Object<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// false </span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">123</span> <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><blockquote><p>这个问题既考察了 instanceof 的原理，又考察了原型链，还考察了代码能力。</p> <p>在实现代码中，我们判断 leftValue 是否为 rightValue 的实例，思想是在 leftValue 的原型链上，即 leftValue.<strong>proto</strong> 上寻找是否存在 rightValue.prototype。原理图如下:</p> <p><img src="/myblog/assets/img/instanceof-demo.c699d98f.png" alt=""></p></blockquote> <h2 id="实现-object-create"><a href="#实现-object-create" class="header-anchor">#</a> 实现 Object.create()</h2> <ul><li>原理： 将传入的对象作为原型</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> obj
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="实现-call"><a href="#实现-call" class="header-anchor">#</a> 实现 <a href="https://developer.mozilla.org/zh-CN/search?q=call" target="_blank" rel="noopener noreferrer">call()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h2> <ul><li><p>作用
在特定的作域中调用函数，实际上等于设置函数体内 this 对象的值，扩充函数的作用域</p></li> <li><p>接收多个参数
第一个参数:在其中运行函数的作用域，一般为this
其余参数:传递给函数的参数必须逐个列举出来</p></li> <li><p>返回值
使用调用者提供的 this 值和参数调用该函数的返回值。若该方法没有返回值，则返回 undefined</p></li> <li><p>原理</p> <ul><li><p>将&quot;调用call方法的函数&quot;的原型添加到call()方法第一个参数对象的作用域链上</p> <blockquote><p>​	添加原型过程：</p> <p>​	1.当函数调用call()方法时候传入第一个参数为调用者this绑定的对象，参数为空默认为全局对象，既window
​	2.因为call()方法是挂在到Function.prototype指向的对象(既Funtion的原型对象)内的,所以当一个函数调用call()方法时候，call()方法内部的this是指向调用者对象的
​	3.call()内部将this保存到传入的第一个参数对象中(既需要绑定this的对象)，作为参数对象的一个属性
​	4.保存this后，则call()方法的this对象(既调用call方法的函数)与传入参数对象形成一条作用域链，在该作用域链中this对象(既调用call方法的函数）在作用域链的最前端
​	5.然后通过传入参数对象调用“调用call方法的函数”,此时“调用call方法的函数”的this指向与参数对象形成的作用域链
​	6.当查找某个属性时，如果&quot;调用call()方法的函数&quot;没有该属性，就会沿着这条作用域链去参数对象中查找该属性</p></blockquote></li></ul></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/**
 * 模拟实现call()方法
 * call()方法原理：通过将调用call方法的函数作用域扩展到第一个参数对象的作用域链中,因此调用call的函数通过this可以访问到参数对象的属性和方法
 * @param {Object} context, 扩展的作用域对象
 * @param {any} args  其余参数
 * return result 函数调用结果
 */</span>
<span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myCall</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">context <span class="token operator">=</span> window<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">===</span> <span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//判断当前this是否为函数,防止Function.prototype.myCall() 直接调用;直接调用this指向funcion原型对象</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token comment">//输出 ƒ () { [native code] }</span>
    <span class="token keyword">return</span> <span class="token keyword">undefined</span>
  <span class="token punctuation">}</span>
  context <span class="token operator">=</span> context <span class="token operator">||</span> window <span class="token comment">//context 为可选参数,如果不传的话默认上下文为 window</span>
  <span class="token keyword">let</span> fn <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//为context 创建一个 Symbol（保证不会重名）属性,将当前函数赋值给这个属性</span>
  <span class="token comment">//因为调用myCall方法的函数是调用了自己原型链对象上的myCall方法,所以当前myCall方法内的this指向调用myCall方法的函数</span>
  context<span class="token punctuation">[</span>fn<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span>  <span class="token comment">//将调用myCall方法的函数挂在到传入的contex原型对象上,成为context对象的属性;调用函数作用域添加到参数对象的作用域链上</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> context<span class="token punctuation">[</span>fn<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span> <span class="token comment">//在context对象上调用调用myCall方法的函数,此时myCall可以访问到参数对象的作用域链上的属性和方法</span>
  <span class="token keyword">delete</span> context<span class="token punctuation">[</span>fn<span class="token punctuation">]</span>   <span class="token comment">//调用完成后在context对象上删除调用myCall方法的函数,既从参数对象的作用域链中删除调用myCall的函数的作用域</span>
  <span class="token keyword">return</span> result   <span class="token comment">//返回结果</span>
<span class="token punctuation">}</span>
<span class="token comment">//myCall使用示例</span>
<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">2</span>
<span class="token keyword">function</span> <span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'a is '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>a <span class="token operator">+</span> <span class="token string">' greet is '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//输出a is 2 greet is [object Window]</span>
greet<span class="token punctuation">.</span><span class="token function">myCall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//a is 2 greet is [object Window]</span>
greet<span class="token punctuation">.</span><span class="token function">myCall</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token comment">//输出a is 1 greet is [object Object]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h2 id="实现-apply"><a href="#实现-apply" class="header-anchor">#</a> 实现 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/apply" target="_blank" rel="noopener noreferrer">apply()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h2> <ul><li>作用
在特定的作域中调用函数，实际上等于设置函数体内 this 对象的值，扩充函数的作用域</li> <li>接收2个参数
第一个参数:在其中运行函数的作用域，一般为this
第二个参数:参数数组，可以是 Array 的实例，也可以是arguments 对象</li> <li>返回值
调用有指定this值和参数的函数的结果</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/**
 * apply()方法原理和callf()方法原理一样,但是第二个参数不同:apply的第二个参数为数组
 * @param {Object} context, 扩展的作用域对象
 * @param {any} args  其余参数
 * return result 函数调用结果
 */</span>
<span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myApply</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">context <span class="token operator">=</span> window<span class="token punctuation">,</span> args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">===</span> <span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">undefined</span>
  <span class="token punctuation">}</span>

  context <span class="token operator">=</span> context <span class="token operator">||</span> window
  <span class="token keyword">let</span> result
  <span class="token keyword">let</span> fn <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  context<span class="token punctuation">[</span>fn<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//当前参数为数组</span>
    result <span class="token operator">=</span> context<span class="token punctuation">[</span>fn<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">//参数为空</span>
    result <span class="token operator">=</span> context<span class="token punctuation">[</span>fn<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">delete</span> context<span class="token punctuation">[</span>fn<span class="token punctuation">]</span>
  <span class="token keyword">return</span> result
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><ul><li>call() 和 apply()方法比较
<ul><li>区别： call()方法接受的是参数列表，而apply()方法接受的是一个参数数组</li></ul></li></ul> <h2 id="实现-bind"><a href="#实现-bind" class="header-anchor">#</a> 实现 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/bind" target="_blank" rel="noopener noreferrer">bind()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h2> <ul><li>创建一个函数的实例，其 this 值会被绑定到传给 bind() 函数的值</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/**
 * Function.prototype.bind(thisArg[, arg1[, arg2[, ...]]])函数参数
 * 函数参数：
 *  thisArg,  调用绑定函数时作为 this 参数传递给目标函数的值
 *  arg1, arg2, ...  当目标函数被调用时,被预置入绑定函数的参数列表中的参数。
 *  返回值 function 返回一个原函数的拷贝,并拥有指定的 this 值和初始参数
 */</span>

<span class="token comment">/**
 * 实现方式一
 * bind()最简单的实现
 * 思想：给目标函数指定作用域
 * @param {object} context 绑定的作用域对象
 */</span>
<span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myBind</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> self <span class="token operator">=</span> <span class="token keyword">this</span> <span class="token comment">//保存调用函数的作用域</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">self</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> arguments<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 实现方式二
 * 考虑bind()函数柯里化情况？？
 * 思想：获取函数参数,返回一个闭包函数,用于收集函数其余参数
 * @param {object} context 绑定的作用域对象
 */</span>

<span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myBind</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> self <span class="token operator">=</span> <span class="token keyword">this</span> <span class="token comment">//保存调用函数的作用域</span>
  <span class="token keyword">let</span> args <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">//获取第二个参数之后的所有参数(第一个参数为context)</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//返回闭包</span>
    <span class="token keyword">let</span> innerArgs <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span> <span class="token comment">//收集第二个以后参数</span>
    <span class="token function">self</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> args<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>innerArgs<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//合并参数并用调用bind()的函数调用apply</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 实现方式三(推荐)
 * Javascript的函数还可以作为构造函数,那么绑定后的函数用这种方式调用时,情况有所不同
 * 思想：通过设置一个中转构造函数F,使绑定后的函数与调用bind()的函数处于同一原型链上,
 * 用new操作符调用绑定后的函数,返回的对象也能正常使用instanceof,因此这是最严谨的bind()实现
 * @param {object} context 绑定的作用域对象
 */</span>
<span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myBind</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">===</span> <span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//防止直接调用</span>
    <span class="token keyword">throw</span> <span class="token function">TypeError</span><span class="token punctuation">(</span><span class="token string">'Error'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">let</span> self <span class="token operator">=</span> <span class="token keyword">this</span> <span class="token comment">//保存调用者函数的作用域</span>
  <span class="token keyword">let</span> args <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">//获取第二个参数之后的所有参数(第一个参数为context)</span>
  <span class="token function-variable function">F</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span> <span class="token comment">//创建一个中转构造函数</span>
  <span class="token keyword">let</span> <span class="token function-variable function">bound</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//闭包,用于收集bind()的其余参数</span>
    <span class="token keyword">let</span> innerArgs <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span> <span class="token comment">//获取回调函数参数</span>
    <span class="token function">self</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">F</span> <span class="token operator">&amp;&amp;</span> context <span class="token operator">?</span> <span class="token keyword">this</span> <span class="token operator">:</span> context <span class="token operator">||</span> window<span class="token punctuation">,</span> args<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>innerArgs<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> self<span class="token punctuation">.</span>prototype <span class="token comment">//F继承当前函数,与调用bind的函数作用域链链接</span>
  bound<span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//闭包函数继承F函数,使作用域链接与调用bind()函数的作用域链链接,最总形成 bound -&gt; F -&gt; 调用bind的函数的作用链  </span>
  <span class="token keyword">return</span> bound
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 简化价写法(推荐)
 * @param {object} context 绑定的作用域对象
 */</span>
<span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myBind</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">===</span> <span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token function">TypeError</span><span class="token punctuation">(</span><span class="token string">'Error'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">let</span> self <span class="token operator">=</span> <span class="token keyword">this</span> <span class="token comment">//保存调用bind方法的函数作用域</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//返回闭包</span>
    <span class="token comment">//判断是否为构造函数调用,如果是则使用new调用当前构造函数？？</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">F</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">self</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">,</span> <span class="token operator">...</span>args2<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//否则使用apply，将context和处理好的参数传入</span>
    <span class="token keyword">return</span> <span class="token function">self</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> args<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>args2<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br></div></div><ul><li>注意问题
<ul><li>显示绑定对箭头函数无效，箭头函数在定义时绑定了外层对象</li> <li>如果你传入了一个原始值（字符串类型、布尔类型或者数字类型）来当作 this 的绑定对象，这个原始值会被转换成它的对象形式（也就是 new String(..) 、 new Boolean(..) 或者new Number(..) ）。这通常被称为“装箱”</li> <li>把 null 或者 undefined 作为 this 的绑定对象传入 call 、 apply 或者 bind ，这些值在调用时会被忽略，实际应用的是默认绑定规则</li> <li>使用null作为绑定方法的绑定对象产生的问题
<ul><li>如果函数并不关心 this 的话，你仍然需要传入一个占位值，这时 null 可能是一个不错的选择</li> <li>总是使用 null 来忽略 this 绑定可能产生一些副作用。</li> <li>如果某个函数确实使用了this （比如第三方库中的一个函数），</li> <li>那默认绑定规则会把 this 绑定到全局对象（在浏览器中这个对象是 window ）</li> <li>解决方法：
<ul><li>使用空对象作为绑定方法的绑定对象，在 JavaScript 中创建一个空对象最简单的方法都是 Object.create(null)，Object.create(null) 和 {} 很像，但是并不会创建 Object.prototype 这个委托，所以它比 {} “更空”</li> <li>如果想“更安全”地忽略 this 绑定，你可以使用一个 Object.create(null) 对象，以保护全局对象</li></ul></li></ul></li></ul></li></ul> <h2 id="实现-sort"><a href="#实现-sort" class="header-anchor">#</a> 实现 sort()</h2> <blockquote><p><strong>讲下 V8 sort 的大概思路，并手写一个 sort 的实现</strong></p></blockquote> <ul><li><p>关于 <code>Array.prototype.sort()</code> ，ES 规范并没有指定具体的算法，在 V8 引擎中，  <strong>7.0 版本之前</strong> ，数组长度小于10时， <code>Array.prototype.sort()</code> 使用的是插入排序，否则用快速排序。</p></li> <li><p>在 V8 引擎 <strong>7.0 版本之后</strong> 就舍弃了快速排序，因为它不是稳定的排序算法，在最坏情况下，时间复杂度会降级到 O(n2)。于是采用了一种混合排序的算法：<strong>TimSort</strong> 。</p></li></ul> <p><img src="/myblog/assets/img/paixu.43a49aba.png" alt=""></p> <h2 id="实现准时的-settimeout"><a href="#实现准时的-settimeout" class="header-anchor">#</a> 实现准时的 setTimeout</h2> <ul><li><p>setTimeout 存在问题：因为 setTimtout 为宏任务，在 setTimeout 任务推入任务队列时，有可能在 JS 时间循环中主线程存在其他任务，因此 setTimeout 任务存在时间误差。参考本节 <a href="###%E5%AE%9A%E6%97%B6%E5%99%A8">定时器</a> 中解释。</p></li> <li><p>实现准时 setTomeout 有四种方式：</p></li></ul> <table><thead><tr><th style="text-align:left;"></th> <th style="text-align:left;">while</th> <th style="text-align:left;">Web Worker</th> <th style="text-align:left;">requestAnimationFrame</th> <th style="text-align:left;">setTimeout 系统时间补偿</th></tr></thead> <tbody><tr><td style="text-align:left;">准确度</td> <td style="text-align:left;">高</td> <td style="text-align:left;">高</td> <td style="text-align:left;">低</td> <td style="text-align:left;">高</td></tr> <tr><td style="text-align:left;">主线程阻塞</td> <td style="text-align:left;">阻塞</td> <td style="text-align:left;">一般</td> <td style="text-align:left;">不阻塞</td> <td style="text-align:left;">不阻塞</td></tr> <tr><td style="text-align:left;">评分</td> <td style="text-align:left;">⭐️⭐️</td> <td style="text-align:left;">⭐️⭐️⭐️</td> <td style="text-align:left;">⭐️</td> <td style="text-align:left;">⭐️⭐️⭐️⭐️⭐️</td></tr></tbody></table> <p><strong>while 循环实现</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">timer</span><span class="token punctuation">(</span><span class="token parameter">time</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> startTime <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> now <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>now <span class="token operator">-</span> startTime <span class="token operator">&gt;=</span> time<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'误差'</span><span class="token punctuation">,</span> now <span class="token operator">-</span> startTime <span class="token operator">-</span> time<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">timer</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><blockquote><p>打印：误差 0</p></blockquote> <ul><li>优点：方式很精确</li> <li>缺点： js 是单线程运行，使用这样的方式强行霸占线程会使得页面进入卡死状态。</li></ul> <p><strong>Web Worker</strong></p> <ul><li><p>通过 Web Worker 在另一个线程来执行定时任务.</p></li> <li><p>一个 worker 的简单的示例</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// main.js</span>
<span class="token keyword">var</span> myWorker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Worker</span><span class="token punctuation">(</span><span class="token string">'worker.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 监听 worker</span>
myWorker<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  result<span class="token punctuation">.</span>textContent <span class="token operator">=</span> e<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Message received from worker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
first<span class="token punctuation">.</span><span class="token function-variable function">onchange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 向 worker 发送数据</span>
  myWorker<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token punctuation">[</span>first<span class="token punctuation">.</span>value<span class="token punctuation">,</span>second<span class="token punctuation">.</span>value<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Message posted to worker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// worker.js</span>
<span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 接受主线程的数据</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Message received from main script'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> workerResult <span class="token operator">=</span> <span class="token string">'Result: '</span> <span class="token operator">+</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> e<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Posting message back to main script'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 向主线程发送数据</span>
  <span class="token function">postMessage</span><span class="token punctuation">(</span>workerResult<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>那么接下来我们就要加 worker 和 while 相结合，以下为创建 worker 部分</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// worker生成器</span>
<span class="token keyword">const</span> <span class="token function-variable function">createWorker</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> blob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'('</span> <span class="token operator">+</span> fn<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">')()'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Worker</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Worker</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> 
<span class="token comment">// worker 部分</span>
<span class="token keyword">const</span> worker <span class="token operator">=</span> <span class="token function">createWorker</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> date <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> now <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>now <span class="token operator">-</span> date <span class="token operator">&gt;=</span> e<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>我们通过在 worker 中写入一个 while 循环，当达到我们的预取时间的时候，再向主线程发送一个完成事件，就不会因为主线程的其他代码的干扰而造成数据不准的情况。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> isStart <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">timer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    worker<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token function">cb</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>isStart<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            worker<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>speed<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> 
    <span class="token punctuation">}</span>
    worker<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>speed<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li></ul> <p><strong>requestAnimationFrame()</strong></p> <ul><li><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/requestAnimationFrame" target="_blank" rel="noopener noreferrer"><strong><code>window.requestAnimationFrame()</code></strong> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>:告诉浏览器——你希望执行一个动画，并且要求浏览器在下次重绘之前调用指定的回调函数更新动画。该方法需要传入一个回调函数作为参数，该回调函数会在浏览器下一次重绘之前执行，回调函数执行次数通常是每秒60次，也就是每16.7ms 执行一次，但是并不一定保证为 16.7 ms。</p></li> <li><p>实现:</p> <ul><li><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 模拟代码</span>
<span class="token keyword">function</span> <span class="token function">setTimeout2</span> <span class="token punctuation">(</span><span class="token parameter">cb<span class="token punctuation">,</span> delay</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> startTime <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  
    <span class="token keyword">function</span> <span class="token function">loop</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> now <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>now <span class="token operator">-</span> startTime <span class="token operator">&gt;=</span> delay<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">cb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>loop<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></li> <li><p>缺点: 由于 16.7 ms 间隔执行，在使用间隔很小的定时器，很容易导致时间的不准确</p></li></ul></li></ul> <p><strong>setTimeout 系统时间补偿</strong></p> <ul><li><p>原理:当每一次定时器执行时后，都去获取系统的时间来进行修正，虽然每次运行可能会有误差，但是通过系统时间对每次运行的修复，能够让后面每一次时间都得到一个补偿</p> <ul><li><p>setTimetout 时序:</p> <p><img src="/myblog/assets/img/settimeout时序.ac5af109.png" alt=""></p></li> <li><p>setTimeout 时间补偿:</p> <p><img src="/myblog/assets/img/settimeout时间补偿.62503a06.png" alt=""></p></li></ul></li> <li><p>实现:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">timer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">var</span> speed <span class="token operator">=</span> <span class="token number">500</span><span class="token punctuation">,</span>
   counter <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> 
   start <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   
   <span class="token keyword">function</span> <span class="token function">instance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
    <span class="token keyword">var</span> ideal <span class="token operator">=</span> <span class="token punctuation">(</span>counter <span class="token operator">*</span> speed<span class="token punctuation">)</span><span class="token punctuation">,</span>
    real <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    counter<span class="token operator">++</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> diff <span class="token operator">=</span> <span class="token punctuation">(</span>real <span class="token operator">-</span> ideal<span class="token punctuation">)</span><span class="token punctuation">;</span>
    form<span class="token punctuation">.</span>diff<span class="token punctuation">.</span>value <span class="token operator">=</span> diff<span class="token punctuation">;</span>

    window<span class="token punctuation">.</span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">instance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>speed <span class="token operator">-</span> diff<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 通过系统时间进行修复</span>

   <span class="token punctuation">}</span><span class="token punctuation">;</span>
   
   window<span class="token punctuation">.</span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">instance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> speed<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div></li></ul> <p><strong>参考资料</strong></p> <p><a href="https://mp.weixin.qq.com/s/1ComSa7Rw-p_NIfg0dup7Q" target="_blank" rel="noopener noreferrer">如何实现准时的setTimeout<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="实现深拷贝"><a href="#实现深拷贝" class="header-anchor">#</a> 实现深拷贝</h2> <p>深拷贝考虑问题：</p> <ul><li>基础类型</li> <li>引用类型
<ul><li>RegExp、Date、函数 不是 JSON 安全的</li> <li>会丢失 constructor，所有的构造函数都指向 Object</li> <li>破解循环引用</li></ul></li></ul> <p>实现一：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">deepCopy</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//基本类型和null是不可变的，无需进行深拷贝</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> obj <span class="token operator">!==</span> <span class="token string">'object'</span> <span class="token operator">||</span> obj <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> obj<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">let</span> copy<span class="token punctuation">;</span>
  
  <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    copy <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> obj<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      copy<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">deepCopy</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//递归调用deepCopy函数来对对象的每个属性进行深拷贝</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    copy <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//在遍历对象属性时，通过hasOwnProperty方法来确保只复制对象自身的属性，而不包括继承的属性。</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        copy<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">deepCopy</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//递归调用deepCopy函数来对对象的每个属性进行深拷贝</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">return</span> copy<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>实现二：</p> <p><img src="/myblog/assets/img/deepCopy.b158c2e2.png" alt=""></p> <h2 id="实现防抖"><a href="#实现防抖" class="header-anchor">#</a> 实现防抖</h2> <ul><li><p>防抖作用：防止触发频率过高</p></li> <li><p>思想：不管事件触发频率多高，事件总是在n秒后执行；如果一个事件在触发后n秒内再次触发，就清除前一次事件的计时，以后一次事件触发事件为准冲重新计时n秒，n秒后执行</p></li></ul> <p><img src="/myblog/assets/img/防抖节流.bed5cb05.gif" alt=""></p> <ul><li><p>原理：当调用debounce以后立即执行，返回闭包函数给调用者，往后执行都是执行闭包函数，闭包中可以访问debounce中定义的定时器变量</p></li> <li><p>实现流程：</p> <ul><li><p>1.通过计时延迟事件执行；</p></li> <li><p>2.当事件在计时事件内触发，则重新计时；</p></li> <li><p>3.通过闭包来保存计时变量；</p></li> <li><p>4.为了使this指向明确，返回闭包用普通函数，重新计时用箭头函数（this并非指向debounce的调用者，而是执行返回闭包的调用）</p></li> <li><p>5.对参数透传</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/**
 * @param {Function} callback  事件回调函数
 * @param {Number} time  延迟执行时间
 * @return funcion 闭包
 */</span>
<span class="token keyword">function</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token parameter">callback<span class="token punctuation">,</span> time</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> timer <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token comment">//设置定时器变量</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//返回闭包来保存定时器变量(闭包中的this指向闭包的调用者)</span>
    <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span> <span class="token comment">//清除定时器</span>
    timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">//重新定时(箭头函数的this绑定定义时外层对象的this，既闭包的this，闭包的this指向闭包的调用者)</span>
      <span class="token function">callback</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span> <span class="token comment">//注意通过apply绑定回调的this</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></li></ul></li> <li><p>扩展题：实现防抖中调用立即执行一次，往后触发事件等待n秒后执行</p> <ul><li><p>思想：给debounce函数添加标记，用于标记是否为第一次执行</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/** 
 * @param {Function} callback  事件回调函数
 * @param {Number} time  延迟执行时间
 * @return funcion 闭包
 */</span>
<span class="token keyword">function</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token parameter">callback<span class="token punctuation">,</span> time<span class="token punctuation">,</span> flag</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> timer <span class="token operator">=</span> <span class="token keyword">null</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>timer <span class="token operator">&amp;&amp;</span> flag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'立即执行一次'</span><span class="token punctuation">)</span>
      <span class="token function">callback</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span>
    timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">callback</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></li></ul></li> <li><p>debounce的应用场景:</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'print param is'</span><span class="token punctuation">,</span> params<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//窗口大小变化，调整样式</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'resize'</span><span class="token punctuation">,</span> <span class="token function">debounce</span><span class="token punctuation">(</span>print<span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//调整窗口,输出为 event事件</span>
<span class="token comment">//搜索框，输入后1000毫秒搜索</span>
<span class="token function">debounce</span><span class="token punctuation">(</span>fetchSelectData<span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span>
<span class="token comment">//表单验证，输入1000毫秒后验证</span>
<span class="token function">debounce</span><span class="token punctuation">(</span>validator<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li></ul> <h2 id="实现节流"><a href="#实现节流" class="header-anchor">#</a> 实现节流</h2> <ul><li><p>思想：当持续触发事件时，保证一定时间段内只调用一次事件处理函数；在一次事件触发后在触发后的指定时间内触发事件都忽略，只有在指定时间间隔后触发事件生效</p></li> <li><p>实现方式：使用时间戳、使用定时器、结合时间戳和定时器三种实现方式</p></li> <li><p>实现一：<strong>使用时间戳实现节流</strong></p> <ul><li><p>思想：调用函数时保存当前时间戳，立即返回闭包，闭包中计算下次调用时间戳和上次调用时间戳差值，如果差值大于节流时间，则调用回调</p></li> <li><p>缺点：第一次事件一定触发，最后一次事件不触发 ？？（测试现象：返回闭包时候会立即执行一次回调，原因：？？）</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code> <span class="token comment">/**
 * @param {Function} callback  事件回调函数
 * @param {Number} time  延迟执行时间
 * @return function 闭包
 */</span>
<span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">callback<span class="token punctuation">,</span> time</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> pretime <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//记录前一次调用时时间戳</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//返回闭包比较时间差</span>
    <span class="token keyword">let</span> nexttime <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//记录当前调用时时间戳</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>nexttime <span class="token operator">-</span> pretime <span class="token operator">&gt;=</span> time<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//时间戳差值大于节流时间，执行回调</span>
      pretime <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//重新记录执行时间戳</span>
      <span class="token function">callback</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div></li></ul></li> <li><p>实现二：<strong>使用定时间实现节流</strong></p> <ul><li><p>思想：调用函数时候定义定时器变量，立即返回闭包，闭包中判断定时器变量是否为空，如果为空执行回调</p></li> <li><p>缺点：第一次事件不触发，最后一次事件一定触发？？（测试现象：返回闭包时候不执行回调，原因：？？）</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/**
* @param {Function} callback  事件回调函数
 * @param {Number} time  延迟执行时间
 * @return function 闭包
 */</span>
<span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">callback<span class="token punctuation">,</span> time</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> timer <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token comment">//定义定时器变量</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//返回闭包</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//定时器变量为空，设置time时间后执行回调</span>
      timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        timer <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token comment">//清空计时变量(该操作要在调用回调之前清空)</span>
        <span class="token function">callback</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div></li></ul></li> <li><p>实现三：<strong>结合使用时间戳和定时器</strong></p> <ul><li><p>思想：时间戳方式第一次事件触发时候执行，在限流时间内再次触发用定时器延迟执行执行事件，如果在限流时间过后再次调用，清除定时时间事件</p></li> <li><p>优点： 第一次触发事件和最后一次触发事件都会执行</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/*
 * @param {Function} callback  事件回调函数
 * @param {Number} time  延迟执行时间
 * @return function 闭包
 */</span>
<span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">callback<span class="token punctuation">,</span> time</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> pretime <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">let</span> timer <span class="token operator">=</span> <span class="token keyword">null</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> pretime <span class="token operator">&gt;</span> time<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//在限流时间后触发事件</span>
      <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span> <span class="token comment">//当限流时间过后并在定时时间到达之前再次触发事件，就清除定时事件</span>
      timer <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token comment">//清空定时器</span>
      pretime <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">callback</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span> <span class="token comment">//执行事件</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//如果在限流时间内触发事件并且定时为空(既定时事件不存在)，添加定时事件</span>
      timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">callback</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div></li></ul></li></ul> <h2 id="实现函数柯里化"><a href="#实现函数柯里化" class="header-anchor">#</a> 实现函数柯里化</h2> <ul><li><p>概念: 用于创建已经设置好了一个或多个参数的函数,将多参数函数转变成单参数函数</p></li> <li><p>思想: 通过收集传入被柯里化函数fn的参数(n1,n2,n3...),返回一个函数curry，该curry函数中将传入的被柯里化函数fn的参数(n1,n2,n3...)设置为默认参数,并接收fn函数的其余参数</p></li> <li><p>实现方式一：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/** 
 * 实现方法一
 * @param {Function} fn 被柯里化函数
 * @param  {any} args 柯里化默认参数
 */</span>
<span class="token keyword">function</span> <span class="token function">currying</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//参数个数大于需要被柯里化的函数参数个数或则参数收集完毕,直接调用被柯里化的函数fn并传入参数</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>length <span class="token operator">&gt;=</span> fn<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">//如果参数个数小于被柯里化的函数参数个数,则递归调用fn,继续收集fn的参数</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">currying</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">,</span> <span class="token operator">...</span>args2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></li> <li><p>实现方式二：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/**
 * 实现方法二
 * @param {Function} fn 被柯里化函数
 * @param  {any} args 柯里化默认参数
 */</span>
<span class="token keyword">function</span> <span class="token function">curring</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> _this <span class="token operator">=</span> <span class="token keyword">this</span> <span class="token comment">//保存当前作用域</span>
  <span class="token keyword">let</span> args <span class="token operator">=</span> args <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">let</span> len <span class="token operator">=</span> fn<span class="token punctuation">.</span>length <span class="token comment">//获取函数参数长度</span>
  <span class="token comment">//返回柯里化函数</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//获取柯里化函数参数</span>
    <span class="token keyword">let</span> _args <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span>
    <span class="token comment">//收集柯里化函数参数(将新传入的参数push进入之前传入的默认参数中)</span>
    <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>args<span class="token punctuation">,</span> _args<span class="token punctuation">)</span>
    <span class="token comment">//如果参数个数小于fn函数需要的参数个数,则柯里化函数递归继续收集参数</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_args<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> len<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">curring</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>_this<span class="token punctuation">,</span> fn<span class="token punctuation">,</span> _args<span class="token punctuation">)</span> <span class="token comment">//注意使用call修改作用域,将新的参数传入</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">//否则参数收集完毕,调用函数fn</span>
      <span class="token keyword">return</span> <span class="token function">curring</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> _args<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div></li> <li><p>柯里化函数使用:</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//定义打印函数</span>
<span class="token keyword">function</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token parameter">param1<span class="token punctuation">,</span> param2<span class="token punctuation">,</span> param3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">param1 is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>param1<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, param2 is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>param2<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, param3 is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>param3<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//进行打印柯里化,传入一个默认参数:1,返回curryingFun函数,该函数设置1为print函数的默认参数,并接收其余参数</span>
<span class="token keyword">const</span> curryingFun <span class="token operator">=</span> <span class="token function">currying</span><span class="token punctuation">(</span>print<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment">//调用柯里化后的打印函数,传入打印函数其余参数</span>
<span class="token function">curryingFun</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">//输出param1 is 1, param2 is 2, param3 is 3</span>
<span class="token comment">//注意: 如果curryingFun函数参数个数小于print函数的参数,将返回curring函数,继续收集其余参数</span>
<span class="token function">curryingFun</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// 输出函数(...args2) =&gt; currying(fn, ...args, ...args2)</span>
<span class="token comment">//进行打印柯里化,传入一个默认参数:4,5</span>
<span class="token keyword">const</span> curryingFun2 <span class="token operator">=</span> <span class="token function">currying</span><span class="token punctuation">(</span>print<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token comment">//注意:该写法等价于curryingFun2 = currying(print)(4,5) </span>
<span class="token function">curryingFun2</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token comment">//输出param1 is 4, param2 is 5, param3 is 6</span>
<span class="token comment">//传入打印函数柯里化后的函数的参数大于打印函数的函数的参数个数时,多余参数将被忽略</span>
<span class="token function">curryingFun2</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token comment">//输出param1 is 4, param2 is 5, param3 is 6</span>

<span class="token comment">/**
 * currying(print)(4)(5) 与 currying(print)(4,5) 区别：
 * currying(print)(4)(5) 会递归两次,收集两次函数的默认参数
 * currying(print)(4,5)  会递归一次,收集一次函数的默认参数
 */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div></li></ul> <h2 id="柯里化函数题目"><a href="#柯里化函数题目" class="header-anchor">#</a> 柯里化函数题目</h2> <ul><li><p>题目一：</p> <blockquote><p>实现一个add方法，使计算结果能够满足如下预期：</p> <p>add(1)(2)(3) = 6;</p> <p>add(1, 2, 3)(4) = 10;</p> <p>add(1)(2)(3)(4)(5) = 15;</p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//保存第一次传入的参数</span>
  <span class="token keyword">let</span> _args <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span>

  <span class="token comment">//返回闭包来收集将第二次以后执行的参数</span>
  <span class="token keyword">let</span> <span class="token function-variable function">_adder</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    _args<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">...</span>arguments<span class="token punctuation">)</span>
    <span class="token keyword">return</span> _adder
  <span class="token punctuation">}</span>
  <span class="token comment">//重写toString方法,返回参数相加结果</span>
  _adder<span class="token punctuation">.</span><span class="token function-variable function">toString</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> _args<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> a <span class="token operator">+</span> b
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> _adder
<span class="token punctuation">}</span>

<span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>                <span class="token comment">// 6</span>
<span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>             <span class="token comment">// 10</span>
<span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>          <span class="token comment">// 15</span>
<span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>                <span class="token comment">// 9</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div></li></ul> <h2 id="实现图片懒加载"><a href="#实现图片懒加载" class="header-anchor">#</a> 实现图片懒加载</h2> <ul><li><p>html: 加载loading图片是在html部分就实现的.</p> <p><img src="/myblog/assets/img/lanjiazai2.d9865c37.png" alt=""></p></li> <li><p>javascript:</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// onload是等所有的资源文件加载完毕以后再绑定事件</span>
window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 获取图片列表，即img标签列表</span>
	<span class="token keyword">var</span> imgs <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 获取到浏览器顶部的距离</span>
	<span class="token keyword">function</span> <span class="token function">getTop</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> e<span class="token punctuation">.</span>offsetTop<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// 懒加载实现</span>
	<span class="token keyword">function</span> <span class="token function">lazyload</span><span class="token punctuation">(</span><span class="token parameter">imgs</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">// 可视区域高度</span>
		<span class="token keyword">var</span> h <span class="token operator">=</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">;</span>
		<span class="token comment">//滚动区域高度</span>
		<span class="token keyword">var</span> s <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollTop <span class="token operator">||</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>scrollTop<span class="token punctuation">;</span>
		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>imgs<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token comment">//图片距离顶部的距离大于可视区域和滚动区域之和时懒加载</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>h<span class="token operator">+</span>s<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token function">getTop</span><span class="token punctuation">(</span>imgs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">// 真实情况是页面开始有2秒空白，所以使用setTimeout定时2s</span>
				<span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">i</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
					<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
						<span class="token comment">// 不加立即执行函数i会等于9</span>
						<span class="token comment">// 隐形加载图片或其他资源，</span>
						<span class="token comment">//创建一个临时图片，这个图片在内存中不会到页面上去。实现隐形加载</span>
						<span class="token keyword">var</span> temp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						temp<span class="token punctuation">.</span>src <span class="token operator">=</span> imgs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'data-src'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//只会请求一次</span>
						<span class="token comment">// onload判断图片加载完毕，真是图片加载完毕，再赋值给dom节点</span>
						temp<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
							<span class="token comment">// 获取自定义属性data-src，用真图片替换假图片</span>
							imgs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>src <span class="token operator">=</span> imgs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'data-src'</span><span class="token punctuation">)</span>
						<span class="token punctuation">}</span>
					<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">)</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token function">lazyload</span><span class="token punctuation">(</span>imgs<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 滚屏函数</span>
	window<span class="token punctuation">.</span><span class="token function-variable function">onscroll</span> <span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">lazyload</span><span class="token punctuation">(</span>imgs<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div></li></ul> <h2 id="实现-jsonp"><a href="#实现-jsonp" class="header-anchor">#</a> 实现 JSONP</h2> <ul><li><p>实现步骤：</p> <ul><li><p>1.将传入的data数据转化为url字符串形式</p></li> <li><p>2.处理url中的回调函数</p></li> <li><p>3.创建一个script标签并插入到页面中</p></li> <li><p>4.挂载回调函数</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">window<span class="token punctuation">,</span> document</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token string">&quot;use strict&quot;</span>
  <span class="token keyword">var</span> <span class="token function-variable function">jsonp</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> data<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1.将传入的data数据转化为url字符串形式</span>
    <span class="token comment">// {id:1,name:'jack'} =&gt; id=1&amp;name=jack</span>
    <span class="token keyword">var</span> dataString <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">indexof</span><span class="token punctuation">(</span><span class="token string">'?'</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">?</span> <span class="token string">'?'</span> <span class="token operator">:</span> <span class="token string">'&amp;'</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      dataString <span class="token operator">+=</span> key <span class="token operator">+</span> <span class="token string">'='</span> <span class="token operator">+</span> data<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'&amp;'</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 2 处理url中的回调函数</span>
    <span class="token comment">// cbFuncName回调函数的名字 ：my_json_cb_名字的前缀 + 随机数（把小数点去掉）</span>
    <span class="token keyword">var</span> cbFuncName <span class="token operator">=</span> <span class="token string">'my_json_cb_'</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
    dataString <span class="token operator">+=</span> <span class="token string">'callback='</span> <span class="token operator">+</span> cbFuncName
    <span class="token comment">// 3.创建一个script标签并插入到页面中</span>
    <span class="token keyword">var</span> scriptEle <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span>
    scriptEle<span class="token punctuation">.</span>src <span class="token operator">=</span> url <span class="token operator">+</span> dataString
    <span class="token comment">// 4.挂载回调函数</span>
    window<span class="token punctuation">[</span>cbFuncName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">callback</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
      <span class="token comment">// 处理完回调函数的数据之后，删除jsonp的script标签</span>
      document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>scriptEle<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>scriptEle<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  window<span class="token punctuation">.</span>$jsonp <span class="token operator">=</span> jsonp
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span> document<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div></li></ul></li></ul> <h2 id="实现单例模式"><a href="#实现单例模式" class="header-anchor">#</a> 实现单例模式</h2> <ul><li><p>概念：单例模式涉及到一个单一的类，该类负责创建自己的对象，同时确保只有单个对象被创建，这个类提供了一种访问其唯一的对象的方式，可以直接访问，不需要实例化该类的对象</p></li> <li><p>要点：</p> <ul><li>1、单例类只能有一个实例；</li> <li>2、单例类必须自己创建自己的唯一实例；</li> <li>3、单例类必须给所有其他对象提供这一实例</li></ul></li> <li><p>实现：通过闭包保存对象实例的变量，每次新建/获取实例时候，判断该变量是否为空，为空则新建实例对象并返回，否则直接返回该实例</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> <span class="token function-variable function">Singleton</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>params <span class="token operator">=</span> params
<span class="token punctuation">}</span>

<span class="token class-name">Singleton</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getParams</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>params
<span class="token punctuation">}</span>

<span class="token class-name">Singleton</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>getInstance <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">let</span> instance <span class="token operator">=</span> <span class="token keyword">null</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>instance<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> instance
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
      instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">//---------------使用--------------</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> Singleton<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">'ConardLi'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> Singleton<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">'ConardLi2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token operator">===</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div></li></ul> <h2 id="观察者模式"><a href="#观察者模式" class="header-anchor">#</a> 观察者模式</h2> <ul><li><p>定义：指多个对象间存在一对多的依赖关系，当一个对象的状态发生改变时，所有依赖于它的对象都得到通知并被自动更新。</p></li> <li><p>优点：</p> <ul><li>降低了目标与观察者之间的耦合关系，两者之间是抽象耦合关系。符合依赖倒置原则。</li> <li>目标与观察者之间建立了一套触发机。</li></ul></li> <li><p>缺点：</p> <ul><li>目标与观察者之间的依赖关系并没有完全解除，而且有可能出现循环引用。</li> <li>当观察者对象很多时，通知的发布会花费很多时间，影响程序的效率。</li></ul></li> <li><p>结构：</p></li></ul> <p>​	实现观察者模式时要注意具体目标对象和具体观察者对象之间不能直接调用，否则将使两者之间紧密耦合起来，这违反了面向对象的设计原则。</p> <p>观察者模式的主要角色:</p> <ol><li>抽象主题（Subject）角色：也叫抽象目标类，它提供了一个用于保存观察者对象的聚集类和增加、删除观察者对象的方法，以及通知所有观察者的抽象方法。</li> <li>具体主题（Concrete Subject）角色：也叫具体目标类，它实现抽象目标中的通知方法，当具体主题的内部状态发生改变时，通知所有注册过的观察者对象。</li> <li>抽象观察者（Observer）角色：它是一个抽象类或接口，它包含了一个更新自己的抽象方法，当接到具体主题的更改通知时被调用。</li> <li>具体观察者（Concrete Observer）角色：实现抽象观察者中定义的抽象方法，以便在得到目标的更改通知时更新自身的状态。</li></ol> <p>观察者模式结构图：</p> <p><img src="/myblog/assets/img/观察者模式结构图.4ad3e0b3.png" alt=""></p> <p>观察者模式：</p> <p><img src="data:image/png;base64,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" alt=""></p> <h3 id="通用实现"><a href="#通用实现" class="header-anchor">#</a> 通用实现</h3> <p>ObserverList 实现：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">ObserverList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//观察者队列，保存观察者对象</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>observerList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 
<span class="token class-name">ObserverList</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">obj</span> <span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//添加观察者</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>observerList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span> obj <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token class-name">ObserverList</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">count</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//观察者数量</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>observerList<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token class-name">ObserverList</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">get</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">index</span> <span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//获取观察者</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span> index <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> index <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>observerList<span class="token punctuation">.</span>length <span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>observerList<span class="token punctuation">[</span> index <span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
  
<span class="token class-name">ObserverList</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">indexOf</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">obj<span class="token punctuation">,</span> startIndex</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment">//获取观察者位置</span>
  <span class="token keyword">let</span> i <span class="token operator">=</span> startIndex<span class="token punctuation">;</span>
  <span class="token keyword">while</span><span class="token punctuation">(</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>observerList<span class="token punctuation">.</span>length <span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token keyword">this</span><span class="token punctuation">.</span>observerList<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">===</span> obj <span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> i<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    i<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
 
  <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token class-name">ObserverList</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">removeAt</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">index</span> <span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//移除观察者</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>observerList<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span> index<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p>Subject对象 实现</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Subject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
  <span class="token keyword">this</span><span class="token punctuation">.</span>observers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObserverList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 
<span class="token class-name">Subject</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">addObserver</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">observer</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span> observer <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token class-name">Subject</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">removeObserver</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">observer</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">removeAt</span><span class="token punctuation">(</span> <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span> observer<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token class-name">Subject</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">notify</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">context</span> <span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//通知观察者变更</span>
  <span class="token keyword">let</span> observerCount <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> observerCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span> context <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>Observer对象实现</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Observer</span> <span class="token punctuation">(</span> data <span class="token operator">=</span> <span class="token string">''</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>data <span class="token operator">=</span> data
    <span class="token class-name">Observer</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">update</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">更新数据: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>测试结果</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> subject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Subject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> observer1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Observer</span><span class="token punctuation">(</span><span class="token string">'im observer1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> observer2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Observer</span><span class="token punctuation">(</span><span class="token string">'im observer2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> observer3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Observer</span><span class="token punctuation">(</span><span class="token string">'im observer3'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

subject<span class="token punctuation">.</span><span class="token function">addObserver</span><span class="token punctuation">(</span>observer1<span class="token punctuation">)</span><span class="token punctuation">;</span>
subject<span class="token punctuation">.</span><span class="token function">addObserver</span><span class="token punctuation">(</span>observer2<span class="token punctuation">)</span><span class="token punctuation">;</span>
subject<span class="token punctuation">.</span><span class="token function">addObserver</span><span class="token punctuation">(</span>observer3<span class="token punctuation">)</span><span class="token punctuation">;</span>
subject<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 输出结果：</span>
<span class="token comment">// 更新数据: im observer1</span>
<span class="token comment">// 更新数据: im observer2</span>
<span class="token comment">// 更新数据: im observer3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="defineproperty-实现"><a href="#defineproperty-实现" class="header-anchor">#</a> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty" target="_blank" rel="noopener noreferrer">defineProperty<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 实现</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Sewend'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">26</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//循环遍历观察对象属性</span>
  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>person<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">enumerable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'get data:'</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">newVal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 当属性值发生变化时我们可以进行额外操作</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">set new value </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>newVal<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

person<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'my blog'</span><span class="token punctuation">;</span>
<span class="token comment">//输出：set new value my blog</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="proxy实现"><a href="#proxy实现" class="header-anchor">#</a> <a href="https://es6.ruanyifeng.com/#docs/proxy" target="_blank" rel="noopener noreferrer">Proxy<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>实现</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> observerList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//观察者队列</span>
<span class="token keyword">const</span> <span class="token function-variable function">subject</span> <span class="token operator">=</span> <span class="token parameter">fn</span> <span class="token operator">=&gt;</span> observerList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//订阅观察者对象</span>
<span class="token keyword">const</span> <span class="token function-variable function">observable</span> <span class="token operator">=</span> <span class="token parameter">obj</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token punctuation">{</span>  <span class="token comment">//可观察对象</span>
  	<span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> receiver</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> result <span class="token operator">=</span> Reflect<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span><span class="token punctuation">;</span>
      observerList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">observer</span> <span class="token operator">=&gt;</span> <span class="token function">observer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//通知观察者队列所有观察者更新数据</span>
      <span class="token keyword">return</span> result<span class="token punctuation">;</span>
	<span class="token punctuation">}</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token function">observable</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Sewend'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">26</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">update: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>person<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>person<span class="token punctuation">.</span>age<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">subject</span><span class="token punctuation">(</span>update<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//测试</span>
person<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">25</span>
<span class="token comment">//输出 update: Sewend, 25</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h2 id="发布订阅者模式"><a href="#发布订阅者模式" class="header-anchor">#</a> 发布订阅者模式</h2> <ul><li>定义:</li></ul> <p>发布订阅者模式（Publish/Subscribe），事件的发布者只发布事件，不关心这个事件被谁获取了，通常将事件发给一个中间件，由中间件再去分发事件</p> <p>事件的订阅者只关心事件本身，不关心这个事件是谁发布的，通常在中间件中去注册观察某个事件。</p> <p>中间件中去维护事件类别对应的订阅者列表，当收到事件后，去对应列表中通知订阅者</p> <ul><li>结构</li></ul> <p><img src="data:image/png;base64,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" alt=""></p> <ul><li>实现</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> Observer <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> topics <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// 回调函数存放的数组</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token comment">// 订阅方法,将订阅者注册的消息推入到消息队列中，因此我们需要接受两个参数：消息类型以及相应的处理动作</span>
        <span class="token function-variable function">subscribe</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>topics<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 如果此消息不存在则创建</span>
                topics<span class="token punctuation">[</span>type<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            topics<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 将动作推入到该消息对应的动作执行序列中</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// 发布方法,当观察者发布一个消息时将所有订阅者订阅的消息一次执行。因此应接受两个参数：消息类型以及动作执行时需要传递的参数</span>
        <span class="token function-variable function">publish</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>topics<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// 如果该消息没有被注册，则返回</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">let</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
            <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">let</span> subscribers <span class="token operator">=</span> topics<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">,</span> len <span class="token operator">=</span> subscribers <span class="token operator">?</span> subscribers<span class="token punctuation">.</span>length<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    subscribers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 依次执行注册的消息对应的动作序列</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// 取消订阅方法,将订阅者注销的消息从消息队列中清除，因此应接受两个参数：消息类型以及执行的某一动作。</span>
        <span class="token function-variable function">unsubscribe</span><span class="token operator">:</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> subscribers <span class="token operator">=</span> topics<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>subscribers <span class="token keyword">instanceof</span> <span class="token class-name">Array</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 判断是否存在</span>
                <span class="token keyword">let</span> i <span class="token operator">=</span> subscribers<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span>i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">// 如果存在该动作则在消息动作序列中移除响应动作</span>
                    subscribers<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">===</span> fn <span class="token operator">&amp;&amp;</span> subscribers<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//-----------测试--------------------</span>

<span class="token keyword">var</span> <span class="token function-variable function">listener1</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'listener1:'</span> <span class="token operator">+</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> <span class="token function-variable function">listener2</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'listener2:'</span> <span class="token operator">+</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
Observer<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token string">'example1'</span><span class="token punctuation">,</span> listener1<span class="token punctuation">)</span><span class="token punctuation">;</span>
Observer<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token string">'example1'</span><span class="token punctuation">,</span> listener2<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">//发布通知</span>
Observer<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token string">'example1'</span><span class="token punctuation">,</span> <span class="token string">'hello world!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Observer<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token string">'example1'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'test'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//----结果-----</span>
<span class="token literal-property property">listener1</span><span class="token operator">:</span>hello world<span class="token operator">!</span>
<span class="token literal-property property">listener2</span><span class="token operator">:</span>hello world<span class="token operator">!</span>
<span class="token literal-property property">listener1</span><span class="token operator">:</span>test<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c
<span class="token literal-property property">listener2</span><span class="token operator">:</span>test<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br></div></div><h2 id="实现generator"><a href="#实现generator" class="header-anchor">#</a> 实现Generator</h2> <ul><li><p><a href="https://es6.ruanyifeng.com/#docs/generator" target="_blank" rel="noopener noreferrer">Generator<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>使用示例:</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">yield</span> <span class="token string">'result1'</span>
 <span class="token keyword">yield</span> <span class="token string">'result2'</span>
 <span class="token keyword">yield</span> <span class="token string">'result3'</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> gen <span class="token operator">=</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>gen<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>gen<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>gen<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li> <li><p>根据示例模式实现:</p> <ul><li><p>原理：Generator实现的核心在于上下文的保存，函数并没有真的被挂起，每一次yield，其实都执行了一遍传入的生成器函数，只是在这个过程中间用了一个context对象储存上下文，使得每次执行生成器函数的时候，都可以从上一个执行结果开始执行，看起来就像函数被挂起了一样</p></li> <li><p><a href="https://juejin.im/post/5bd85cfbf265da0a9e535c10" target="_blank" rel="noopener noreferrer">源码参考<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/**
 * 生成器函数根据yield语句将代码分割为switch-case块，后续通过切换_context.prev和_context.next来分别执行各个case
 */</span> 
<span class="token keyword">function</span> <span class="token function">gen$</span><span class="token punctuation">(</span><span class="token parameter">_context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>_context<span class="token punctuation">.</span>prev <span class="token operator">=</span> _context<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
        _context<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">'result1'</span><span class="token punctuation">;</span>

      <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
        _context<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">'result2'</span><span class="token punctuation">;</span>

      <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span>
        _context<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">'result3'</span><span class="token punctuation">;</span>

      <span class="token keyword">case</span> <span class="token number">6</span><span class="token operator">:</span>
      <span class="token keyword">case</span> <span class="token string">&quot;end&quot;</span><span class="token operator">:</span>
        <span class="token keyword">return</span> _context<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// context 用于储存函数执行上下文</span>
<span class="token keyword">var</span> context <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">next</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token literal-property property">prev</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token literal-property property">done</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token function-variable function">stop</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>done <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * invoke 定义next()，用于执行gen$(_context)来跳到下一步
 * 当我们调用g.next()，就相当于调用invoke()方法
 */</span>
<span class="token keyword">let</span> <span class="token function-variable function">gen</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">next</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      value <span class="token operator">=</span> context<span class="token punctuation">.</span>done <span class="token operator">?</span> <span class="token keyword">undefined</span> <span class="token operator">:</span> <span class="token function">gen$</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>
      done <span class="token operator">=</span> context<span class="token punctuation">.</span>done
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        value<span class="token punctuation">,</span>
        done
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 测试使用</span>
<span class="token keyword">var</span> g <span class="token operator">=</span> <span class="token function">gen</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
g<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// {value: &quot;result1&quot;, done: false}</span>
g<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// {value: &quot;result2&quot;, done: false}</span>
g<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// {value: &quot;result3&quot;, done: false}</span>
g<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// {value: undefined, done: true}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br></div></div></li></ul></li></ul> <h2 id="实现-async-await"><a href="#实现-async-await" class="header-anchor">#</a> 实现 async await</h2> <ul><li><p>async 函数的实现原理，就是将 Generator 函数和自动执行器，包装在一个函数里</p></li> <li><p>实现一：<a href="https://es6.ruanyifeng.com/#docs/async#async-%E5%87%BD%E6%95%B0%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86" target="_blank" rel="noopener noreferrer">《ES6 教程》中实现<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token comment">// 等同于</span>

<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">spawn</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// spawn 方法实现</span>
<span class="token keyword">function</span> <span class="token function">spawn</span><span class="token punctuation">(</span><span class="token parameter">genF</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> gen <span class="token operator">=</span> <span class="token function">genF</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">step</span><span class="token punctuation">(</span><span class="token parameter">nextF</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> next<span class="token punctuation">;</span>
      <span class="token keyword">try</span> <span class="token punctuation">{</span>
        next <span class="token operator">=</span> <span class="token function">nextF</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>next<span class="token punctuation">.</span>done<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">resolve</span><span class="token punctuation">(</span>next<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>next<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">step</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> gen<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">step</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> gen<span class="token punctuation">.</span><span class="token function">throw</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">step</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> gen<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><ul><li>所有的<code>async</code>函数都可以写成上面的第二种形式，其中的<code>spawn</code>函数就是自动执行器</li></ul></li> <li><p>实现二：</p></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">asyncToGenerator</span><span class="token punctuation">(</span><span class="token parameter">generatorFunc</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 返回的是一个新的函数</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment">// 先调用generator函数 生成迭代器</span>
    <span class="token comment">// 对应 var gen = testG()</span>
    <span class="token keyword">const</span> gen <span class="token operator">=</span> <span class="token function">generatorFunc</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span>

    <span class="token comment">// 返回一个promise 因为外部是用.then的方式 或者await的方式去使用这个函数的返回值的</span>
    <span class="token comment">// var test = asyncToGenerator(testG)</span>
    <span class="token comment">// test().then(res =&gt; console.log(res))</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

      <span class="token comment">// 内部定义一个step函数 用来一步一步的跨过yield的阻碍</span>
      <span class="token comment">// key有next和throw两种取值，分别对应了gen的next和throw方法</span>
      <span class="token comment">// arg参数则是用来把promise resolve出来的值交给下一个yield</span>
      <span class="token keyword">function</span> <span class="token function">step</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> generatorResult

        <span class="token comment">// 这个方法需要包裹在try catch中</span>
        <span class="token comment">// 如果报错了 就把promise给reject掉 外部通过.catch可以获取到错误</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
          generatorResult <span class="token operator">=</span> gen<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// gen.next() 得到的结果是一个 { value, done } 的结构</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span> value<span class="token punctuation">,</span> done <span class="token punctuation">}</span> <span class="token operator">=</span> generatorResult

        <span class="token keyword">if</span> <span class="token punctuation">(</span>done<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 如果已经完成了 就直接resolve这个promise</span>
          <span class="token comment">// 这个done是在最后一次调用next后才会为true</span>
          <span class="token comment">// 以本文的例子来说 此时的结果是 { done: true, value: 'success' }</span>
          <span class="token comment">// 这个value也就是generator函数最后的返回值</span>
          <span class="token keyword">return</span> <span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token comment">// 除了最后结束的时候外，每次调用gen.next()</span>
          <span class="token comment">// 其实是返回 { value: Promise, done: false } 的结构，</span>
          <span class="token comment">// 这里要注意的是Promise.resolve可以接受一个promise为参数</span>
          <span class="token comment">// 并且这个promise参数被resolve的时候，这个then才会被调用</span>
          <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>
            <span class="token comment">// 这个value对应的是yield后面的promise</span>
            value
          <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
            <span class="token comment">// value这个promise被resove的时候，就会执行next</span>
            <span class="token comment">// 并且只要done不是true的时候 就会递归的往下解开promise</span>
            <span class="token comment">// 对应gen.next().value.then(value =&gt; {</span>
            <span class="token comment">//    gen.next(value).value.then(value2 =&gt; {</span>
            <span class="token comment">//       gen.next() </span>
            <span class="token comment">//</span>
            <span class="token comment">//      // 此时done为true了 整个promise被resolve了 </span>
            <span class="token comment">//      // 最外部的test().then(res =&gt; console.log(res))的then就开始执行了</span>
            <span class="token comment">//    })</span>
            <span class="token comment">// })</span>
            <span class="token keyword">function</span> <span class="token function">onResolve</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token function">step</span><span class="token punctuation">(</span><span class="token string">&quot;next&quot;</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token comment">// 如果promise被reject了 就再次进入step函数</span>
            <span class="token comment">// 不同的是，这次的try catch中调用的是gen.throw(err)</span>
            <span class="token comment">// 那么自然就被catch到 然后把promise给reject掉啦</span>
            <span class="token keyword">function</span> <span class="token function">onReject</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token function">step</span><span class="token punctuation">(</span><span class="token string">&quot;throw&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token function">step</span><span class="token punctuation">(</span><span class="token string">&quot;next&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br></div></div><ul><li>参考来源：[《手写async await的最简实现（20行）》](</li></ul></div> <!----> <div class="content__content-bottom"></div> <footer class="page-meta"><!----> <div class="meta-item update-time"><span class="label">Last update:</span> <span class="info">March 20, 2024 20:28</span></div> <div class="meta-item contributors"><span class="label">Contributors: </span> <span class="info"><span title="email: 596777598@qq.com" class="contributor">
          sewar
        </span> <!----></span></div></footer> <!----> <!----> <!----> <div class="content__page-bottom"></div></main> <!----></div><div class="global-ui"><!----><div id="pwa-install"><!----> <div id="install-modal-wrapper" style="display:none;"><div class="background"></div> <div class="install-modal"><div class="header"><button aria-label="Close" class="close-button"><svg width="23" height="22" xmlns="http://www.w3.org/2000/svg" class="icon close-icon"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.12.358a1.224 1.224 0 011.729 0l8.92 8.914L20.686.358a1.224 1.224 0 011.73 1.728L13.497 11l8.92 8.913a1.222 1.222 0 11-1.73 1.729l-8.919-8.913-8.92 8.913a1.224 1.224 0 01-1.729-1.729L10.04 11l-8.92-8.914a1.222 1.222 0 010-1.728z" fill="currentColor"></path></svg></button> <div class="logo"><!----> <div class="title"><h1></h1> <p class="desc">This app can be installed on your PC or mobile device.  This will allow this web app to look and behave like any other installed app.  You will find it in your app lists and be able to pin it to your home screen, start menus or task bars.  This installed web app will also be able to safely interact with other apps and your operating system. </p></div></div></div> <div class="content"><div class="highlight"><!----> <!----></div> <div class="description"><h3>Description</h3> <p></p></div></div> <div class="button-wrapper"><button class="install-button">
        Install <span></span></button> <button class="cancel-button">
        Cancel
      </button></div></div></div></div><!----><div tabindex="-1" role="dialog" aria-hidden="true" class="pswp"><div class="pswp__bg"></div> <div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div> <div class="pswp__item"></div> <div class="pswp__item"></div></div> <div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div> <button title="Close" aria-label="Close" class="pswp__button pswp__button--close"></button> <button title="Share" aria-label="Share" class="pswp__button pswp__button--share"></button> <button title="Switch to full screen" aria-label="Switch to full screen" class="pswp__button pswp__button--fs"></button> <button title="Zoom in/out" aria-label="Zoom in/out" class="pswp__button pswp__button--zoom"></button> <div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div> <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div> <button title="Prev (Arrow Left)" aria-label="Prev (Arrow Left)" class="pswp__button pswp__button--arrow--left"></button> <button title="Next (Arrow Right)" aria-label="Next (Arrow Right)" class="pswp__button pswp__button--arrow--right"></button> <div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div></div></div>
    <script src="/myblog/assets/js/app.9d2b617a.js" defer></script><script src="/myblog/assets/js/layout-Layout.d2d4ce64.js" defer></script><script src="/myblog/assets/js/page-JS原理实现.3c427e19.js" defer></script><script src="/myblog/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound~layout-components/Blog/BlogHome~layout-components/~2222f443.5835591a.js" defer></script>
  </body>
</html>
