<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前端性能优化方案 | Sewen 博客</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="./mylogo.png">
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
    <link rel="manifest" href="/myblog/manifest.webmanifest" crossorigin="use-credentials">
    <link rel="alternate" type="application/atom+xml" href="https://sewar-x.github.io/myblog/atom.xml" title="Sewen 博客 Atom Feed">
    <link rel="alternate" type="application/json" href="https://sewar-x.github.io/myblog/rss.xml" title="Sewen 博客 JSON Feed">
    <link rel="alternate" type="application/rss+xml" href="https://sewar-x.github.io/myblog/rss.xml" title="Sewen 博客 RSS Feed">
    <meta name="description" content="sewen 的前端学习笔记、博客、前端基础总结、技术深度剖析、面试题总结、算法总结、项目过程总结">
    <meta property="og:url" content="https://sewar-x.github.io/myblog/performance/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88.html">
    <meta property="og:site_name" content="Sewen 博客">
    <meta property="og:title" content="前端性能优化方案">
    <meta property="og:type" content="article">
    <meta property="og:locale" content="en-US">
    <meta name="theme-color" content="#46bd87">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <link rel="preload" href="/myblog/assets/css/0.styles.645fbc6f.css" as="style"><link rel="preload" href="/myblog/assets/js/app.9d2b617a.js" as="script"><link rel="preload" href="/myblog/assets/js/layout-Layout.d2d4ce64.js" as="script"><link rel="preload" href="/myblog/assets/js/page-前端性能优化方案.83718d22.js" as="script"><link rel="preload" href="/myblog/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound~layout-components/Blog/BlogHome~layout-components/~2222f443.5835591a.js" as="script"><link rel="prefetch" href="/myblog/assets/js/199.a9216960.js"><link rel="prefetch" href="/myblog/assets/js/200.4c66fc79.js"><link rel="prefetch" href="/myblog/assets/js/layout-Blog.1fca7e90.js"><link rel="prefetch" href="/myblog/assets/js/layout-NotFound.3c74e8aa.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/AlgoliaSearch/Dropdown.70fcebe7.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Anchor.3235541c.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/ArticleInfo.7b815b20.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/ArticleItem.b0e177e1.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/ArticleList.d1cf1b24.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/ArticleType.b630b80e.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/BlogHero.621312ba.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/BlogHome.4fe44489.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/BlogInfo.b2a94760.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/BlogPage.e0fbe820.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/BloggerInfo.0df38355.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/CategoryList.ec1bcd96.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/ProjectList.8550a110.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/TagList.bcf7b782.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/Timeline.b6cf5471.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Blog/TimelineList.3c6e08a6.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Clipboard.e940a903.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Common.820a8694.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Home.70383986.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/MyTransition.0de46069.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Navbar/DropdownLink.e3f6c118.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Navbar/NavLink.93b11770.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Navbar/NavLinks.8ba214e6.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Navbar/Navbar.b90a94f9.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Navbar/RepoLink.663a7f55.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Navbar/SidebarButton.76b0035a.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Page.98b5d09c.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/PageFooter.20bc9bd8.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/PageMeta.b7e6b12f.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/PageNav.8305dd1f.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Password.45e0e82a.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Sidebar/DropdownTransition.068c5eea.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Sidebar/Sidebar.f6f90d52.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Sidebar/SidebarDropdownLink.505127a8.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Sidebar/SidebarGroup.7eecf370.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Sidebar/SidebarLink.6e39fe32.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Sidebar/SidebarNavLinks.0f8566cb.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Theme/DarkmodeSwitch.20ac7b92.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Theme/ThemeColor.6086e4ed.js"><link rel="prefetch" href="/myblog/assets/js/layout-components/Theme/ThemeOptions.483238c9.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/ArticleIcon.0a22e2b1.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/AutoIcon.2ff1c790.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/BookIcon.419b49ba.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/DarkIcon.7d81873b.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/EditIcon.8ada485d.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/EmptyIcon.d704a5cf.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/I18nIcon.ffad8b3e.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/LightIcon.47d807da.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/LinkIcon.1a8a7826.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/LockIcon.a29a2b79.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/NextIcon.0214ee59.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/Page404Icon.8bc1ebbb.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/PresentationIcon.17500d9b.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/PrevIcon.2ae04a70.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/ProjectIcon.b336d567.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/StickyIcon.0f509b9d.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Baidu.244b9a41.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Bitbucket.11ba94e1.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Dingding.e8a3d90d.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Discord.3295a55b.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Dribbble.464dac3b.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Email.f9254caa.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Evernote.991472fb.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Facebook.08e78e47.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Flipboard.a1124d0f.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Gitee.c44bc20a.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Github.5667e5ae.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Gitlab.ad95c7a7.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Gmail.b5acc6bc.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Instagram.56be85f2.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Lines.d9db3dce.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Linkedin.b82d8d8b.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Pinterest.0f3ffe71.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Pocket.41ef3c92.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/QQ.7558f4ba.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Qzone.bf658fae.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Reddit.9c4c95ee.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Rss.9780139e.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Steam.06abbae2.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Twitter.26fa5bda.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Wechat.9cac8c4c.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Weibo.5206a632.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Whatsapp.0738f1e3.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Youtube.f41fd7f2.js"><link rel="prefetch" href="/myblog/assets/js/layout-icons/media/Zhihu.4d851d2f.js"><link rel="prefetch" href="/myblog/assets/js/page--0abc50bf.0d6f1484.js"><link rel="prefetch" href="/myblog/assets/js/page--1cd40f4c.dd76c7b3.js"><link rel="prefetch" href="/myblog/assets/js/page--53f93199.e80bdec8.js"><link rel="prefetch" href="/myblog/assets/js/page--5afd2fd0.adea4e92.js"><link rel="prefetch" href="/myblog/assets/js/page--67c584d3.0a3f3cd9.js"><link rel="prefetch" href="/myblog/assets/js/page--776a8506.cdf48aac.js"><link rel="prefetch" href="/myblog/assets/js/page-CSS.eb94b29f.js"><link rel="prefetch" href="/myblog/assets/js/page-Chrome开发工具使用指南.a2675120.js"><link rel="prefetch" href="/myblog/assets/js/page-DevServer.0281863d.js"><link rel="prefetch" href="/myblog/assets/js/page-Echarts二次封装.4387b8ad.js"><link rel="prefetch" href="/myblog/assets/js/page-Elementui与Element-plusui二次封装.82f12a09.js"><link rel="prefetch" href="/myblog/assets/js/page-Git基础.03c616ad.js"><link rel="prefetch" href="/myblog/assets/js/page-Git规范.e2fdc38a.js"><link rel="prefetch" href="/myblog/assets/js/page-HTML.1e3c14b9.js"><link rel="prefetch" href="/myblog/assets/js/page-Home.f0b7e772.js"><link rel="prefetch" href="/myblog/assets/js/page-JSON配置化组件二次封装.12060fd9.js"><link rel="prefetch" href="/myblog/assets/js/page-JS原理实现.3c427e19.js"><link rel="prefetch" href="/myblog/assets/js/page-JS应用题.3d313b34.js"><link rel="prefetch" href="/myblog/assets/js/page-JavaScript基础.551be887.js"><link rel="prefetch" href="/myblog/assets/js/page-Linux.c6159ebd.js"><link rel="prefetch" href="/myblog/assets/js/page-Loader和Plugin原理.b2971b76.js"><link rel="prefetch" href="/myblog/assets/js/page-MySQL.0b1d704a.js"><link rel="prefetch" href="/myblog/assets/js/page-NPM.a55851b2.js"><link rel="prefetch" href="/myblog/assets/js/page-Node.ec405a21.js"><link rel="prefetch" href="/myblog/assets/js/page-Nodejs常见问题集合.12844e69.js"><link rel="prefetch" href="/myblog/assets/js/page-Node性能优化.b4ea1c34.js"><link rel="prefetch" href="/myblog/assets/js/page-Promise专题.7869a31b.js"><link rel="prefetch" href="/myblog/assets/js/page-React.d76cf0ac.js"><link rel="prefetch" href="/myblog/assets/js/page-SSG移动端项目实践.2122615b.js"><link rel="prefetch" href="/myblog/assets/js/page-TypeScript.4f597fda.js"><link rel="prefetch" href="/myblog/assets/js/page-Vite.637881bf.js"><link rel="prefetch" href="/myblog/assets/js/page-Vite原理解析.6677fdb4.js"><link rel="prefetch" href="/myblog/assets/js/page-Vue25项目webpack构建分析.7bbea0fa.js"><link rel="prefetch" href="/myblog/assets/js/page-Vue2VsVue3.10be4140.js"><link rel="prefetch" href="/myblog/assets/js/page-Vue2x原理源码分析.e9e753b6.js"><link rel="prefetch" href="/myblog/assets/js/page-Vue3基础.210247ff.js"><link rel="prefetch" href="/myblog/assets/js/page-Vue3源码分析.17379e04.js"><link rel="prefetch" href="/myblog/assets/js/page-VueCli源码分析.afc3c83f.js"><link rel="prefetch" href="/myblog/assets/js/page-VueRouter原理分析.0a092eb6.js"><link rel="prefetch" href="/myblog/assets/js/page-VueSSR原理分析.63006040.js"><link rel="prefetch" href="/myblog/assets/js/page-VueVsReact.2156be28.js"><link rel="prefetch" href="/myblog/assets/js/page-Vuex原理分析.5ba3e6e4.js"><link rel="prefetch" href="/myblog/assets/js/page-WEB安全.5aa0eeef.js"><link rel="prefetch" href="/myblog/assets/js/page-WebPack构建原理.9c29703e.js"><link rel="prefetch" href="/myblog/assets/js/page-webpackAPI分析.4c8b152b.js"><link rel="prefetch" href="/myblog/assets/js/page-webpack优化.dcc6c3bc.js"><link rel="prefetch" href="/myblog/assets/js/page-webpack基础.3820ee6c.js"><link rel="prefetch" href="/myblog/assets/js/page-webpack项目实践.77e22417.js"><link rel="prefetch" href="/myblog/assets/js/page-一次后台管理系统的性能优化.7c2d8712.js"><link rel="prefetch" href="/myblog/assets/js/page-从零到一搭建SSR项目.855376fc.js"><link rel="prefetch" href="/myblog/assets/js/page-从零到一搭建Vue2项目和规范设计.93017fd2.js"><link rel="prefetch" href="/myblog/assets/js/page-从零到一搭建Vue3单页面应用.de152d54.js"><link rel="prefetch" href="/myblog/assets/js/page-从零到一搭建公共组件库.93278073.js"><link rel="prefetch" href="/myblog/assets/js/page-从零到一搭建移动端SSG项目.9c113d06.js"><link rel="prefetch" href="/myblog/assets/js/page-使用docker部署Node服务.5cf328fd.js"><link rel="prefetch" href="/myblog/assets/js/page-分治.e3dfc22d.js"><link rel="prefetch" href="/myblog/assets/js/page-前端发版静态资源404问题.9eb1ca89.js"><link rel="prefetch" href="/myblog/assets/js/page-前端存储.cd82cf54.js"><link rel="prefetch" href="/myblog/assets/js/page-前端工程化.1e6e58d0.js"><link rel="prefetch" href="/myblog/assets/js/page-前端架构实践.171dbc0f.js"><link rel="prefetch" href="/myblog/assets/js/page-前端渲染架构.3b783de8.js"><link rel="prefetch" href="/myblog/assets/js/page-前端自动部署.5076846c.js"><link rel="prefetch" href="/myblog/assets/js/page-前端部署原理.82ecd8a7.js"><link rel="prefetch" href="/myblog/assets/js/page-动态规划.a3af92f1.js"><link rel="prefetch" href="/myblog/assets/js/page-哈希表.c76000e8.js"><link rel="prefetch" href="/myblog/assets/js/page-回溯算法.cd914c32.js"><link rel="prefetch" href="/myblog/assets/js/page-图.dfd9828a.js"><link rel="prefetch" href="/myblog/assets/js/page-基础.7bf5a37b.js"><link rel="prefetch" href="/myblog/assets/js/page-堆.4657e538.js"><link rel="prefetch" href="/myblog/assets/js/page-字符串.252f2a08.js"><link rel="prefetch" href="/myblog/assets/js/page-异步编程.904f4c65.js"><link rel="prefetch" href="/myblog/assets/js/page-性能优化指标和监控.f2175836.js"><link rel="prefetch" href="/myblog/assets/js/page-排序算法.c7a51b99.js"><link rel="prefetch" href="/myblog/assets/js/page-搭建低代码平台.19eaf5ec.js"><link rel="prefetch" href="/myblog/assets/js/page-操作系统.473c4281.js"><link rel="prefetch" href="/myblog/assets/js/page-数学运算.c82748fb.js"><link rel="prefetch" href="/myblog/assets/js/page-数据结构算法.84480586.js"><link rel="prefetch" href="/myblog/assets/js/page-数组.692b0d0a.js"><link rel="prefetch" href="/myblog/assets/js/page-权限管理.c7e10db0.js"><link rel="prefetch" href="/myblog/assets/js/page-查找.790e52df.js"><link rel="prefetch" href="/myblog/assets/js/page-栈和队列.8dbc3586.js"><link rel="prefetch" href="/myblog/assets/js/page-树.24efdeaa.js"><link rel="prefetch" href="/myblog/assets/js/page-浏览器.bee9ec04.js"><link rel="prefetch" href="/myblog/assets/js/page-混合桌面应用开发.9e10d1c3.js"><link rel="prefetch" href="/myblog/assets/js/page-登录.bb830451.js"><link rel="prefetch" href="/myblog/assets/js/page-目录.c85b4d0b.js"><link rel="prefetch" href="/myblog/assets/js/page-移动端开发.56ac22ec.js"><link rel="prefetch" href="/myblog/assets/js/page-组件和组件封装.b5e86da2.js"><link rel="prefetch" href="/myblog/assets/js/page-计算机网络基础.0a106662.js"><link rel="prefetch" href="/myblog/assets/js/page-设计模式.ffdc7cfd.js"><link rel="prefetch" href="/myblog/assets/js/page-调试技巧.485ae36e.js"><link rel="prefetch" href="/myblog/assets/js/page-贪心算法.0f417640.js"><link rel="prefetch" href="/myblog/assets/js/page-输入url到页面展示全过程.510aef2e.js"><link rel="prefetch" href="/myblog/assets/js/page-递归.5e55e552.js"><link rel="prefetch" href="/myblog/assets/js/page-链表.1cf6927f.js"><link rel="prefetch" href="/myblog/assets/js/page-项目总结.ffcd2a4b.js"><link rel="prefetch" href="/myblog/assets/js/vendors~docsearch.f3877d0d.js"><link rel="prefetch" href="/myblog/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound~layout-components/Blog/BlogHome~layout-components/~5d377965.d9712593.js"><link rel="prefetch" href="/myblog/assets/js/vendors~layout-Blog~layout-Layout~layout-components/Blog/ArticleItem~layout-components/Blog/ArticleL~b56f3aac.47bb5cb5.js"><link rel="prefetch" href="/myblog/assets/js/vendors~layout-NotFound~layout-components/Common~layout-components/Page.57d58db9.js"><link rel="prefetch" href="/myblog/assets/js/vendors~layout-Slide.81546b3b.js"><link rel="prefetch" href="/myblog/assets/js/vendors~layout-components/AlgoliaSearch/Full.b30f067a.js"><link rel="prefetch" href="/myblog/assets/js/vendors~layout-components/Blog/BlogPage.bcccbd38.js"><link rel="prefetch" href="/myblog/assets/js/vendors~layout-components/Navbar/Navbar.e2a7361e.js"><link rel="prefetch" href="/myblog/assets/js/vendors~layout-components/Page.6c65077c.js"><link rel="prefetch" href="/myblog/assets/js/vendors~layout-components/Sidebar/Sidebar.34cd9cf7.js"><link rel="prefetch" href="/myblog/assets/js/vendors~photo-swipe.428df1da.js">
    <link rel="stylesheet" href="/myblog/assets/css/0.styles.645fbc6f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container has-navbar has-anchor"><header class="navbar"><!----> <div class="content__navbar-start"></div> <button title="Sidebar Button" class="sidebar-button"><span class="icon"></span></button> <a href="/myblog/" class="home-link router-link-active"><img src="./mylogo.png" alt="Sewen 博客" class="logo"> <!----> <span class="site-name can-hide">Sewen 博客</span></a> <!----> <div class="content__navbar-center"></div> <div class="links"><button tabindex="-1" aria-hidden="true" class="color-button"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="skin-icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4
        38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32
        51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0
        102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2
        6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4
        0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2
        9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224
        419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4
        470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0
        22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6
        12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128
        505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2
        16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8
        86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4
        80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6
        6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg> <div class="color-picker-menu" style="display:none;"><div class="theme-options"><ul class="themecolor-select"><label for="themecolor-select">Theme Color:</label> <li><span class="default-theme"></span></li> </ul> <div class="darkmode-toggle"><label for="darkmode-toggle" class="desc">Theme Mode:</label> <div class="darkmode-switch"><div class="item day"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon light-icon"><path d="M512 256a42.667 42.667 0 0 0 42.667-42.667V128a42.667 42.667 0 0 0-85.334 0v85.333A42.667 42.667 0 0 0 512 256zm384 213.333h-85.333a42.667 42.667 0 0 0 0 85.334H896a42.667 42.667 0 0 0 0-85.334zM256 512a42.667 42.667 0 0 0-42.667-42.667H128a42.667 42.667 0 0 0 0 85.334h85.333A42.667 42.667 0 0 0 256 512zm9.387-298.667a42.667 42.667 0 0 0-59.307 62.72l61.44 59.307a42.667 42.667 0 0 0 31.147 11.947 42.667 42.667 0 0 0 30.72-13.227 42.667 42.667 0 0 0 0-60.16zm459.946 133.974a42.667 42.667 0 0 0 29.44-11.947l61.44-59.307a42.667 42.667 0 0 0-57.6-62.72l-61.44 60.587a42.667 42.667 0 0 0 0 60.16 42.667 42.667 0 0 0 28.16 13.227zM512 768a42.667 42.667 0 0 0-42.667 42.667V896a42.667 42.667 0 0 0 85.334 0v-85.333A42.667 42.667 0 0 0 512 768zm244.48-79.36a42.667 42.667 0 0 0-59.307 61.44l61.44 60.587a42.667 42.667 0 0 0 29.44 11.946 42.667 42.667 0 0 0 30.72-12.8 42.667 42.667 0 0 0 0-60.586zm-488.96 0-61.44 59.307a42.667 42.667 0 0 0 0 60.586 42.667 42.667 0 0 0 30.72 12.8 42.667 42.667 0 0 0 28.587-10.666l61.44-59.307a42.667 42.667 0 0 0-59.307-61.44zM512 341.333A170.667 170.667 0 1 0 682.667 512 170.667 170.667 0 0 0 512 341.333z" fill="currentColor"></path></svg></div> <div class="item auto active"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon auto-icon"><path d="M460.864 539.072H564.8L510.592 376l-49.728 163.072zM872 362.368V149.504H659.648L510.528 0l-149.12 149.504H149.12v212.928L0 511.872l149.12 149.504v212.928h212.352l149.12 149.504 149.12-149.504h212.352V661.376l149.12-149.504L872 362.368zM614.464 693.12l-31.616-90.624H438.272l-31.616 90.624h-85.888l144.576-407.68h90.368l144.576 407.68h-85.824zm0 0" fill="currentColor"></path></svg></div> <div class="item night"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon dark-icon"><path d="M935.539 630.402c-11.43-11.432-28.674-14.739-43.531-8.354-46.734 20.103-96.363 30.297-147.508 30.297-99.59 0-193.221-38.784-263.64-109.203-108.637-108.637-139.61-270.022-78.908-411.148a39.497 39.497 0 0 0-51.886-51.887c-52.637 22.64-100.017 54.81-140.826 95.616-85.346 85.346-132.346 198.821-132.346 319.52 0 120.7 47.001 234.172 132.347 319.519S408.063 947.11 528.76 947.11c120.7 0 234.172-47.003 319.52-132.351 40.809-40.81 72.978-88.19 95.616-140.826a39.497 39.497 0 0 0-8.356-43.532z" fill="currentColor"></path></svg></div></div> <!----></div></div></div></button> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/myblog/" class="nav-link router-link-active"><!---->
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Front-end Basics" class="dropdown-title"><span class="title"><!---->
        前端基础
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/myblog/performance/html/" class="nav-link"><!---->
  HTML
</a></li><li class="dropdown-item"><a href="/myblog/performance/css/" class="nav-link"><!---->
  Css
</a></li><li class="dropdown-item"><a href="/myblog/performance/javascript/" class="nav-link"><!---->
  JavaScript
</a></li><li class="dropdown-item"><a href="/myblog/performance/typescript/" class="nav-link"><!---->
  TypeScript
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title"><!---->
        计算机基础
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/myblog/performance/algorithms/" class="nav-link"><!---->
  数据结构和算法
</a></li><li class="dropdown-item"><a href="/myblog/performance/network/" class="nav-link"><!---->
  计算机网络/HTTP
</a></li><li class="dropdown-item"><a href="/myblog/performance/network/输入url到页面展示全过程/" class="nav-link"><!---->
  输入url到页面展示全过程
</a></li><li class="dropdown-item"><a href="/myblog/performance/operating-system/" class="nav-link"><!---->
  操作系统
</a></li><li class="dropdown-item"><a href="/myblog/performance/design-model/" class="nav-link"><!---->
  设计模式
</a></li><li class="dropdown-item"><a href="/myblog/performance/Web-Security/" class="nav-link"><!---->
  Web安全
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架和源码分析" class="dropdown-title"><span class="title"><!---->
        框架和源码分析
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/myblog/performance/vue/Vue2原理和源码分析.html" class="nav-link"><!---->
  Vue 专题
</a></li><li class="dropdown-item"><a href="/myblog/performance/React/" class="nav-link"><!---->
  React 专题
</a></li><li class="dropdown-item"><a href="/myblog/performance/webpack/webpack构建原理.html" class="nav-link"><!---->
  webpack 专题
</a></li><li class="dropdown-item"><a href="/myblog/performance/vite/" class="nav-link"><!---->
  vite 专题
</a></li><li class="dropdown-item"><a href="/myblog/performance/axios/" class="nav-link"><!---->
  Axios 专题
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="浏览器" class="dropdown-title"><span class="title"><!---->
        浏览器
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/myblog/performance/browser/浏览器原理/" class="nav-link"><!---->
  浏览器原理
</a></li><li class="dropdown-item"><a href="/myblog/performance/browser/前端缓存和存储/" class="nav-link"><!---->
  前端缓存和存储
</a></li><li class="dropdown-item"><a href="/myblog/performance/performance/前端调试技巧/" class="nav-link"><!---->
  前端调试技巧
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="node.js" class="dropdown-title"><span class="title"><!---->
        服务器
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/myblog/performance/node/" class="nav-link"><!---->
  Node.js
</a></li><li class="dropdown-item"><a href="/myblog/performance/linux/" class="nav-link"><!---->
  Linux
</a></li><li class="dropdown-item"><a href="/myblog/performance/mysql/" class="nav-link"><!---->
  MySQL
</a></li><li class="dropdown-item"><a href="/myblog/performance/nginx/" class="nav-link"><!---->
  Nginx
</a></li><li class="dropdown-item"><a href="/myblog/performance/docker/" class="nav-link"><!---->
  Docker
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="浏览器和性能优化" class="dropdown-title"><span class="title"><!---->
        性能优化
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/myblog/performance/performance/性能优化指标和监控/" class="nav-link"><!---->
  性能优化指标和监控
</a></li><li class="dropdown-item"><a href="/myblog/performance/performance/前端性能优化方案/" class="nav-link"><!---->
  前端性能优化方案
</a></li><li class="dropdown-item"><a href="/myblog/performance/performance/一次管理后台的渲染优化/" class="nav-link"><!---->
  一次管理后台的渲染优化
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端工程" class="dropdown-title"><span class="title"><!---->
        前端工程
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/myblog/performance/Front-end-Engineering/前端工程化/" class="nav-link"><!---->
  前端工程化
</a></li><li class="dropdown-item"><a href="/myblog/performance/Front-end-Engineering/前端渲染架构/" class="nav-link"><!---->
  前端渲染架构
</a></li><li class="dropdown-item"><a href="/myblog/performance/Front-end-Engineering/前端架构实践/" class="nav-link"><!---->
  前端架构实践
</a></li><li class="dropdown-item"><a href="/myblog/performance/Front-end-Engineering/npm/" class="nav-link"><!---->
  npm
</a></li><li class="dropdown-item"><a href="/myblog/performance/git/" class="nav-link"><!---->
  Git
</a></li><li class="dropdown-item"><a href="/myblog/performance/projectDeploy/自动构建和部署/" class="nav-link"><!---->
  自动构建和部署
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目实践" class="dropdown-title"><span class="title"><!---->
        项目实践
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/myblog/performance/projectDeploy/" class="nav-link"><!---->
  前端部署
</a></li><li class="dropdown-item"><a href="/myblog/performance/componentsEncapsulation/组件和组件封装实践.html" class="nav-link"><!---->
  组件和组件封装实践
</a></li><li class="dropdown-item"><a href="/myblog/performance/projectsSummary/登录与单点登录/" class="nav-link"><!---->
  登录与单点登录
</a></li><li class="dropdown-item"><a href="/myblog/performance/projectsSummary/权限管理方案实践/" class="nav-link"><!---->
  权限管理方案实践
</a></li><li class="dropdown-item"><a href="/myblog/performance/projectsSummary/Echarts二次封装实践/" class="nav-link"><!---->
  Echarts二次封装实践
</a></li><li class="dropdown-item"><a href="/myblog/performance/projectsSummary/文档在线预览和编辑方案/" class="nav-link"><!---->
  文档在线预览和编辑方案
</a></li><li class="dropdown-item"><a href="/myblog/performance/projectsSummary/移动端开发实践/" class="nav-link"><!---->
  移动端开发实践
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目搭建到原理分析" class="dropdown-title"><span class="title"><!---->
        项目搭建
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/myblog/performance/projectsSummary/从零到一搭建SSR项目/" class="nav-link"><!---->
  从零到一搭建SSR项目
</a></li><li class="dropdown-item"><a href="/myblog/performance/projectsSummary/从零到一搭建移动端SSG项目/" class="nav-link"><!---->
  从零到一搭建移动端SSG项目
</a></li><li class="dropdown-item"><a href="/myblog/performance/projectsSummary/移动端SSG项目实践/" class="nav-link"><!---->
  移动端SSG项目实践
</a></li><li class="dropdown-item"><a href="/myblog/performance/projectsSummary/从零到一搭建Vue2工程化项目/" class="nav-link"><!---->
  从零到一搭建Vue2工程化项目
</a></li><li class="dropdown-item"><a href="/myblog/performance/projectsSummary/从零到一搭建Vue3工程化项目/" class="nav-link"><!---->
  从零到一搭建Vue3工程化项目
</a></li><li class="dropdown-item"><a href="/myblog/performance/projectsSummary/搭建低代码平台/" class="nav-link"><!---->
  搭建低代码平台
</a></li><li class="dropdown-item"><a href="/myblog/performance/projectsSummary/混合桌面应用开发实践/" class="nav-link"><!---->
  混合桌面应用开发实践
</a></li></ul></div></div></nav> <!----> <!----> <!----> <div class="content__navbar-end"></div></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><div vocab="https://schema.org/" typeof="Person" class="blogger-info mobile"><div data-balloon-pos="down" role="navigation" class="blogger hasIntro"><img property="image" alt="Blogger Avatar" src="./mylogo.png" class="avatar round"> <div property="name" class="name">Sewen 博客</div> <meta property="url" content="../outline.md"></div> <div class="num-wrapper"><div><div class="num">91</div> <div>Articles</div></div> <div><div class="num">0</div> <div>Category</div></div> <div><div class="num">0</div> <div>Tags</div></div> <div><div class="num">91</div> <div>Timeline</div></div></div> <div class="media-links-wrapper"><a href="https://github.com/Sewar-x/myblog" rel="noopener noreferrer" target="_blank" aria-label="Github" data-balloon-pos="up" class="media-link"><span class="sr-only">Github</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-github"><circle cx="512" cy="512" r="512" fill="#171515"></circle> <path d="M509.423 146.442c-200.317 0-362.756 162.42-362.756 362.8 0 160.266 103.936 296.24 248.109 344.217 18.139 3.327 24.76-7.872 24.76-17.486 0-8.613-.313-31.427-.49-61.702-100.912 21.923-122.205-48.63-122.205-48.63-16.495-41.91-40.28-53.067-40.28-53.067-32.937-22.51 2.492-22.053 2.492-22.053 36.407 2.566 55.568 37.386 55.568 37.386 32.362 55.438 84.907 39.43 105.58 30.143 3.296-23.444 12.667-39.43 23.032-48.498-80.557-9.156-165.246-40.28-165.246-179.297 0-39.604 14.135-71.988 37.342-97.348-3.731-9.178-16.18-46.063 3.556-96.009 0 0 30.46-9.754 99.76 37.19 28.937-8.048 59.97-12.071 90.823-12.211 30.807.14 61.843 4.165 90.822 12.21 69.26-46.944 99.663-37.189 99.663-37.189 19.792 49.946 7.34 86.831 3.61 96.01 23.25 25.359 37.29 57.742 37.29 97.347 0 139.366-84.82 170.033-165.637 179.013 13.026 11.2 24.628 33.342 24.628 67.182 0 48.498-.445 87.627-.445 99.521 0 9.702 6.535 20.988 24.945 17.444 144.03-48.067 247.881-183.95 247.881-344.175 0-200.378-162.442-362.798-362.802-362.798z" fill="#FFF"></path></svg></a><a href="1567910907" rel="noopener noreferrer" target="_blank" aria-label="Wechat" data-balloon-pos="up" class="media-link"><span class="sr-only">Wechat</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-wechat"><circle cx="512" cy="512" r="512" fill="#1AC88E"></circle> <path d="M827.551 578.742a176.583 176.583 0 0 0-185.685-158.379 172.942 172.942 0 0 0-186.3 158.379 172.942 172.942 0 0 0 185.686 158.379 282.169 282.169 0 0 0 65.536-10.923l60.689 32.768-16.384-54.613a166.275 166.275 0 0 0 76.458-125.611zm-245.76-27.307a21.845 21.845 0 1 1 0-43.69 24.872 24.872 0 0 1 27.307 21.845 24.872 24.872 0 0 1-27.921 21.845h.614zm121.356 0a21.845 21.845 0 1 1 0-43.69 24.872 24.872 0 0 1 27.306 21.845 24.872 24.872 0 0 1-28.512 21.845h1.206z" fill="#FFF"></path> <path d="M623.662 400.953h21.23A222.709 222.709 0 0 0 419.772 245.6a208.145 208.145 0 0 0-223.323 189.94 182.044 182.044 0 0 0 89.201 150.483l-22.436 67.356 78.279-39.435a389.575 389.575 0 0 0 78.279 10.923h20.616a163.226 163.226 0 0 1-6.667-46.718 182.044 182.044 0 0 1 189.94-177.197zm-121.379-60.69a27.921 27.921 0 1 1 0 55.843 31.562 31.562 0 0 1-33.36-27.921 31.562 31.562 0 0 1 34.59-27.921h-1.23zM346.34 396.107a31.562 31.562 0 0 1-33.383-27.921 31.562 31.562 0 0 1 33.383-27.921 27.921 27.921 0 1 1 0 55.842z" fill="#FFF"></path></svg></a></div></div> <hr> <!----> <div class="content__sidebar-top"></div> <nav class="sidebar-nav-links"><div class="nav-item"><a href="/myblog/" class="nav-link router-link-active"><!---->
  首页
</a></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="Front-end Basics" class="dropdown-title"><span class="title"><!---->
      前端基础
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/performance/html/" class="nav-link"><!---->
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/css/" class="nav-link"><!---->
  Css
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/javascript/" class="nav-link"><!---->
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/typescript/" class="nav-link"><!---->
  TypeScript
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title"><!---->
      计算机基础
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/performance/algorithms/" class="nav-link"><!---->
  数据结构和算法
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/network/" class="nav-link"><!---->
  计算机网络/HTTP
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/network/输入url到页面展示全过程/" class="nav-link"><!---->
  输入url到页面展示全过程
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/operating-system/" class="nav-link"><!---->
  操作系统
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/design-model/" class="nav-link"><!---->
  设计模式
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/Web-Security/" class="nav-link"><!---->
  Web安全
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="框架和源码分析" class="dropdown-title"><span class="title"><!---->
      框架和源码分析
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/performance/vue/Vue2原理和源码分析.html" class="nav-link"><!---->
  Vue 专题
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/React/" class="nav-link"><!---->
  React 专题
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/webpack/webpack构建原理.html" class="nav-link"><!---->
  webpack 专题
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/vite/" class="nav-link"><!---->
  vite 专题
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/axios/" class="nav-link"><!---->
  Axios 专题
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="浏览器" class="dropdown-title"><span class="title"><!---->
      浏览器
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/performance/browser/浏览器原理/" class="nav-link"><!---->
  浏览器原理
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/browser/前端缓存和存储/" class="nav-link"><!---->
  前端缓存和存储
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/performance/前端调试技巧/" class="nav-link"><!---->
  前端调试技巧
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="node.js" class="dropdown-title"><span class="title"><!---->
      服务器
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/performance/node/" class="nav-link"><!---->
  Node.js
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/linux/" class="nav-link"><!---->
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/mysql/" class="nav-link"><!---->
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/nginx/" class="nav-link"><!---->
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/docker/" class="nav-link"><!---->
  Docker
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="浏览器和性能优化" class="dropdown-title"><span class="title"><!---->
      性能优化
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/performance/performance/性能优化指标和监控/" class="nav-link"><!---->
  性能优化指标和监控
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/performance/前端性能优化方案/" class="nav-link"><!---->
  前端性能优化方案
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/performance/一次管理后台的渲染优化/" class="nav-link"><!---->
  一次管理后台的渲染优化
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="前端工程" class="dropdown-title"><span class="title"><!---->
      前端工程
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/performance/Front-end-Engineering/前端工程化/" class="nav-link"><!---->
  前端工程化
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/Front-end-Engineering/前端渲染架构/" class="nav-link"><!---->
  前端渲染架构
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/Front-end-Engineering/前端架构实践/" class="nav-link"><!---->
  前端架构实践
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/Front-end-Engineering/npm/" class="nav-link"><!---->
  npm
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/git/" class="nav-link"><!---->
  Git
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/projectDeploy/自动构建和部署/" class="nav-link"><!---->
  自动构建和部署
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="项目实践" class="dropdown-title"><span class="title"><!---->
      项目实践
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/performance/projectDeploy/" class="nav-link"><!---->
  前端部署
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/componentsEncapsulation/组件和组件封装实践.html" class="nav-link"><!---->
  组件和组件封装实践
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/projectsSummary/登录与单点登录/" class="nav-link"><!---->
  登录与单点登录
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/projectsSummary/权限管理方案实践/" class="nav-link"><!---->
  权限管理方案实践
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/projectsSummary/Echarts二次封装实践/" class="nav-link"><!---->
  Echarts二次封装实践
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/projectsSummary/文档在线预览和编辑方案/" class="nav-link"><!---->
  文档在线预览和编辑方案
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/projectsSummary/移动端开发实践/" class="nav-link"><!---->
  移动端开发实践
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="项目搭建到原理分析" class="dropdown-title"><span class="title"><!---->
      项目搭建
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/performance/projectsSummary/从零到一搭建SSR项目/" class="nav-link"><!---->
  从零到一搭建SSR项目
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/projectsSummary/从零到一搭建移动端SSG项目/" class="nav-link"><!---->
  从零到一搭建移动端SSG项目
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/projectsSummary/移动端SSG项目实践/" class="nav-link"><!---->
  移动端SSG项目实践
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/projectsSummary/从零到一搭建Vue2工程化项目/" class="nav-link"><!---->
  从零到一搭建Vue2工程化项目
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/projectsSummary/从零到一搭建Vue3工程化项目/" class="nav-link"><!---->
  从零到一搭建Vue3工程化项目
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/projectsSummary/搭建低代码平台/" class="nav-link"><!---->
  搭建低代码平台
</a></li><li class="dropdown-item"><!----> <a href="/myblog/performance/projectsSummary/混合桌面应用开发实践/" class="nav-link"><!---->
  混合桌面应用开发实践
</a></li></ul></div></div> <!----></nav> <!----> <div class="content__sidebar-center"></div> <!----> <!----> <div class="content__sidebar-bottom"></div> <!----></aside> <main class="page"><nav class="breadcrumb disable"><!----></nav> <!----> <div class="content__page-top"></div> <div vocab="https://schema.org/" typeof="Article" class="page-title"><h1><!----> <span property="headline">前端性能优化方案</span></h1> <div class="page-info"><!----> <true-info defaultAuthor="" categoryPath="/category/$category/" tagPath="/tag/$tag/"></true-info><true-info defaultAuthor="" categoryPath="/category/$category/" tagPath="/tag/$tag/"></true-info><true-info defaultAuthor="" categoryPath="/category/$category/" tagPath="/tag/$tag/"></true-info><true-info defaultAuthor="" categoryPath="/category/$category/" tagPath="/tag/$tag/"></true-info><true-info defaultAuthor="" categoryPath="/category/$category/" tagPath="/tag/$tag/"></true-info><true-info defaultAuthor="" categoryPath="/category/$category/" tagPath="/tag/$tag/"></true-info><true-info defaultAuthor="" categoryPath="/category/$category/" tagPath="/tag/$tag/"></true-info></div> <!----> <hr></div> <div class="anchor-place-holder"><aside id="anchor"><div class="anchor-wrapper"><ul class="anchor-list"><li class="anchor"><a href="/myblog/performance/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88/#总览" class="anchor-link heading2"><div>总览</div></a></li><li class="anchor"><a href="/myblog/performance/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88/#网络加载优化" class="anchor-link heading2"><div>网络加载优化</div></a></li><li class="anchor"><a href="/myblog/performance/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88/#资源提示" class="anchor-link heading3"><div>资源提示</div></a></li><li class="anchor"><a href="/myblog/performance/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88/#避免链关键请求" class="anchor-link heading3"><div>避免链关键请求</div></a></li><li class="anchor"><a href="/myblog/performance/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88/#减少http请求" class="anchor-link heading3"><div>减少http请求</div></a></li><li class="anchor"><a href="/myblog/performance/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88/#避免重定向" class="anchor-link heading3"><div>避免重定向</div></a></li><li class="anchor"><a href="/myblog/performance/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88/#使用-http2" class="anchor-link heading3"><div>使用 HTTP2</div></a></li><li class="anchor"><a href="/myblog/performance/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88/#静态资源使用-cdn" class="anchor-link heading3"><div>静态资源使用 CDN</div></a></li><li class="anchor"><a href="/myblog/performance/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88/#http-缓存" class="anchor-link heading3"><div>HTTP 缓存</div></a></li><li class="anchor"><a href="/myblog/performance/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88/#渲染优化" class="anchor-link heading3"><div>渲染优化</div></a></li><li class="anchor"><a href="/myblog/performance/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88/#服务端优化" class="anchor-link heading2"><div>服务端优化</div></a></li><li class="anchor"><a href="/myblog/performance/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88/#nginx-开启gzip-压缩" class="anchor-link heading3"><div>Nginx 开启Gzip 压缩</div></a></li><li class="anchor"><a href="/myblog/performance/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88/#构建优化" class="anchor-link heading2"><div>构建优化</div></a></li><li class="anchor"><a href="/myblog/performance/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88/#图片资源优化" class="anchor-link heading3"><div>图片资源优化</div></a></li><li class="anchor"><a href="/myblog/performance/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88/#js-编码优化" class="anchor-link heading3"><div>JS 编码优化</div></a></li><li class="anchor"><a href="/myblog/performance/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88/#css-编码优化" class="anchor-link heading3"><div>CSS 编码优化</div></a></li><li class="anchor"><a href="/myblog/performance/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88/#其他编码优化" class="anchor-link heading3"><div>其他编码优化</div></a></li><li class="anchor"><a href="/myblog/performance/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88/#性能优化实践" class="anchor-link heading2"><div>性能优化实践</div></a></li></ul></div></aside></div> <!----> <div class="content__content-top"></div> <div class="theme-default-content content__default"><h1 id="前端性能优化方案"><a href="#前端性能优化方案" class="header-anchor">#</a> 前端性能优化方案</h1> <h2 id="总览"><a href="#总览" class="header-anchor">#</a> 总览</h2> <p><img src="/myblog/assets/img/优化方案.8f5c0360.png" alt=""></p> <h2 id="网络加载优化"><a href="#网络加载优化" class="header-anchor">#</a> 网络加载优化</h2> <h3 id="资源提示"><a href="#资源提示" class="header-anchor">#</a> 资源提示</h3> <p>此规范定义了 HTML 的 <code>&lt;Link&gt;</code> 元素的 rel 属性值，包括 dns-prefetch、preconnect、prefetch 和 prerender。我们可以使用这些资源提示让用用户代理帮助我们预解析 DNS、预链接、预加载资源以及预处理资源以提高页面性能。</p> <h4 id="dns-预解析-dns-prefetch"><a href="#dns-预解析-dns-prefetch" class="header-anchor">#</a> <strong>DNS 预解析 (DNS-Prefetch)：</strong></h4> <ul><li>通过 DNS 预解析来告诉浏览器未来我们可能从某个特定的 URL 获取资源，当浏览器真正使用到该域中的某个资源时就可以尽快地完成 DNS 解析。</li> <li>方法： <code>&lt;link rel=&quot;dns-prefetch&quot; href=&quot;//example.com&quot;&gt;</code></li></ul> <h4 id="预连接-preconnect"><a href="#预连接-preconnect" class="header-anchor">#</a> <strong>预连接 (Preconnect)：</strong></h4> <ul><li><p>与 DNS 预解析类似，preconnect 不仅完成 DNS 预解析，同时还将进行 TCP 握手和建立传输层协议</p></li> <li><p>方法： <code>&lt;link rel=&quot;preconnect&quot; href=&quot;http://example.com&quot;&gt;</code></p> <p><img src="/myblog/assets/img/preconnect.995a67cd.png" alt="image-20210707235115997"></p></li> <li><p>应用：</p> <ul><li>只对一些立即用到的第三方站点添加 preconnect 处理，要节省用 preconnect。</li> <li>用 preconnect 给所有的第三方站点都做提前链接很低效，可以为重要的第三方站点做 preconnect ,其余的都做 dns-prefetch. 可节约20-120ms。</li></ul></li></ul> <h4 id="预获取-prefetching"><a href="#预获取-prefetching" class="header-anchor">#</a> <strong>预获取 (Prefetching)：</strong></h4> <ul><li>告诉浏览器获取下一次导航可能需要的资源。大多数情况下，这意味着将以极低的优先级来获取资源（因为浏览器知道当前页面中需要的所有内容比我们认为在下一页中需要的资源更重要）。这意味着 prefetch 的主要用处是加快下一个导航的速度，而不是当前的导航。</li> <li>方法：<code>&lt;link rel=&quot;prefetch&quot; href=&quot;image.png&quot;&gt;</code></li> <li>与预解析DNS区别：与 DNS 预解析不同，预获取真正请求并下载了资源，并储存在缓存中。但预获取还依赖于一些条件，某些预获取可能会被浏览器忽略，例如从一个非常缓慢的网络中获取一个庞大的字体文件。并且，Firefox 只会在浏览器闲置时进行资源预获取。</li></ul> <h4 id="子资源-subresources"><a href="#子资源-subresources" class="header-anchor">#</a> <strong>子资源 (Subresources)：</strong></h4> <ul><li>另一个预获取方式，这种方式指定的预获取资源具有最高的优先级，在所有 prefetch 项之前进行</li> <li>方法：<code>&lt;link rel=&quot;subresource&quot; href=&quot;styles.css&quot;&gt;</code></li> <li>rel=prefetch 为将来的页面提供了一种低优先级的资源预加载方式，而 rel=subresource 为当前页面提供了一种高优先级的资源预加载。所以，如果资源是当前页面必须的，或者资源需要尽快可用，那么最好使用 subresource 而不是 prefetch</li></ul> <h4 id="预渲染-prerender"><a href="#预渲染-prerender" class="header-anchor">#</a> <strong>预渲染 (Prerender)：</strong></h4> <ul><li>prerender 可以预先加载文档的所有资源。这类似于在一个隐藏的 tab 页中打开了某个链接 – 将下载所有资源、创建 DOM 结构、完成页面布局、应用 CSS 样式和执行 JavaScript 脚本等。当用户真正访问该链接时，隐藏的页面就切换为可见，使页面看起来就是瞬间加载完成一样</li> <li>方法：<code>&lt;link rel=&quot;prerender&quot; href=&quot;http://example.com&quot;&gt;</code></li> <li>注意：不要滥用该特性，当你知道用户一定会点击某个链接时才可以进行预渲染，否则浏览器将无条件地下载所有预渲染需要的资源，所有预加载技术都存在一个潜在的风险：对资源预测错误，而预加载的开销（抢占 CPU 资源，消耗电池，浪费带宽等）是高昂的，所以必须谨慎行事。虽然很难确定用户下一步将访问哪些资源，但高可信的场景确实存在：
<ul><li>如果用户完成一个带有明显结果的搜索，那么结果页面很可能会被加载</li> <li>如果用户进入到登陆页面，那么登陆成功的页面很可能会被加载</li> <li>如果用户阅读一个多页的文章或访问一个分页的结果集，那么下一页很可能会被加载</li></ul></li></ul> <h4 id="预加载-preload"><a href="#预加载-preload" class="header-anchor">#</a> <strong>预加载(Preload)：</strong></h4> <ul><li><p>告诉用户代理预读取资源而不必执行它们，允许将资源加载与执行分离，细粒度控制资源何时和如何加载。</p></li> <li><p>方法：<code>&lt;link rel=&quot;preload&quot; href=&quot;image.png&quot;&gt;</code></p></li> <li><p>示例：应用程序可以使用 preload 关键字启动 CSS 资源的早期、高优先级和非呈现阻塞获取，然后应用程序可以在适当的时间应用这些获取：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>Using markup
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> preload stylesheet resource via declarative markup <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">&quot;preload&quot;</span> href<span class="token operator">=</span><span class="token string">&quot;/styles/other.css&quot;</span> <span class="token keyword">as</span><span class="token operator">=</span><span class="token string">&quot;style&quot;</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> or<span class="token punctuation">,</span> preload stylesheet resource via JavaScript <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">var</span> res <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;link&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
res<span class="token punctuation">.</span>rel <span class="token operator">=</span> <span class="token string">&quot;preload&quot;</span><span class="token punctuation">;</span>
res<span class="token punctuation">.</span>as <span class="token operator">=</span> <span class="token string">&quot;style&quot;</span><span class="token punctuation">;</span>
res<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">&quot;styles/other.css&quot;</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

Using <span class="token constant">HTTP</span> Header
<span class="token literal-property property">Link</span><span class="token operator">:</span> <span class="token operator">&lt;</span>https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>example<span class="token punctuation">.</span>com<span class="token operator">/</span>other<span class="token operator">/</span>styles<span class="token punctuation">.</span>css<span class="token operator">&gt;</span><span class="token punctuation">;</span> rel<span class="token operator">=</span>preload<span class="token punctuation">;</span> <span class="token keyword">as</span><span class="token operator">=</span>style
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div></li> <li><p>假设您页面的<a href="https://web.dev/critical-request-chains" target="_blank" rel="noopener noreferrer">关键请求链<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>如下所示：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>index.html
|--app.js   
	|--styles.css   
	|--ui.js
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><p><code>index.html</code>文件声明<code>&lt;script src=&quot;app.js&quot;&gt;</code>. 当<code>app.js</code>运行时，它调用<code>fetch()</code>以下载<code>styles.css</code>和<code>ui.js</code>。在下载、解析和执行最后 2 个资源之前，页面不会显示完整。使用上面的示例，Lighthouse 将标记<code>styles.css</code>和<code>ui.js</code>作为候选。</p></li> <li><p>潜在的节省取决于如果您声明了预加载链接，浏览器可以提前多长时间启动请求。例如，如果<code>app.js</code>下载、解析和执行需要 200 毫秒，则每个资源的潜在节省为 200 毫秒，因为<code>app.js</code>不再是每个请求的瓶颈。</p></li> <li><p>无预加载过程： app.js 加载后再加载 ui.js 和 style.css<img src="/myblog/assets/img/chrome-preload.b7806d0e.png" alt=""></p></li> <li><p>使用预加载过程：app.js 、 ui.js 和 style.css 同时加载</p> <p><img src="/myblog/assets/img/chrome-preload2.23ee3624.png" alt=""></p></li></ul></li></ul> <h4 id="preload-与-prefetch比较"><a href="#preload-与-prefetch比较" class="header-anchor">#</a> preload 与 prefetch比较</h4> <ul><li>prefetch 和 preload 都可以声明一个资源及其获取属性，但在用户代理获取资源的方式和时间上有所不同：</li> <li>prefetch 是可选的，通常是用于后续导航可能使用的资源的低优先级获取；
<ul><li>preload 是当前导航所必需的资源的强制获取。开发人员应该合理使用它们来最小化资源争用和优化加载性能。</li> <li>在 preload 中 as 属性对于保证正确的优先级、请求匹配、请求对应正确的内容安全策略（<a href="http://www.html5rocks.com/en/tutorials/security/content-security-policy/" target="_blank" rel="noopener noreferrer">Content-Security-Policy<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ）指令以及基于资源类型发送正确的 Accept 首部是必需的。</li></ul></li></ul> <h3 id="避免链关键请求"><a href="#避免链关键请求" class="header-anchor">#</a> 避免链关键请求</h3> <ul><li><p><a href="https://developers.google.com/web/fundamentals/performance/critical-rendering-path" target="_blank" rel="noopener noreferrer">关键请求链<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>是一系列对页面渲染很重要的依赖网络请求。链的长度越大，下载量越大，对页面加载性能的影响就越大。</p></li> <li><p><a href="https://developers.google.com/web/tools/lighthouse/" target="_blank" rel="noopener noreferrer">Lighthouse<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>报告加载了高优先级的关键请求：</p></li></ul> <p><img src="/myblog/assets/img/chrome-关键链接请求.3c6297ce.png" alt="Lighthouse 最小化关键请求深度审计的屏幕截图"></p> <ul><li><p><a href="https://web.dev/critical-request-chains/#how-lighthouse-identifies-critical-request-chains" target="_blank" rel="noopener noreferrer">Lighthouse 如何识别关键请求链<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>：</p> <ul><li>Lighthouse 使用网络优先级作为识别阻塞渲染的关键资源的代理。有关<a href="https://docs.google.com/document/d/1bCDuq9H1ih9iNjgzyAL0gpwNFiEP4TZS-YLRp_RuMlc/edit" target="_blank" rel="noopener noreferrer">Chrome<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>如何定义这些优先级的更多信息，请参阅 Google 的<a href="https://docs.google.com/document/d/1bCDuq9H1ih9iNjgzyAL0gpwNFiEP4TZS-YLRp_RuMlc/edit" target="_blank" rel="noopener noreferrer">Chrome 资源优先级和调度<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</li> <li>有关关键请求链、资源大小和下载资源所用时间的数据是从<a href="https://github.com/ChromeDevTools/devtools-protocol" target="_blank" rel="noopener noreferrer">Chrome 远程调试协议中<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>提取的。</li></ul></li> <li><p><a href="https://web.dev/critical-request-chains/#how-to-reduce-the-effect-of-critical-request-chains-on-performance" target="_blank" rel="noopener noreferrer">如何减少关键请求链对性能的影响<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>：</p> <ul><li>使用关键请求链审计结果首先定位对页面加载影响最大的资源：
<ul><li>尽量减少关键资源的数量：消除它们、推迟下载、将它们标记为<code>async</code>，等等。</li> <li>优化关键字节数以减少下载时间（往返次数）。</li> <li>优化剩余关键资源的加载顺序：尽早下载所有关键资产，缩短关键路径长度。</li></ul></li></ul></li></ul> <h3 id="减少http请求"><a href="#减少http请求" class="header-anchor">#</a> 减少http请求</h3> <ul><li><p>HTTP连接产生的开销：域名解析—TCP连接—发送请求—等待—下载资源—解析时间。中间有个等待和下载资源，这些都比较消耗时间，所以我们为了解决http产生的开销，尽量让他减少http连接。</p> <ul><li><img src="/myblog/assets/img/chrome-http.90228569.png" alt=""> <ul><li>Queueing: 在请求队列中的时间。</li> <li>Stalled: 从TCP 连接建立完成，到真正可以传输数据之间的时间差，此时间包括代理协商时间。</li> <li>Proxy negotiation: 与代理服务器连接进行协商所花费的时间。</li> <li>DNS Lookup: 执行DNS查找所花费的时间，页面上的每个不同的域都需要进行DNS查找。</li> <li>Initial Connection / Connecting: 建立连接所花费的时间，包括TCP握手/重试和协商SSL。</li> <li>SSL: 完成SSL握手所花费的时间。</li> <li>Request sent: 发出网络请求所花费的时间，通常为一毫秒的时间。</li> <li>Waiting(TFFB): TFFB 是发出页面请求到接收到应答数据第一个字节的时间。</li> <li>Content Download: 接收响应数据所花费的时间。</li></ul></li></ul></li> <li><p><a href="https://web.dev/total-byte-weight/#how-the-lighthouse-network-payload-audit-fails" target="_blank" rel="noopener noreferrer">Lighthouse 审计网络负载<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li><a href="https://developers.google.com/web/tools/lighthouse/" target="_blank" rel="noopener noreferrer">Lighthouse<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>显示页面请求的所有资源的总大小（以<a href="https://en.wikipedia.org/wiki/Kibibyte" target="_blank" rel="noopener noreferrer">千字节 (KiB)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>为单位<a href="https://en.wikipedia.org/wiki/Kibibyte" target="_blank" rel="noopener noreferrer">）<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。最大的请求首先呈现：</li></ul> <p><img src="/myblog/assets/img/chrome-资源请求.7f31e08b.png" alt="Lighthouse 的屏幕截图避免巨大的网络负载审计"></p> <ul><li>根据<a href="https://httparchive.org/reports/state-of-the-web?start=latest#bytesTotal" target="_blank" rel="noopener noreferrer">HTTP 存档数据<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，网络有效负载的中位数在 1,700 到 1,900 KiB 之间。为了帮助显示最高的有效负载，Lighthouse 会标记总网络请求超过 5,000 KiB 的页面。</li></ul></li> <li><p>减少HTTP请求的方式：</p> <ul><li>推迟请求，直到需要它们。</li> <li>资源压缩。</li> <li>使用缓存。</li> <li>减少页面中的元素：网页中的的图片、form、flash等等元素都会发出HTTP请求，尽可能的减少页面中非必要的元素，可以减少HTTP请求的次数</li> <li>图片地图（Image Maps）：也就是图像热点，图像地图就是把一张图片分成若干区域,每个区域指向不同的URL地址，这些区域也称为热点。Image Maps只适用于连续的图标</li> <li>CSS Sprites(CSS精灵)：图片是增加HTTP请求的最大可能者，把全站的图标都放在一个图像文件中，然后用CSS的background-image和background-position属性定位来显示其中的一小部分</li> <li>合并css：合并脚本和CSS文件，可以减少了HTTP请求</li> <li>合并js：少用location.reload()，使用location.reload() 会刷新页面，刷新页面时页面所有资源（css，js，img等）会重新请求服务器；建议使用 <code>location.href=&quot;当前页url&quot;</code> 代替 location.reload() ，使用 location.href 浏览器会读取本地缓存资源。</li> <li>动态页面静态化：动态网页实际上并不是独立存在于服务器上的网页文件，只有当用户请求时服务器才返回一个完整的网页
用户访问动态页面需要与数据库服务器进行数据交换</li></ul></li></ul> <h3 id="避免重定向"><a href="#避免重定向" class="header-anchor">#</a> 避免重定向</h3> <ul><li><p>重定向会降低页面加载速度。当浏览器请求已重定向的资源时，服务器通常会返回这样的 HTTP 响应：</p> <div class="language-http line-numbers-mode"><pre class="language-http"><code><span class="token response-status"><span class="token http-version property">HTTP/1.1</span> <span class="token status-code number">301</span> <span class="token reason-phrase string">Moved Permanently</span></span>
<span class="token header"><span class="token header-name keyword">Location</span><span class="token punctuation">:</span> <span class="token header-value">/path/to/new/location</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>然后浏览器必须在新位置发出另一个 HTTP 请求以检索资源。跨网络的这种额外行程可能会延迟数百毫秒的资源加载。</li></ul></li> <li><p><a href="https://developers.google.com/web/tools/lighthouse/" target="_blank" rel="noopener noreferrer">Lighthouse<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>标记具有多个重定向的页面：</p> <p><img src="/myblog/assets/img/chrome-chongdingxiang.8628b29d.png" alt="img"></p> <ul><li>当页面有两个或多个重定向时，该页面无法通过此审核。</li></ul></li> <li><p><a href="https://web.dev/redirects/#how-to-eliminate-redirects" target="_blank" rel="noopener noreferrer">如何消除重定向<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>:</p> <ul><li><p>将指向标记资源的链接指向资源的当前位置。避免重定向<a href="https://developers.google.com/web/fundamentals/performance/critical-rendering-path/" target="_blank" rel="noopener noreferrer">关键渲染路径<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>所需的资源尤为重要。</p></li> <li><p>如果您使用重定向将移动用户转移到您页面的移动版本，请考虑重新设计您的网站以使用<a href="https://developers.google.com/web/fundamentals/design-and-ux/responsive/" target="_blank" rel="noopener noreferrer">响应式设计<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li></ul></li></ul> <h3 id="使用-http2"><a href="#使用-http2" class="header-anchor">#</a> 使用 HTTP2</h3> <ul><li><p>HTTP2 相比 HTTP1.1 有如下几个优点：</p> <ul><li><p>解析速度快：服务器解析 HTTP1.1 的请求时，必须不断地读入字节，直到遇到分隔符 CRLF 为止。而解析 HTTP2 的请求就不用这么麻烦，因为 HTTP2 是基于帧的协议，每个帧都有表示帧长度的字段。</p></li> <li><p>多路复用：HTTP1.1 如果要同时发起多个请求，就得建立多个 TCP 连接，因为一个 TCP 连接同时只能处理一个 HTTP1.1 的请求。在 HTTP2 上，多个请求可以共用一个 TCP 连接，这称为多路复用。同一个请求和响应用一个流来表示，并有唯一的流 ID 来标识。 多个请求和响应在 TCP 连接中可以乱序发送，到达目的地后再通过流 ID 重新组建。</p></li> <li><p>首部压缩：HTTP2 提供了首部压缩功能。</p></li> <li><p>优先级：HTTP2 可以对比较紧急的请求设置一个较高的优先级，服务器在收到这样的请求后，可以优先处理。</p></li> <li><p>流量控制：由于一个 TCP 连接流量带宽（根据客户端到服务器的网络带宽而定）是固定的，当有多个请求并发时，一个请求占的流量多，另一个请求占的流量就会少。流量控制可以对不同的流的流量进行精确控制。</p></li> <li><p>服务器推送：HTTP2 新增的一个强大的新功能，就是服务器可以对一个客户端请求发送多个响应。除了对最初请求的响应外，服务器还可以额外向客户端推送资源，而无需客户端明确地请求。</p></li></ul></li></ul> <h3 id="静态资源使用-cdn"><a href="#静态资源使用-cdn" class="header-anchor">#</a> 静态资源使用 CDN</h3> <ul><li>通过将静态资源(例如javascript，css，图片等等）缓存到离用户很近的相同网络运营商的CDN节点上</li> <li>使用 CDN 优势：不但能提升用户的访问速度，还能节省服务器的带宽消耗，降低负载</li> <li>过程：其实这是CDN服务商在全国各个省份部署计算节点，CDN加速将网站的内容缓存在网络边缘,不同地区的用户就会访问到离自己最近的相同网络线路上的CDN节点，当请求达到CDN节点后，节点会判断自己的内容缓存是否有效，如果有效，则立即响应缓存内容给用户，从而加快响应速度。如果CDN节点的缓存失效，它会根据服务配置去我们的内容源服务器获取最新的资源响应给用户，并将内容缓存下来以便响应给后续访问的用户。因此，一个地区内只要有一个用户先加载资源，在CDN中建立了缓存，该地区的其他后续用户都能因此而受益</li></ul> <h3 id="http-缓存"><a href="#http-缓存" class="header-anchor">#</a> HTTP 缓存</h3> <ul><li>HTTP 缓存可以加快重复访问时的页面加载时间。</li> <li>当浏览器请求资源时，提供资源的服务器可以告诉浏览器它应该临时存储或<em>缓存</em>资源多长时间。对于该资源的任何后续请求，浏览器使用其本地副本而不是从网络获取它。</li></ul> <p><strong><a href="https://web.dev/uses-long-cache-ttl/#how-the-lighthouse-cache-policy-audit-fails" target="_blank" rel="noopener noreferrer">Lighthouse 如何审计缓存<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></p> <ul><li><a href="https://developers.google.com/web/tools/lighthouse/" target="_blank" rel="noopener noreferrer">Lighthouse<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>标记所有未缓存的静态资源：</li></ul> <p><img src="/myblog/assets/img/chrome-缓存.46f40492.png" alt="具有高效缓存策略审计的 Lighthouse Serve 静态资产的屏幕截图"></p> <ul><li><p>如果满足以下所有条件，Lighthouse 会认为资源可缓存：</p> <ul><li>资源是字体、图像、媒体文件、脚本或样式表。</li> <li>资源拥有<code>200</code>，<code>203</code>或<code>206</code> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status" target="_blank" rel="noopener noreferrer">HTTP状态代码<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</li> <li>该资源没有明确的无缓存策略。</li></ul></li> <li><p>当页面未通过审核时，Lighthouse 会将结果列在一个包含三列的表格中：</p></li></ul> <table><thead><tr><th><strong>网址</strong></th> <th>可缓存资源的位置</th></tr></thead> <tbody><tr><td><strong>缓存TTL</strong></td> <td>资源的当前缓存持续时间</td></tr> <tr><td><strong>尺寸</strong></td> <td>如果标记的资源已被缓存，您的用户将保存的数据的估计</td></tr></tbody></table> <p><strong>缓存实现</strong></p> <ul><li>现代浏览器都实现了 HTTP 缓存机制。浏览器在初次获取资源后，会根据 HTTP 响应头部的 <code>Cache-Control</code> 和 <code>ETag</code> 字段，来决定该资源的缓存策略。</li> <li><code>Cache-Control</code> 有多个可能的字段值：
<ul><li><code>no-store</code>：表明任何缓存不得存储该资源，每次请求都会从服务端返回完整的内容。</li> <li><code>no-cache</code>：表明必须向服务端发一次请求，该请求头部带有 <code>If-None-Match</code> 等资源校验信息。服务端将会验证该资源是否被修改过，详细见下文 <code>ETag</code> 的描述。</li> <li><code>public</code>：表明该资源可以被 CDN 或代理等中间人缓存。</li> <li><code>private</code>：与 <code>public</code> 相反，表明任何中间人不得缓存该资源，资源可能与隐私信息相关。</li> <li><code>max-age</code>：指定了资源缓存的过期时间（秒），仅当缓存过期后才会向服务端发送请求。</li></ul></li> <li><code>ETag</code> 是由服务端决定的一个资源校验字段。如果浏览器缓存已经过期，那么会向服务端询问该资源是否被修改过。服务端会将 HTTP 请求头部的 <code>If-None-Match</code> 与 <code>ETag</code> 进行比对。如果相等，则表明资源并没有被修改过，服务端返回 <code>304 Not Modified</code>，浏览器可以直接从缓存获取资源，并刷新缓存过期时间。否则就需要返回该资源的完整内容。</li> <li>为了达到最佳缓存效果，常用的做法是：
<ul><li>对于 HTML 文件，设置 <code>Cache-Control: no-cache</code>。</li> <li>对于 CSS 和 JavaScript 等静态资源，上线构建的时候在文件名中插入一段仅与文件内容相关的哈希值，并使用 <code>Cache-Control: max-age=31536000</code> 进行长缓存。</li> <li>这样的效果是，对于绝大多数静态资源的请求都可以使用缓存来响应，并且仅在文件内容变更时刷新缓存。</li></ul></li></ul> <p><strong><a href="https://web.dev/uses-long-cache-ttl/#how-to-verify-cached-responses-in-chrome-devtools" target="_blank" rel="noopener noreferrer">如何在 Chrome DevTools 中验证缓存的响应<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></p> <ul><li><p>要查看浏览器从其缓存中获取哪些资源，请在 Chrome DevTools 中打开<strong>网络</strong>选项卡：</p> <ul><li>按<code>Control+Shift+J</code>（或<code>Command+Option+J</code>在 Mac 上）打开 DevTools。</li> <li>单击<strong>网络</strong>选项卡。</li></ul></li> <li><p>Chrome DevTools 中的<strong>Size</strong>列可以帮助您验证资源是否已被缓存：</p> <ul><li><img src="/myblog/assets/img/chrome-缓存检查.add4cc05.png" alt=""></li> <li>Chrome 从内存缓存中提供请求最多的资源，速度非常快，但在浏览器关闭时会被清除。</li></ul></li> <li><p>要验证资源的<code>Cache-Control</code>标头是否按预期设置，请检查其 HTTP 标头数据：</p> <ul><li>单击请求表的<strong>名称</strong>列下的请求URL 。</li> <li>单击<strong>标题</strong>选项卡。
<ul><li><img src="/myblog/assets/img/chrome-缓存头.1fe1d64f.png" alt=""></li> <li><code>Cache-Control</code>通过“**标题”**选项卡检查标题。</li></ul></li></ul></li></ul> <h3 id="渲染优化"><a href="#渲染优化" class="header-anchor">#</a> 渲染优化</h3> <h4 id="渲染机制优化"><a href="#渲染机制优化" class="header-anchor">#</a> 渲染机制优化</h4> <h5 id="创建-pwa-应用"><a href="#创建-pwa-应用" class="header-anchor">#</a> 创建 PWA 应用</h5> <h5 id="使用-app-shell"><a href="#使用-app-shell" class="header-anchor">#</a> 使用 App Shell</h5> <h5 id="添加-骨架屏"><a href="#添加-骨架屏" class="header-anchor">#</a> 添加 骨架屏</h5> <h5 id="使用-service-worker-缓存"><a href="#使用-service-worker-缓存" class="header-anchor">#</a> 使用 service worker 缓存</h5> <h5 id="服务端渲染-ssr"><a href="#服务端渲染-ssr" class="header-anchor">#</a> 服务端渲染 SSR</h5> <h4 id="浏览器渲染优化"><a href="#浏览器渲染优化" class="header-anchor">#</a> 浏览器渲染优化</h4> <p>浏览器渲染时 <a href="####%E5%85%B3%E9%94%AE%E6%B8%B2%E6%9F%93%E8%B7%AF%E5%BE%84">关键渲染路径</a> 构成首屏渲染所必须的关键资源，因此通过缩短关键渲染路径来优化首屏性能。</p> <h5 id="消除渲染阻塞资源"><a href="#消除渲染阻塞资源" class="header-anchor">#</a> 消除渲染阻塞资源</h5> <p>Lighthouse 报告的“机会”部分列出了阻止页面首次绘制的所有 URL。目标是通过内联关键资源、推迟非关键资源和删除任何未使用的资源来减少这些阻止渲染的 URL 的影响</p> <p><img src="/myblog/assets/img/render-block.96135bf1.png" alt=""></p> <p><a href="https://developers.google.com/web/tools/lighthouse/" target="_blank" rel="noopener noreferrer">Lighthouse<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>标记了两种阻止渲染的 URL：脚本和样式表。</p> <p>一个<code>&lt;script&gt;</code>标签：</p> <ul><li>是在<code>&lt;head&gt;</code>文档中。</li> <li>没有<code>defer</code>属性。</li> <li>没有<code>async</code>属性。</li></ul> <p>一个<code>&lt;link rel=&quot;stylesheet&quot;&gt;</code>标签：</p> <ul><li>没有<code>disabled</code>属性。当此属性存在时，浏览器不会下载样式表。</li> <li>没有<code>media</code>专门匹配用户设备的属性。<code>media=&quot;all&quot;</code>被认为是渲染阻塞。</li></ul> <h6 id="如何识别关键资源"><a href="#如何识别关键资源" class="header-anchor">#</a> <a href="https://web.dev/render-blocking-resources/#how-to-identify-critical-resources" target="_blank" rel="noopener noreferrer">如何识别关键资源<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h6> <p>减少渲染阻塞资源影响的第一步是确定什么是关键的，什么不是。使用Chrome DevTools 中的<a href="https://developer.chrome.com/docs/devtools/coverage/" target="_blank" rel="noopener noreferrer">Coverage 选项卡<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>来识别非关键 CSS 和 JS。当您加载或运行页面时，该选项卡会告诉您使用了多少代码，以及加载了多少代码：</p> <p><img src="/myblog/assets/img/chrome-关键资源.44b45090.png" alt=""></p> <p>通过仅加载所需的代码和样式来减小页面大小。单击 URL 以在“源”面板中检查该文件。CSS 文件中的样式和 JavaScript 文件中的代码用两种颜色标记：</p> <ul><li>**绿色（关键）：**首次绘制所需的样式；对页面核心功能至关重要的代码。</li> <li>**红色（非关键）：**适用于不立即可见的内容的样式；代码未在页面的核心功能中使用。</li></ul> <h5 id="非核心代码异步加载"><a href="#非核心代码异步加载" class="header-anchor">#</a> 非核心代码异步加载</h5> <ul><li><code>&lt;script/&gt;</code> 标签 <strong>async 属性：</strong> 异步加载脚本，加载后立即执行。</li> <li>当浏览器解析到 <code>&lt;script async&gt;</code> 时，会对该 JavaScript 文件发起异步请求。请求成功后才会暂停 HTML 解析，并立即执行 JavaScript。</li> <li>在实际项目中容易发现，多个 <code>&lt;script async&gt;</code> 的执行顺序是不确定的。而且在 JavaScript 执行时，页面的 DOM 可能还未全部构建完成。</li> <li><code>&lt;script/&gt;</code> 标签  <strong>defer 属性：</strong> 立即加载脚本，加载完成后不执行，延迟至渲染完成执行脚本。
<ul><li>浏览器同样会发起异步请求，但 JavaScript 会延迟到 HTML 解析完毕后依次执行。此时 JavaScript 已经能和完整的 DOM 进行交互了。</li></ul></li> <li>动态创建 script 标签替代 <code>&lt;script/&gt;</code></li></ul> <h5 id="延迟非关键-css-加载"><a href="#延迟非关键-css-加载" class="header-anchor">#</a> 延迟非关键 CSS 加载</h5> <ul><li><p>通过 <code>&lt;link rel=&quot;stylesheet&quot;&gt;</code> 引用的 CSS 都会在加载时阻塞页面渲染。但 Web 应用中往往会有一些首屏渲染时用不到的 CSS，如弹框的样式等。为了使这些非关键 CSS 不阻塞页面渲染，我们可以通过别的途径声明 CSS 的加载。</p></li> <li><p>通过 <code>&lt;link rel=&quot;preload&quot;&gt;</code> 预加载我们所需的资源。这里仅需稍作改动，就能满足我们的要求。</p> <ul><li><div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">HTML</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- ... --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>preload<span class="token punctuation">&quot;</span></span> <span class="token attr-name">as</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>style<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/dist/index.css<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">onload</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript"><span class="token keyword">this</span><span class="token punctuation">.</span>onload<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span><span class="token keyword">this</span><span class="token punctuation">.</span>rel<span class="token operator">=</span><span class="token string">'stylesheet'</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- ... --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li> <li><p>在 <code>&lt;link rel=&quot;preload&quot;&gt;</code> 中监听了 <code>onload</code> 事件，并在 CSS 加载完成后，通过修改 <code>rel</code> 为 <code>stylesheet</code> 来将 CSS 应用到页面上，这就绕过了 CSS 会阻塞页面渲染的限制了。在需要考虑浏览器兼容性的情况下，推荐使用 <a href="https://github.com/filamentgroup/loadCSS" target="_blank" rel="noopener noreferrer">loadCSS<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 来实现非关键 CSS 的加载。</p></li> <li><p>对于首屏渲染所必须的关键 CSS，可以考虑通过 <code>&lt;style&gt;</code> 内联，或使用 HTTP/2 服务端推送的方式来加载，可以节省一次网络请求。</p></li></ul></li></ul> <h5 id="使用-requestanimationframe"><a href="#使用-requestanimationframe" class="header-anchor">#</a> 使用 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/requestAnimationFrame" target="_blank" rel="noopener noreferrer">requestAnimationFrame()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h5> <ul><li><p>用户对于不流畅的滚动或动画十分敏感，一般要求页面帧率应达到每秒 60 帧。在这个帧率下，每帧的渲染需要在 16ms 内完成。但浏览器还需要花费大约 6ms 的时间将一帧绘制到屏幕上，从而只给我们留下了 10ms 时间生成一帧。</p></li> <li><p>JavaScript 可以进行样式更新，而动画则是以 16ms 为间隔的一连串的样式更新组成。最直接的想法是，可以通过 <code>setInterval()</code> 或递归调用 <code>setTimeout()</code> 来编写动画，如下代码所示。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">render</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> element<span class="token punctuation">.</span>offsetTop <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token string">'px'</span>
  element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> element<span class="token punctuation">.</span>offsetLeft <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token string">'px'</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span>render<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span>render<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li><p>上述代码实现了一个性能非常差劲的动画，其效果是使一个绝对定位的元素，从页面左上至右下漂浮。但我们用肉眼就能发现，动画产生了卡顿和掉帧的现象。这是由于 <code>setTimeout</code> 和 <code>setInterval</code> 的回调函数会在浏览器渲染两帧之间的任何时间点执行，而定时器的 16ms 又不是特别精确，从而有可能使一次样式变更错过浏览器渲染。</p></li> <li><p>为了实现平滑流畅的动画效果，我们应该使用 <code>requestAnimationFrame()</code> 方法来代替定时器</p></li></ul></li> <li><p><code>requestAnimationFrame()</code> 方法接收一个回调函数为参数，其回调函数不在浏览器事件循环中调度，而是在浏览器渲染下一帧之前执行，这可以确保动画不会掉帧。<code>requestAnimationFrame</code> 的回调函数接收一个高精度时间戳 <code>timestamp</code>，类似于 <code>performance.now()</code> 的返回值，代表回调被执行的精确时间，其用法通常如下代码所示。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">render</span> <span class="token punctuation">(</span><span class="token parameter">timestamp</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 执行渲染的具体逻辑</span>
  <span class="token comment">// ...</span>
  <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>render<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>render<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li> <li><p>对于需要长时间执行的任务，我们可以尝试把它拆分成多个小任务，然后通过 <code>requestAnimationFrame()</code> 进行调度，以确保页面的流畅性。上文提到生成一帧的时间应该在 10ms 内，所以保守估计，帧间任务的执行时间最好不要超过 3 ~ 4ms，通常做法如下代码所示。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">scheduleWork</span> <span class="token punctuation">(</span><span class="token parameter">timestamp</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> currentTimestamp
  <span class="token keyword">while</span> <span class="token punctuation">(</span>currentTimestamp <span class="token operator">-</span> timestamp <span class="token operator">&lt;</span> <span class="token number">4</span> <span class="token operator">&amp;&amp;</span> tasks<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">performWork</span><span class="token punctuation">(</span>tasks<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    currentTimestamp <span class="token operator">=</span> performance<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  tasks<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>scheduleWork<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li></ul> <p><strong>参考资料</strong></p> <p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/requestAnimationFrame" target="_blank" rel="noopener noreferrer">window.requestAnimationFrame MDN<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h5 id="使用-requestidlecallback"><a href="#使用-requestidlecallback" class="header-anchor">#</a> 使用 requestIdleCallback()</h5> <ul><li><p>**<code>window.requestIdleCallback()</code>**方法将在浏览器的空闲时段内调用的函数排队。这使开发者能够在主事件循环上执行后台和低优先级工作，而不会影响延迟关键事件，如动画和输入响应。函数一般会按先进先调用的顺序执行，然而，如果回调函数指定了执行超时时间<code>timeout</code>，则有可能为了在超时前执行函数而打乱执行顺序。</p></li> <li><p><code>requestIdleCallback</code> 的回调函数接收一个参数 <code>deadline</code>，包含 <code>timeRemaining()</code> 方法和 <code>didTimeout</code> 属性。<code>timeRemaining()</code> 返回一个高精度时间戳，表示还剩多少时间执行任务。事件应该在 50ms 内处理，所以 <code>timeRemaining()</code> 的初始值为 50ms。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">scheduleWork</span> <span class="token punctuation">(</span><span class="token parameter">deadline</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>deadline<span class="token punctuation">.</span><span class="token function">timeRemaining</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">5</span> <span class="token operator">&amp;&amp;</span> tasks<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">performWork</span><span class="token punctuation">(</span>tasks<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  tasks<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token function">requestIdleCallback</span><span class="token punctuation">(</span>scheduleWork<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">requestIdleCallback</span><span class="token punctuation">(</span>scheduleWork<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li><p>假设每个任务都能在 5ms 内完成，那么我们可以设定，当剩余空闲时间大于 5ms 时，继续处理剩余任务，否则就优先确保页面能及时响应用户操作，并将剩余的任务重新调度。</p></li> <li><p>由于我们并不知道浏览器何时才会空闲，因此 <code>requestIdleCallback</code> 回调函数的执行时机是不确定的。但它提供了一个超时机制，能确保在等待超时后执行回调函数，此时 <code>timeRemaining()</code> 为 <code>0</code>，而 <code>didTimeout</code> 为 <code>true</code>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">requestIdleCallback</span><span class="token punctuation">(</span>scheduleWork<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">timeout</span><span class="token operator">:</span> <span class="token number">2000</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>不过我们最好不要指定超时时间，因为这还是有可能导致页面无法及时响应用户操作。另外，由于不确定的执行时机，我们绝不应该在回调函数里操作 DOM，或进行任何样式变更，而应该放在 <code>requestAnimationFrame</code> 的回调函数中执行。</p></li></ul></li></ul> <h5 id="使用-web-workers"><a href="#使用-web-workers" class="header-anchor">#</a> 使用 Web Workers</h5> <ul><li>对于需要长时间执行的任务，另一个解决方案是使用 Web Workers</li></ul> <h5 id="优化绘制与合成"><a href="#优化绘制与合成" class="header-anchor">#</a> 优化绘制与合成</h5> <ul><li>优化绘制与合成减少重绘。修改元素几何形态相关的样式属性，会触发页面重新布局。</li> <li>对于绘制来说，修改绝大多数样式属性都会导致页面重绘，这很难避免。仅有的例外是 <code>transform</code> 和 <code>opacity</code>，这是由于它们可以仅由合成器操作图层来实现。另外，合成器运行在单独的线程里，即使浏览器主线程被阻塞，其效果也不会受到影响。所以，<code>transform</code> 和 <code>opacity</code> 非常适合用于实现动画效果，但我们仍需要通过 <code>will-change</code> 为它们创建独立的图层，避免影响其他图层的绘制。</li></ul> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">.moving-element</span> <span class="token punctuation">{</span>
  <span class="token property">will-change</span><span class="token punctuation">:</span> transform<span class="token punctuation">,</span> opacity<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>请参阅<a href="https://developers.google.com/web/fundamentals/performance/rendering/stick-to-compositor-only-properties-and-manage-layer-count" target="_blank" rel="noopener noreferrer">坚持只使用合成器的属性并管理层数<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>和<a href="https://www.html5rocks.com/en/tutorials/speed/high-performance-animations/" target="_blank" rel="noopener noreferrer">高性能动画<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h5 id="延迟加载插件"><a href="#延迟加载插件" class="header-anchor">#</a> 延迟加载插件</h5> <ul><li><p><a href="https://web.dev/third-party-javascript/" target="_blank" rel="noopener noreferrer">插件/第三方资源<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>通常用于展示广告或视频以及与社交媒体集成。默认方法是在页面加载后立即加载第三方资源，但这可能会不必要地减慢页面加载速度。如果第三方内容不重要，可以通过<a href="https://web.dev/fast/#lazy-load-images-and-video" target="_blank" rel="noopener noreferrer">延迟加载<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>来降低这种性能成本。</p></li> <li><p>Lighthouse 如何检测可延迟的插件嵌入:</p> <ul><li><p>Lighthouse 寻找可以延迟的第三方插件，例如社交按钮小部件或视频嵌入（例如，YouTube 嵌入式播放器）。有关可延期产品和可用外观的数据<a href="https://github.com/patrickhulce/third-party-web/" target="_blank" rel="noopener noreferrer">在第三方网络中维护<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p></li> <li><p>如果页面加载属于这些第三方嵌入之一的资源，审核将失败。</p> <p><img src="/myblog/assets/img/chrome-第三方资源.f0818b3f.png" alt="Lighthouse 第三方外观审核突出了 Vimeo 嵌入式播放器和 Drift 实时聊天。"></p></li></ul></li> <li><p><a href="https://web.dev/third-party-facades/#how-to-defer-third-parties-with-a-facade" target="_blank" rel="noopener noreferrer">如何延迟加载插件<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li>不要将第三方嵌入直接添加到您的 HTML，而是使用看起来类似于实际嵌入的插件的静态元素替换插件样式。当发生交互时加载实际插件，过程：
<ul><li>加载时：向页面添加插件样式的静态元素。</li> <li>鼠标悬停时：预连接到第三方资源。</li> <li>单击时：用第三方插件替换静态元素。</li></ul></li></ul></li> <li><p>示例：使用 youtube 图片替代实际视频，当鼠标悬停时加载视频资源，单击时才使用视频替换图片</p> <p><img src="/myblog/assets/img/chrome-第三方资源示例.323dcd8d.png" alt=""></p></li></ul> <p><strong>参考资料</strong></p> <p><a href="https://lavas-project.github.io/pwa-book/chapter08/2-rendering-performance.html" target="_blank" rel="noopener noreferrer">渲染性能<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="服务端优化"><a href="#服务端优化" class="header-anchor">#</a> 服务端优化</h2> <p>Lighthouse 报告的 Opportunities 部分报告 Time to First Byte，即用户浏览器接收页面内容的第一个字节所需的时间：</p> <p><img src="data:image/png;base64,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" alt=""></p> <ul><li><a href="https://web.dev/time-to-first-byte/#slow-server-response-times-affect-performance" target="_blank" rel="noopener noreferrer">缓慢的服务器响应时间会影响性能<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <ul><li>当浏览器等待服务器响应主文档请求的时间超过 600 毫秒时，此审核将失败。用户不喜欢页面加载时间过长。服务器响应时间慢是页面加载时间过长的可能原因之一。</li> <li>当用户在 Web 浏览器中导航到某个 URL 时，浏览器会发出网络请求以获取该内容。您的服务器接收请求并返回页面内容。</li> <li>服务器可能需要做很多工作才能返回包含用户想要的所有内容的页面。例如，如果用户正在查看他们的订单历史记录，服务器需要从数据库中获取每个用户的历史记录，然后将该内容插入到页面中。</li> <li>优化服务器以尽快完成这样的工作是减少用户等待页面加载时间的一种方法。</li></ul></li></ul> <h3 id="nginx-开启gzip-压缩"><a href="#nginx-开启gzip-压缩" class="header-anchor">#</a> Nginx 开启Gzip 压缩</h3> <ul><li><p>Nginx实现资源压缩的原理是通过ngx_http_gzip_module模块拦截请求，并对需要做gzip的类型做gzip，ngx_http_gzip_module是Nginx默认集成的，不需要重新编译，直接开启即可。</p></li> <li><p>Nginx 配置：在nginx.conf中加入以下内容。保存并重启 nginx。</p> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">server</span></span><span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">gzip</span> <span class="token boolean">on</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">gzip_buffers</span> <span class="token number">32</span> <span class="token number">4K</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">gzip_comp_level</span> <span class="token number">6</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">gzip_min_length</span> <span class="token number">100</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">gzip_types</span> application/javascript text/css text/xml</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">gzip_disable</span> <span class="token string">&quot;MSIE [1-6]\.&quot;</span></span><span class="token punctuation">;</span> <span class="token comment">#配置禁用gzip条件，支持正则。此处表示ie6及以下不启用gzip（因为ie低版本不支持）</span>
    <span class="token directive"><span class="token keyword">gzip_vary</span> <span class="token boolean">on</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><blockquote><p>gzip配置的常用参数:</p> <p>gzip on|off; #是否开启gzip</p> <p>gzip_buffers 32 4K| 16 8K #缓冲(压缩在内存中缓冲几块? 每块多大?)</p> <p>gzip_comp_level [1-9] #推荐6 压缩级别(级别越高,压的越小,越浪费CPU计算资源)</p> <p>gzip_disable #正则匹配UA 什么样的Uri不进行gzip</p> <p>gzip_min_length 200 # 开始压缩的最小长度</p> <p>gzip_http_version 1.0|1.1 # 开始压缩的http协议版本(可以不设置,目前几乎全是1.1协议)</p> <p>gzip_proxied # 设置请求者代理服务器,该如何缓存内容</p> <p>gzip_types text/plain application/xml # 对哪些类型的文件用压缩 如txt,xml,html ,css</p> <p>gzip_vary on|off # 是否传输gzip压缩标志</p></blockquote></li> <li><p>检查：通过F12看请求的响应头部，强制刷新页面（为了避免缓存，需要强制刷新）</p> <ul><li><img src="/myblog/assets/img/gzip.3bb13fc5.png" alt="image-20210719101848079"> <ul><li>Content-Encoding:gzip 说明开启了gzip压缩</li> <li>Transfet-Encoding:chunked 说明压缩后分块传输</li></ul></li></ul></li></ul> <p><strong>参考资料</strong></p> <p><a href="https://www.cnblogs.com/Renyi-Fan/p/11047490.html" target="_blank" rel="noopener noreferrer">nginx中如何设置gzip<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="构建优化"><a href="#构建优化" class="header-anchor">#</a> 构建优化</h2> <p><strong>参考资料</strong></p> <p><a href="http://webpack.wuhaolin.cn/4%E4%BC%98%E5%8C%96/" target="_blank" rel="noopener noreferrer">深入浅出 webpack-优化<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="图片资源优化"><a href="#图片资源优化" class="header-anchor">#</a> 图片资源优化</h3> <p>Lighthouse 报告的“机会”部分列出了所有未优化的图像，并可能以<a href="https://en.wikipedia.org/wiki/Kibibyte" target="_blank" rel="noopener noreferrer">千字节 (KiB) 为单位<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>节省。优化这些图像，使页面加载速度更快并消耗更少的数据：</p> <p><img src="/myblog/assets/img/chrome-images.5034c132.png" alt=""></p> <ul><li><a href="https://web.dev/uses-optimized-images/#how-lighthouse-flags-images-as-optimizable" target="_blank" rel="noopener noreferrer">Lighthouse 如何将图像标记为可优化<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <ul><li>Lighthouse 收集页面上所有的 JPEG 或 BMP 图片，将每张图片的压缩级别设置为 85，然后将原始版本与压缩版本进行比较。如果潜在节省为 4KiB 或更大，Lighthouse 会将图像标记为可优化。</li></ul></li></ul> <p><strong>常见的图片格式及使用场景</strong></p> <ul><li><p><strong>BMP</strong>，是无损的、既支持索引色也支持直接色的点阵图。这种图片格式几乎没有对数据进行压缩，所以BMP格式的图片通常是较大的文件。</p></li> <li><p><strong>GIF</strong>是无损的、采用索引色的点阵图。采用LZW压缩算法进行编码。文件小，是GIF格式的优点，同时，GIF格式还具有支持动画以及透明的优点。但是GIF格式仅支持8bit的索引色，所以GIF格式适用于对色彩要求不高同时需要文件体积较小的场景。</p></li> <li><p><strong>JPEG</strong>是有损的、采用直接色的点阵图。JPEG的图片的优点是采用了直接色，得益于更丰富的色彩，JPEG非常适合用来存储照片，与GIF相比，JPEG不适合用来存储企业Logo、线框类的图。因为有损压缩会导致图片模糊，而直接色的选用，又会导致图片文件较GIF更大。</p></li> <li><p><strong>PNG-8</strong>是无损的、使用索引色的点阵图。PNG是一种比较新的图片格式，PNG-8是非常好的GIF格式替代者，在可能的情况下，应该尽可能的使用PNG-8而不是GIF，因为在相同的图片效果下，PNG-8具有更小的文件体积。除此之外，PNG-8还支持透明度的调节，而GIF并不支持。除非需要动画的支持，否则没有理由使用GIF而不是PNG-8。</p></li> <li><p><strong>PNG-24</strong>是无损的、使用直接色的点阵图。PNG-24的优点在于它压缩了图片的数据，使得同样效果的图片，PNG-24格式的文件大小要比BMP小得多。当然，PNG24的图片还是要比JPEG、GIF、PNG-8大得多。</p></li> <li><p><strong>SVG</strong>是无损的矢量图。SVG是矢量图意味着SVG图片由直线和曲线以及绘制它们的方法组成。当放大SVG图片时，看到的还是线和曲线，而不会出现像素点。这意味着SVG图片在放大时，不会失真，所以它非常适合用来绘制Logo、Icon等。</p></li> <li><p><strong>WebP</strong>是谷歌开发的一种新图片格式，WebP是同时支持有损和无损压缩的、使用直接色的点阵图。从名字就可以看出来它是为Web而生的，什么叫为Web而生呢？就是说相同质量的图片，WebP具有更小的文件体积。现在网站上充满了大量的图片，如果能够降低每一个图片的文件大小，那么将大大减少浏览器和服务器之间的数据传输量，进而降低访问延迟，提升访问体验。目前只有Chrome浏览器和Opera浏览器支持WebP格式，兼容性不太好。</p></li></ul> <p><strong>图片格式比较</strong></p> <ul><li>在无损压缩的情况下，相同质量的WebP图片，文件大小要比PNG小26%；</li> <li>在有损压缩的情况下，具有相同图片精度的WebP图片，文件大小要比JPEG小25%~34%；</li> <li>WebP图片格式支持图片透明度，一个无损压缩的WebP图片，如果要支持透明度只需要22%的格外文件大小。</li></ul> <h4 id="图片懒加载"><a href="#图片懒加载" class="header-anchor">#</a> 图片懒加载</h4> <h4 id="字体图标代替图片图标"><a href="#字体图标代替图片图标" class="header-anchor">#</a> 字体图标代替图片图标</h4> <h4 id="用视频替换动画-gif"><a href="#用视频替换动画-gif" class="header-anchor">#</a> 用视频替换动画 GIF</h4> <p>Lighthouse 报告的“机会”部分列出了所有动画 GIF，以及通过将这些 GIF 转换为视频所实现的估计节省的秒数：</p> <p><img src="/myblog/assets/img/chrome-gif.234ff059.png" alt="Lighthouse 使用视频格式进行动画内容审核的截图"></p> <ul><li><p>请参阅<a href="https://web.dev/performance-scoring" target="_blank" rel="noopener noreferrer">Lighthouse 性能评分<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>帖子，了解如何计算页面的整体性能评分。</p></li> <li><p><a href="https://web.dev/efficient-animated-content/#why-you-should-replace-animated-gifs-with-video" target="_blank" rel="noopener noreferrer">为什么你应该用视频替换动画 GIF<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li>大型 GIF 无法提供动画内容。通过将大型 GIF 转换为视频，您可以节省大量用户的带宽。考虑将 MPEG4/WebM 视频用于动画，将 PNG/WebP 用于静态图像而不是 GIF，以节省网络字节。</li></ul></li> <li><p>参考：<a href="https://web.dev/efficient-animated-content/" target="_blank" rel="noopener noreferrer">为动画内容使用视频格式<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li></ul> <h4 id="调整图片大小"><a href="#调整图片大小" class="header-anchor">#</a> 调整图片大小</h4> <p>Lighthouse 报告的“机会”部分列出了页面中尺寸不合适的所有图像，以及以<a href="https://en.wikipedia.org/wiki/Kibibyte" target="_blank" rel="noopener noreferrer">千字节 (KiB)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>为单位的潜在节省。调整这些图像的大小以保存数据并缩短页面加载时间：</p> <p><img src="/myblog/assets/img/chrome-图片大小.b06d828b.png" alt=""></p> <ul><li><a href="https://web.dev/uses-responsive-images/#how-lighthouse-calculates-oversized-images" target="_blank" rel="noopener noreferrer">Lighthouse 如何计算超大图像<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <ul><li>对于页面上的每个图像，Lighthouse 会将渲染图像的大小与实际图像的大小进行比较。渲染大小还考虑了设备像素比。如果渲染的大小至少比实际大小小 4KiB，则图像未通过审核。</li></ul></li></ul> <h5 id="图像-cdn"><a href="#图像-cdn" class="header-anchor">#</a> <a href="https://web.dev/image-cdns/" target="_blank" rel="noopener noreferrer">图像 CDN<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h5> <ul><li>将图像 CDN 视为用于转换图像的 Web 服务 API</li></ul> <h5 id="响应式图片"><a href="#响应式图片" class="header-anchor">#</a> 响应式图片</h5> <ul><li>响应式图片的优点是浏览器能够根据屏幕大小自动加载合适的图片。
<ul><li><p>通过 <code>picture</code> 实现</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>picture</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span> <span class="token attr-name">srcset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>banner_w1000.jpg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">media</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>(min-width: 801px)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span> <span class="token attr-name">srcset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>banner_w800.jpg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">media</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>(max-width: 800px)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>banner_w800.jpg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>picture</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p>通过 <code>@media</code> 实现</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">min-width</span><span class="token punctuation">:</span> 769px<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
    <span class="token selector">.bg</span> <span class="token punctuation">{</span>
        <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>bg1080.jpg<span class="token punctuation">)</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">max-width</span><span class="token punctuation">:</span> 768px<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
    <span class="token selector">.bg</span> <span class="token punctuation">{</span>
        <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>bg768.jpg<span class="token punctuation">)</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li> <li><p>参阅提供<a href="https://web.dev/serve-responsive-images" target="_blank" rel="noopener noreferrer">响应式图像<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>以了解更多信息。</p></li></ul></li></ul> <h5 id="图片压缩"><a href="#图片压缩" class="header-anchor">#</a> 图片压缩</h5> <ul><li><p>例如 JPG 格式的图片，100% 的质量和 90% 质量的通常看不出来区别，尤其是用来当背景图的时候。我经常用 PS 切背景图时， 将图片切成 JPG 格式，并且将它压缩到 60% 的质量，基本上看不出来区别。</p></li> <li><p>压缩方法有两种：</p> <ul><li>一是通过 webpack 插件 <code>image-webpack-loader</code></li> <li>二是通过在线网站进行压缩。
<ul><li>tinypng</li></ul></li></ul></li></ul> <h5 id="使用基于矢量的图像格式"><a href="#使用基于矢量的图像格式" class="header-anchor">#</a> 使用基于矢量的图像格式</h5> <ul><li>使用基于矢量的图像格式，如 SVG。使用有限数量的代码，SVG 图像可以缩放到任何大小。请参阅<a href="https://developers.google.com/web/fundamentals/design-and-ux/responsive/images#replace_complex_icons_with_svg" target="_blank" rel="noopener noreferrer">用 SVG 替换复杂图标<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>以了解更多信息。</li></ul> <h4 id="使用-webp-图像"><a href="#使用-webp-图像" class="header-anchor">#</a> <a href="https://web.dev/serve-images-webp" target="_blank" rel="noopener noreferrer">使用 WebP 图像<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <ul><li>WebP 的优势体现在它具有更优的图像数据压缩算法，能带来更小的图片体积，而且拥有肉眼识别无差异的图像质量；同时具备了无损和有损的压缩模式、Alpha 透明以及动画的特性，在 JPEG 和 PNG 上的转化效果都相当优秀、稳定和统一。</li> <li>AVIF 和 WebP 是图像格式，与较旧的 JPEG 和 PNG 对应物相比，它们具有出色的压缩和质量特性。以这些格式而不是 JPEG 或 PNG 对您的图像进行编码意味着它们将加载得更快并消耗更少的蜂窝数据。</li></ul> <p><strong>参考资料：</strong></p> <p><a href="https://www.zhihu.com/question/27201061" target="_blank" rel="noopener noreferrer">WebP 相对于 PNG、JPG 有什么优势？<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="js-编码优化"><a href="#js-编码优化" class="header-anchor">#</a> JS 编码优化</h3> <h4 id="减少-javascript-执行时间"><a href="#减少-javascript-执行时间" class="header-anchor">#</a> 减少 JavaScript 执行时间</h4> <ul><li><p>当您的 JavaScript 需要很长时间来执行时，它会以多种方式降低您的页面性能：</p> <ul><li><p><strong>网络成本</strong></p> <p>更多的字节等于更长的下载时间。</p></li> <li><p><strong>解析和编译成本</strong></p> <p>JavaScript 在主线程上被解析和编译。当主线程繁忙时，页面无法响应用户输入。</p></li> <li><p><strong>执行成本</strong></p> <p>JavaScript 也在主线程上执行。如果您的页面在真正需要之前运行了大量代码，这也会延迟您的<a href="https://web.dev/interactive" target="_blank" rel="noopener noreferrer">Time To Interactive<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，这是与用户如何看待您的页面速度相关的关键指标之一。</p></li> <li><p><strong>内存成本</strong></p> <p>如果您的 JavaScript 持有大量引用，则可能会消耗大量内存。页面在消耗大量内存时会出现卡顿或缓慢。内存泄漏会导致您的页面完全冻结。</p></li></ul></li> <li><p><a href="https://web.dev/bootup-time/#how-to-speed-up-javascript-execution" target="_blank" rel="noopener noreferrer">如何加快 JavaScript 执行速度<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li><a href="https://web.dev/reduce-javascript-payloads-with-code-splitting" target="_blank" rel="noopener noreferrer">通过实现代码拆分，只发送用户需要的代码<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</li> <li><a href="https://web.dev/reduce-network-payloads-using-text-compression" target="_blank" rel="noopener noreferrer">缩小和压缩您的代码<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</li> <li><a href="https://web.dev/remove-unused-code" target="_blank" rel="noopener noreferrer">删除未使用的代码<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</li> <li><a href="https://web.dev/apply-instant-loading-with-prpl" target="_blank" rel="noopener noreferrer">通过使用 PRPL 模式缓存您的代码来减少网络旅行<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</li></ul></li> <li><p><a href="https://web.dev/bootup-time/#how-the-lighthouse-javascript-execution-time-audit-fails" target="_blank" rel="noopener noreferrer">Lighthouse 如何审计 JavaScript 执行时间<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li>当 JavaScript 执行时间超过 2 秒时，<a href="https://developers.google.com/web/tools/lighthouse/" target="_blank" rel="noopener noreferrer">Lighthouse 会<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>显示警告。当执行时间超过 3.5 秒时审计失败：</li></ul> <p><img src="/myblog/assets/img/chrome-js.fe1b4bad.png" alt="Lighthouse Reduce JavaScript 执行时间审计截图"></p></li></ul> <h4 id="避免过大的-dom"><a href="#避免过大的-dom" class="header-anchor">#</a> 避免过大的 DOM</h4> <p>大型 DOM 树可以通过多种方式降低页面性能：</p> <ul><li><p><strong>网络效率和负载性能</strong></p> <p>大型 DOM 树通常包含许多在用户首次加载页面时不可见的节点，这会不必要地增加用户的数据成本并减慢加载时间。</p></li> <li><p><strong>运行时性能</strong></p> <p>当用户和脚本与您的页面交互时，浏览器必须不断<a href="https://developers.google.com/web/fundamentals/performance/rendering/reduce-the-scope-and-complexity-of-style-calculations?utm_source=lighthouse&amp;utm_medium=cli" target="_blank" rel="noopener noreferrer">重新计算节点的位置和样式<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。大型 DOM 树与复杂的样式规则相结合会严重减慢渲染速度。</p></li> <li><p><strong>内存性能</strong></p> <p>如果您的 JavaScript 使用通用查询选择器，例如<code>document.querySelectorAll('li')</code>，您可能会在不知不觉中存储对大量节点的引用，这可能会压倒用户设备的内存容量。</p></li></ul> <p><a href="https://web.dev/dom-size/#how-the-lighthouse-dom-size-audit-fails" target="_blank" rel="noopener noreferrer">Lighthouse 如何审查 DOM 大小<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li><p><a href="https://developers.google.com/web/tools/lighthouse/" target="_blank" rel="noopener noreferrer">Lighthouse<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>报告页面的总 DOM 元素、页面的最大 DOM 深度及其最大子元素：<img src="/myblog/assets/img/chrome-dom.313aed9d.png" alt="Lighthouse 的截图避免了过多的 DOM 大小审计"></p> <ul><li>Lighthouse 使用 DOM 树标记页面：
<ul><li>总共有 1,500 多个节点。</li> <li>具有大于 32 个节点的深度。</li> <li>有一个超过 60 个子节点的父节点。</li></ul></li></ul></li> <li><p><a href="https://web.dev/dom-size/#how-to-optimize-the-dom-size" target="_blank" rel="noopener noreferrer">如何优化 DOM 大小<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li><p>一般来说，寻找方法只在需要时创建 DOM 节点，并在不再需要时销毁节点。</p></li> <li><p>如果您当前正在传送大型 DOM 树，请尝试加载您的页面并手动注意显示哪些节点。也许您可以从最初加载的文档中删除未显示的节点，并仅在相关的用户交互（例如滚动或单击按钮）之后创建它们。</p></li> <li><p>如果您在运行时创建 DOM 节点，<a href="https://developers.google.com/web/tools/chrome-devtools/javascript/breakpoints#dom" target="_blank" rel="noopener noreferrer">Subtree Modification DOM Change Breakpoints<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>可以帮助您确定节点何时被创建。</p></li> <li><p>如果您无法避免使用大型 DOM 树，另一种提高渲染性能的方法是简化您的 CSS 选择器。有关更多信息，请参阅 Google 的<a href="https://developers.google.com/web/fundamentals/performance/rendering/reduce-the-scope-and-complexity-of-style-calculations" target="_blank" rel="noopener noreferrer">减少样式计算的范围和复杂性<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li></ul></li></ul> <h3 id="css-编码优化"><a href="#css-编码优化" class="header-anchor">#</a> CSS 编码优化</h3> <h4 id="压缩css"><a href="#压缩css" class="header-anchor">#</a> 压缩CSS</h4> <p>缩小 CSS 文件可以提高页面加载性能。CSS 文件通常比它们需要的要大。例如：</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token comment">/* Header background should match brand colors. */</span>
<span class="token selector">h1</span> <span class="token punctuation">{</span>  <span class="token property">background-color</span><span class="token punctuation">:</span> #000000<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token selector">h2</span> <span class="token punctuation">{</span>  <span class="token property">background-color</span><span class="token punctuation">:</span> #000000<span class="token punctuation">;</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>可以简化为：</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">h1, h2</span> <span class="token punctuation">{</span> <span class="token property">background-color</span><span class="token punctuation">:</span> #000000<span class="token punctuation">;</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>从浏览器的角度来看，这两个代码示例在功能上是等效的，但第二个示例使用的字节更少。Minifiers 可以通过删除空格进一步提高字节效率：</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">h1,h2</span><span class="token punctuation">{</span><span class="token property">background-color</span><span class="token punctuation">:</span>#000000<span class="token punctuation">;</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>一些压缩器使用巧妙的技巧来最小化字节。例如，颜色值<code>#000000</code>可以进一步减少到<code>#000</code>，这是它的速记等价物。</p> <p>Lighthouse 根据它在您的 CSS 中找到的注释和空白字符来估计潜在的节省。这是一个保守的估计。如前所述，缩小器可以执行巧妙的优化（例如减少<code>#000000</code>到<code>#000</code>）以进一步减小文件大小。因此，如果您使用压缩器，您可能会看到比 Lighthouse 报告的更多的节省。</p> <h3 id="其他编码优化"><a href="#其他编码优化" class="header-anchor">#</a> 其他编码优化</h3> <h4 id="优化-js-第三方库引入"><a href="#优化-js-第三方库引入" class="header-anchor">#</a> 优化 JS 第三方库引入</h4> <ul><li><p>要将广告网络、社交媒体按钮、A/B 测试或分析服务添加到您的页面，您通常需要将第三方脚本添加到您的 HTML 中。这些<a href="https://web.dev/third-party-javascript/" target="_blank" rel="noopener noreferrer">第三方脚本会显着影响您的页面加载性能<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p></li> <li><p><a href="https://web.dev/third-party-summary/#how-the-lighthouse-audit-for-third-party-code-fails" target="_blank" rel="noopener noreferrer">第三方代码的 Lighthouse 审计如何失败<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li>Lighthouse 标记具有阻止<a href="https://developer.mozilla.org/en-US/docs/Glossary/Main_thread" target="_blank" rel="noopener noreferrer">主线程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>250 毫秒或更长时间的第三方代码的页面：<img src="/myblog/assets/img/chrome-第三方库.aa3527ea.png" alt="Lighthouse 截图 减少第三方代码审计的影响"></li> <li>第三方脚本是托管在与您使用 Lighthouse 审核的 URL 域不同的域上的任何脚本。随着页面加载，Lighthouse 计算每个第三方脚本阻塞主线程的时间。如果总阻塞时间大于 250 毫秒，则审计失败。</li></ul></li> <li><p>优化第三方引入脚本方式：</p> <ul><li>在标签上使用<code>async</code> 或<code>defer</code>属性<code>&lt;script&gt;</code></li> <li>使用预链接和预加载</li> <li>懒加载</li> <li>第三方 CDN 托管
<ul><li>第三方供应商通常会提供他们托管的 JavaScript 文件的 URL，通常位于<a href="https://en.wikipedia.org/wiki/Content_delivery_network" target="_blank" rel="noopener noreferrer">内容交付网络 (CDN) 上<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。这种方法的好处是您可以快速开始——只需复制和粘贴 URL——并且没有维护开销。第三方供应商处理服务器配置和脚本更新。</li> <li>但是因为它们与您的其他资源不在同一来源，所以从公共 CDN 加载文件会产生网络成本。浏览器需要执行 DNS 查找，建立新的 HTTP 连接，并在安全来源上与供应商的服务器执行 SSL 握手。</li> <li>当使用来自第三方服务器的文件时，您几乎无法控制缓存。依赖其他人的缓存策略可能会导致不必要地频繁从网络重新获取脚本</li></ul></li> <li>自托管第三方脚本：自托管第三方脚本是一个选项，可让您更好地控制脚本的加载过程。
<ul><li>优点：
<ul><li>减少 DNS 查找和往返时间。</li> <li>改进<a href="https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/http-caching" target="_blank" rel="noopener noreferrer">HTTP 缓存<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>标头。</li> <li>利用<a href="https://developers.google.com/web/fundamentals/performance/http2/" target="_blank" rel="noopener noreferrer">HTTP/2 服务器推送<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</li></ul></li> <li>缺点：脚本可能会过时，并且在 API 更改或安全修复时不会自动更新。</li></ul></li> <li>使用 service worker 缓存来自第三方服务器的脚本</li></ul></li></ul> <p><strong>参考资料</strong></p> <p><a href="https://web.dev/third-party-summary/" target="_blank" rel="noopener noreferrer">Reduce the impact of third-party code<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h4 id="beacon-数据上报"><a href="#beacon-数据上报" class="header-anchor">#</a> Beacon  数据上报</h4> <ul><li><p>我们经常需要尝试在卸载（unload）文档之前向 Web 服务上报性能数据。过早的发送数据可能导致错过收集数据的机会。但对于开发者来说保证在文档卸载期间发送数据一直是一个困难，因为用户代理通常会忽略在 unload 事件处理器中产生的异步 XMLHttpRequest。</p></li> <li><p>为了解决这个问题，通常要在 unload 或者 beforeunload 事件处理器中发起一个同步 XMLHttpRequest 来发送数据。同步的 XMLHttpRequest 迫使用户代理延迟卸载文档，使得下一个导航出现的更晚，而下一个页面对于这种较差的载入表现无能为力。</p></li> <li><p>使用 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Beacon_API" target="_blank" rel="noopener noreferrer">navigator.sendBeacon()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 方法会使用户代理在有机会时异步地向服务器发送数据，同时不会延迟页面的卸载或影响下一导航的载入性能。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'unload'</span><span class="token punctuation">,</span> logData<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">logData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    navigator<span class="token punctuation">.</span><span class="token function">sendBeacon</span><span class="token punctuation">(</span><span class="token string">&quot;/log&quot;</span><span class="token punctuation">,</span> analyticsData<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p>考虑到此方法的兼容性，应该在浏览器不支持 navigator.sendBeacon 时使用其他方法发送数，例如同步的 XMLHttpRequest。</p></li></ul> <p><strong>参考资料</strong></p> <p><a href="https://web.dev/fast/" target="_blank" rel="noopener noreferrer">Fast load times<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://juejin.cn/post/6844904153869713416#heading-15" target="_blank" rel="noopener noreferrer">前端性能优化指南<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://zhuanlan.zhihu.com/p/121056616" target="_blank" rel="noopener noreferrer">前端性能优化 24 条建议<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="性能优化实践"><a href="#性能优化实践" class="header-anchor">#</a> 性能优化实践</h2> <p><strong>参考资料</strong></p> <p><a href="https://mp.weixin.qq.com/s/_7Mk39yWEkxOrnyYU_wvpQ" target="_blank" rel="noopener noreferrer">从页面加载到数据请求，前端页面性能优化实践分享<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://mp.weixin.qq.com/s/YqHHbsxg8SbbtrY8gwhS9w" target="_blank" rel="noopener noreferrer">从实际项目入手，如何监测性能问题、如何解决<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <!----> <div class="content__content-bottom"></div> <footer class="page-meta"><!----> <div class="meta-item update-time"><span class="label">Last update:</span> <span class="info">January 22, 2024 14:49</span></div> <div class="meta-item contributors"><span class="label">Contributors: </span> <span class="info"><span title="email: 596777598@qq.com" class="contributor">
          sewar
        </span> <!----></span></div></footer> <!----> <!----> <!----> <div class="content__page-bottom"></div></main> <!----></div><div class="global-ui"><!----><div id="pwa-install"><!----> <div id="install-modal-wrapper" style="display:none;"><div class="background"></div> <div class="install-modal"><div class="header"><button aria-label="Close" class="close-button"><svg width="23" height="22" xmlns="http://www.w3.org/2000/svg" class="icon close-icon"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.12.358a1.224 1.224 0 011.729 0l8.92 8.914L20.686.358a1.224 1.224 0 011.73 1.728L13.497 11l8.92 8.913a1.222 1.222 0 11-1.73 1.729l-8.919-8.913-8.92 8.913a1.224 1.224 0 01-1.729-1.729L10.04 11l-8.92-8.914a1.222 1.222 0 010-1.728z" fill="currentColor"></path></svg></button> <div class="logo"><!----> <div class="title"><h1></h1> <p class="desc">This app can be installed on your PC or mobile device.  This will allow this web app to look and behave like any other installed app.  You will find it in your app lists and be able to pin it to your home screen, start menus or task bars.  This installed web app will also be able to safely interact with other apps and your operating system. </p></div></div></div> <div class="content"><div class="highlight"><!----> <!----></div> <div class="description"><h3>Description</h3> <p></p></div></div> <div class="button-wrapper"><button class="install-button">
        Install <span></span></button> <button class="cancel-button">
        Cancel
      </button></div></div></div></div><!----><div tabindex="-1" role="dialog" aria-hidden="true" class="pswp"><div class="pswp__bg"></div> <div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div> <div class="pswp__item"></div> <div class="pswp__item"></div></div> <div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div> <button title="Close" aria-label="Close" class="pswp__button pswp__button--close"></button> <button title="Share" aria-label="Share" class="pswp__button pswp__button--share"></button> <button title="Switch to full screen" aria-label="Switch to full screen" class="pswp__button pswp__button--fs"></button> <button title="Zoom in/out" aria-label="Zoom in/out" class="pswp__button pswp__button--zoom"></button> <div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div> <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div> <button title="Prev (Arrow Left)" aria-label="Prev (Arrow Left)" class="pswp__button pswp__button--arrow--left"></button> <button title="Next (Arrow Right)" aria-label="Next (Arrow Right)" class="pswp__button pswp__button--arrow--right"></button> <div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div></div></div>
    <script src="/myblog/assets/js/app.9d2b617a.js" defer></script><script src="/myblog/assets/js/layout-Layout.d2d4ce64.js" defer></script><script src="/myblog/assets/js/page-前端性能优化方案.83718d22.js" defer></script><script src="/myblog/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound~layout-components/Blog/BlogHome~layout-components/~2222f443.5835591a.js" defer></script>
  </body>
</html>
